define(["jquery","version!fly/components/load-more","version!fly/libs/jquery.throttle-debounce"],function(e){e.widget("fly.loadMoreScroll",e.fly.loadMore,{widgetEventPrefix:"loadMore",options:{disabled:!1,threshold:"300",loader:{initState:null,text:{loading:"Please Wait"}}},_create:function(){this._super("_create")},_setupEvents:function(){var t=this;e.support.touch?this._on(this.$document,{scrollstop:"_checkScroll"}):this._on(this.$document,{scroll:e.throttle(100,this._checkScroll)}),this._on({loadmorescrolloaded:this.loader.remove})},_checkScroll:function(){var e=this.options,t,n;if(e.disabled||this.isLoading||this.$element.is(":hidden"))return;t=this.$window.scrollTop()+this.$window.height(),n=this.$element.offset().top+this.$element.outerHeight(),n-t<e.threshold&&this.load()}})})