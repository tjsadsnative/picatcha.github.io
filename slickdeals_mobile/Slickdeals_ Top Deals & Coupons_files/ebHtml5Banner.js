EBGInfra={declareNamespace:function(a){for(var c=window.EBG,a=a.split("."),d=0;d<a.length;d++){var e=a[d],f=c[e];f||(f=c[e]={});c=f}},declareClass:function(a,c){a.prototype.constructor=a;if(c)a.__superClass=c,a.__basePrototypePending=!0,EBG._resolveInheritance(a);return a},runTimed:function(a,c,d,e){return setTimeout(function(){c.apply(a,d)},e)},setInterval:function(a,c,d,e){return setInterval(function(){c.apply(a,d)},e)},clearInterval:function(a){clearInterval(a)},_resolveInheritance:function(a){if(a.__basePrototypePending){var c=
a.__superClass;EBG._resolveInheritance(c);var c=c.prototype,d=a.prototype,e;for(e in c)d[e]=d[e]||c[e];delete a.__basePrototypePending}},callSuperConstructor:function(a,c,d){(a=a.__superClass)&&(d?a.apply(c,d):a.apply(c));return c},callSuperFunction:function(a,c,d,e){if(a=a.__superClass)var f=a.prototype[d];try{if(f)return e?f.apply(c,e):f.apply(c)}catch(g){}},typeOf:function(a){var c=typeof a;if("object"==c)if(a){if(a instanceof Array||!(a instanceof Object)&&"[object Array]"==Object.prototype.toString.call(a)||
"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if(!(a instanceof Object)&&("[object Function]"==Object.prototype.toString.call(a)||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call")))return"function"}else return"function"==c&&"undefined"==typeof a.call?"object":"null";return c},isFunc:function(a){return"function"==EBG.typeOf(a)},isDefined:function(a){return"undefined"!=
EBG.typeOf(a)},notNull:function(a){return null!=a},isDefinedNotNull:function(a){return this.isDefined(a)&&this.notNull(a)},hasValue:function(a){return null!=a&&"undefined"!=EBG.typeOf(a)},hasOwnValue:function(a,c){for(var d in a)if(a.hasOwnProperty(d)&&a[d]===c)return!0;return!1},getRandomNumber:function(){var a="";try{a=Math.random().toString(),a=a.substr(a.indexOf(".")+1)}catch(c){a=""}return a},isObj:function(a){return"object"==EBG.typeOf(a)},isArray:function(a){return"array"==EBG.typeOf(a)},isBool:function(a){return"boolean"==
EBG.typeOf(a)},isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},format:function(a){for(var c=1;c<arguments.length;c++)a=a.replace(RegExp("\\{"+(c-1)+"\\}","gi"),""+arguments[c]);return a},throwEx:function(a){throw{name:"",message:a};},mergeObj:function(a,c,d){var d=!!d,e;for(e in a)if(a.hasOwnProperty(e)&&(!c.hasOwnProperty(e)||d))c[e]=a[e]},cloneObj:function(a){if(!EBG.isObj(a))return null;var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=EBG.isObj(a[d])?EBG.cloneObj(a[d]):a[d]);return c},
combinePaths:function(a,c){a=a||"";c=c||"";a&&"/"!=a[a.length-1]&&c&&"/"!=c[0]&&(a+="/");var d=a;c&&(d+=c);return d},px:function(a){return EBG.format("{0}px",a)},strEQ:function(a,c,d){return a&&c?d?a===c:a.toLowerCase()===c.toLowerCase():!1},indexOfArray:function(a,c){for(var d=0;d<a.length;d++)if(a[d]==c)return d;return-1},filterArray:function(a,c,d){var e=a.length>>>0;if("function"!=typeof c)throw new TypeError;for(var f=[],g=0;g<e;g++)if(g in a){var h=a[g];c.call(d||window,h,g,a)&&f.push(h)}return f},
mapArray:function(a,c,d){var e=a.length>>>0;if("function"!=typeof c)throw new TypeError;for(var f=[],g=0;g<e;g++)g in a&&f.push(c.call(d||window,a[g],g,a));return f},isGlobalDef:function(a,c){var d="undefined"!=typeof window[a];c&&d&&(d=eval(a+"=="+c));return d},numberToEnum:function(a,c){var d="",e;for(e in c)if(c.hasOwnProperty(e)&&c[e]===a){d=e;break}return d},getPageUrl:function(a){try{return a&&a.location&&a.location.href?a.location.href:null}catch(c){return null}},_isXMLHttpRequestSupported:function(){var a=
window.XMLHttpRequest?new XMLHttpRequest:null;return a&&EBG.isBool(a.withCredentials)},htmlDecode:function(a){this.helperDiv=this.helperDiv?this.helperDiv:document.createElement("div");this.helperDiv.innerHTML=a;return this.helperDiv.textContent},htmlEncode:function(a){this.helperDiv=this.helperDiv?this.helperDiv:document.createElement("div");this.helperDiv.textContent=a;return this.helperDiv.innerHTML},getDataFromRemoteServer:function(a,c,d,e,f){if(!a||EBG.isOfflineDemo)return!1;var e=EBG.isBool(e)?
e:!0,f=EBG.isBool(f)?f:!1,g=function(){try{if(f){var a,e;9===document.documentMode?e=(new window.DOMParser).parseFromString(j.responseText,"text/xml"):(a=document.createElement("div"),a.innerHTML="<xml>"+j.responseText+"</xml>",document.body.appendChild(a),e=a.firstChild.XMLDocument,document.body.removeChild(a));c.call(d,e)}else c.call(d,j.responseText)}catch(g){c.call(d)}},h=!1;try{if(this._isXMLHttpRequestSupported()){var i=new XMLHttpRequest;i.open("GET",a,e);h=!0;if(e)i.onreadystatechange=function(){4==
i.readyState&&(200==i.status?c.call(d,f?i.responseXML:i.responseText):c.call(d))};i.send();e||c.call(d,f?i.responseXML:i.responseText)}else if(window.XDomainRequest&&e){var j=new XDomainRequest;if(j)j.onerror=function(){EBG.log.error("XDomain request error");c.call(d)},j.ontimeout=function(){EBG.log.error("XDomain request timeout");c.call(d)},j.onload=g,j.onprogress=function(){},j.open("get",a),j.send(),h=!0}}catch(k){h=!1}return h},getFeatureFlagValue:function(a,c){if(!EBG.isDefined(a))return!1;
if(EBG.isArray(a)){for(var d=0;d<a.length;d++)if(a[d].name==c)return a[d].state;return!1}return!!a[c]},isPercentage:function(a){return a instanceof String?-1<a.indexOf("%"):!1},getTime:function(){var a=(new Date).getTime()/1E3;return function(){return(new Date).getTime()/1E3-a}}(),getObjKeys:function(a){a=a||{};if(Object.keys)return Object.keys(a);var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(d);return c},serializeObject:function(a){var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(d+"="+a[d]);
return c.join("&")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},getTopAccessibleWindow:function(){var a=window;try{if(a.top.document.domain||""===a.parent.document.domain)a=a.top;else throw new DOMException;}catch(c){try{for(a=window;a.self!==a.parent;)if(a.parent.document.domain||""===a.parent.document.domain)a=a.parent}catch(d){}}return function(){return a}}(),getBigScript:function(){var a;if(document.currentScript)a=document.currentScript;else{var c=document.getElementsByTagName("script");
a=c[c.length-1]}return function(){return a}}(),valueFromPath:function(a,c,d){for(var c=c.split("."),e=0;e<c.length;e++)a=a[c[e]];return EBG.isObj(a)&&d?EBG.cloneObj(a):a}};EBG=window.EBG||{};EBGInfra.mergeObj(EBGInfra,EBG,!1);EBG.declareNamespace("Logging");EBG.Logging.LoggerLevels={NONE:0,ERROR:1,INFO:2,WARN:3,DEBUG:4};EBG.Logging.Logger=function(a){this._level=a;this.startNestingGroupNames=[];this.endNestingGroupNames=[];this._stringFilters=[];this._fGroupFilter=!1;this._maxIndent=15};
EBG.Logging.Logger.prototype={setLevel:function(a){this._level=a},setFilter:function(a,c){"string"==EBG.typeOf(a)&&(a=[a]);this._fGroupFilter=EBG.isDefined(c)?c:!0;this._stringFilters=a},debug:function(a){this._reportToLog(EBG.Logging.LoggerLevels.DEBUG,arguments)},info:function(a){this._reportToLog(EBG.Logging.LoggerLevels.INFO,arguments)},warn:function(a){this._reportToLog(EBG.Logging.LoggerLevels.WARN,arguments)},error:function(a){this._reportToLog(EBG.Logging.LoggerLevels.ERROR,arguments)},exception:function(a,
c){var d="string"!==c?EBG.format("Exception in {0}. message: {1}",a,c.message):EBG.format("Exception in: {0}. message: {1}",a,c);c.stack&&(d+=EBG.format(" stack: {0}",c.stack));this._reportToLog(EBG.Logging.LoggerLevels.ERROR,[d])},startGroup:function(a){this._supportNesting()&&this._passesFilter(a)&&this.startNestingGroupNames.push(a)},endGroup:function(){this._supportNesting()&&0<this.endNestingGroupNames.length&&window.console.groupEnd(this.endNestingGroupNames.pop())},_consoleAvailable:function(){return void 0!==
window.console},_supportNesting:function(){return this._consoleAvailable()?void 0!==window.console.group:!1},_supportErrorMessage:function(){return void 0!==window.console.error},_supportInfoMessage:function(){return void 0!==window.console.info||void 0!==window.opera},_supportWarnMessage:function(){return void 0!==window.console.warn||void 0!==window.opera},_supportObjectView:function(){return void 0!==window.console.dir||void 0!==window.opera},_callConsoleFunction:function(a,c){var d=!1;switch(a){case EBG.Logging.LoggerLevels.INFO:this._supportInfoMessage()&&
(window.console.info(c),d=!0);break;case EBG.Logging.LoggerLevels.WARN:this._supportWarnMessage()&&(window.console.warn(c),d=!0);break;case EBG.Logging.LoggerLevels.ERROR:this._supportErrorMessage()&&(consoleFunction=window.console.error(c),d=!0)}d||window.console.log(c)},_resetNesting:function(){for(var a=0;a<=this._maxIndent;a++)this.endGroup();console.warn("Reset log group nesting. MaxIndent = "+this._maxIndent)},_passesFilter:function(a){var c=!1;if(0==this._stringFilters.length)c=!0;else for(var d=
0;d<this._stringFilters.length;d++)if(-1<a.indexOf(this._stringFilters[d])){c=!0;break}return c},_reportToLog:function(a,c){if(this._level>=a&&this._consoleAvailable()){var d=c[0];"[object String]"!==Object.prototype.toString.call(d)?this._supportObjectView()||(d=d.toString()):d=EBG.format.apply(null,c);if(void 0===window.opera){for(;this.startNestingGroupNames.length;)window.console.group(this.startNestingGroupNames[0]),this.endNestingGroupNames.push(this.startNestingGroupNames.shift());(this._passesFilter(d)||
this._fGroupFilter&&0<this.endNestingGroupNames.length)&&this._callConsoleFunction(a,d);this.endNestingGroupNames.length>this._maxIndent&&this._resetNesting()}else this._passesFilter(d)&&opera.postError(d)}}};EBG.declareClass(EBG.Logging.Logger,null);EBG.log=EBG.log||new EBG.Logging.Logger(EBG.Logging.LoggerLevels.DEBUG);EBG.declareNamespace("Reporter");EBG.Reporter.ServerReporter=function(a){this.reportFrequency=a.reportFrequency||0};
EBG.Reporter.ServerReporter.prototype={report:function(a){this._shouldReport()&&this._reportMessage(a)},getCallStack:function(){try{throw Error();}catch(a){return formatCallStack(a.stack)}},_shouldReport:function(){var a=!1;0<this.reportFrequency&&this.reportFrequency/100>Math.random()&&(a=!0);return a},formatCallStack:function(a){if(a){for(var c;c!=a;)c=a,a=a.replace(/((https?:\/..*\/)[^\/:]*:\d+(?:.|\n)*)\2/,"$1");a=a.replace(/\n/g,"")}return a},_reportMessage:function(a){var c=EBG.format("{0}{1}/BurstingPipe/adServer.bs?cn=cLog&ord={2}",
EBG.protocol,EBG.bs,Math.random()),d;for(d in a)a.hasOwnProperty(d)&&(c+="&"+d+"="+a[d]);EBG.adaptor.reportToRemoteServerUsingImage(c)}};EBG.declareClass(EBG.Reporter.ServerReporter,null);
(function(a,c,d){c||(c={fn:{},extend:function(){for(var a=arguments[0],c=1,d=arguments.length;c<d;c++){var e=arguments[c],j;for(j in e)a[j]=e[j]}return a}});c.fn.pm=function(){return this};c.pm=EBG.pm=function(a){e.send(a)};c.pm.bind=EBG.bind=function(a,c,d,i,j){e.bind(a,c,d,i,j)};c.pm.unbind=EBG.unbind=function(a,c){e.unbind(a,c)};c.pm.dispatch=function(a,c,d,i){e._dispatch({data:JSON.stringify({data:c,type:a}),source:d,target:i,origin:null})};c.pm.origin=EBG.pm.origin=null;var e={send:function(a){var a=
c.extend({},e.defaults,a),d=a.target;if(a.target&&a.type){var h={data:a.data,type:a.type};if(a.success)h.callback=e._callback(a.success);if(a.error)h.errback=e._callback(a.error);"postMessage"in d&&!a.hash&&(e._bind(),d.postMessage(JSON.stringify(h),a.origin||"*"))}},bind:function(d,g,h,i,j,k){"postMessage"in a&&!k&&(e._bind(i),i=e.data("listeners.postmessage"),i||(i={},e.data("listeners.postmessage",i)),k=i[d],k||(k=[],i[d]=k),k.push({fn:g,origin:j||c.pm.origin,bindObj:h}))},unbind:function(a,c){var d=
e.data("listeners.postmessage");if(d&&a)if(c){var i=d[a];if(i){for(var j=[],k=0,l=i.length;k<l;k++){var m=i[k];m.fn!==c&&j.push(m)}d[a]=j}}else delete d[a]},data:function(a,c){return c===d?e._data[a]:e._data[a]=c},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var a=[],c=0;32>c;c++)a[c]=e._CHARS[0|32*Math.random()];return a.join("")},_callback:function(a){var c=e.data("callbacks.postmessage");c||(c={},e.data("callbacks.postmessage",
c));var d=e._random();c[d]=a;return d},_bind:function(c){e.data("listening.postmessage")||(c=c?c:a,c.addEventListener?c.addEventListener("message",e._dispatch,!1):a.attachEvent&&c.attachEvent("onmessage",e._dispatch),e.data("listening.postmessage",1))},_dispatch:function(a){var c={};try{c=JSON.parse(a.data)}catch(d){return}if(c.type){var i=(e.data("callbacks.postmessage")||{})[c.type];if(i)i(c.data);else for(var i=(e.data("listeners.postmessage")||{})[c.type]||[],j=0,k=i.length;j<k;j++){var l=i[j];
if(l.origin&&a.origin!==l.origin)c.errback&&e.send({target:a.source,data:{message:"postmessage origin mismatch",origin:[a.origin,l.origin]},type:c.errback});else try{var m;m=l.bindObj?l.fn.apply(l.bindObj,[c.data,a]):l.fn(c.data,a);c.callback&&e.send({target:a.source,data:m,type:c.callback})}catch(o){c.errback&&e.send({target:a.source,data:o,type:c.errback})}}}}};c.extend(e,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})})(this,"undefined"===typeof jQuery?
null:jQuery);"JSON"in window&&window.JSON||(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function c(a){f.lastIndex=0;return f.test(a)?'"'+a.replace(f,function(a){var c=i[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(a,e){var f,i,n,q,s=g,r,p=e[a];p&&"object"===typeof p&&"function"===typeof p.toJSON&&(p=p.toJSON(a));"function"===typeof j&&(p=j.call(e,a,p));switch(typeof p){case "string":return c(p);case "number":return isFinite(p)?""+p:"null";case "boolean":case "null":return""+
p;case "object":if(!p)return"null";g+=h;r=[];if("[object Array]"===Object.prototype.toString.apply(p)){q=p.length;for(f=0;f<q;f+=1)r[f]=d(f,p)||"null";n=0===r.length?"[]":g?"[\n"+g+r.join(",\n"+g)+"\n"+s+"]":"["+r.join(",")+"]";g=s;return n}if(j&&"object"===typeof j){q=j.length;for(f=0;f<q;f+=1)i=j[f],"string"===typeof i&&(n=d(i,p))&&r.push(c(i)+(g?": ":":")+n)}else for(i in p)Object.hasOwnProperty.call(p,i)&&(n=d(i,p))&&r.push(c(i)+(g?": ":":")+n);n=0===r.length?"{}":g?"{\n"+g+r.join(",\n"+g)+"\n"+
s+"}":"{"+r.join(",")+"}";g=s;return n}}if("function"!==typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,h,i={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if("function"!==typeof JSON.stringify)JSON.stringify=function(a,c,e){var f;h=g="";if("number"===typeof e)for(f=0;f<e;f+=1)h+=" ";else"string"===typeof e&&(h=e);if((j=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return d("",
{"":a})};if("function"!==typeof JSON.parse)JSON.parse=function(a,c){function d(a,e){var f,g,h=a[e];if(h&&"object"===typeof h)for(f in h)Object.hasOwnProperty.call(h,f)&&(g=d(h,f),void 0!==g?h[f]=g:delete h[f]);return c.call(a,e,h)}var f;e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+a+")"),"function"===typeof c?d({"":f},""):f;throw new SyntaxError("JSON.parse");}})();EBG.declareNamespace("API");EBG.API.InjectionMethod={APPEND:"append",INSERT_BEFORE:"insertBefore"};EBG.API.BrowserTypes={NON_SUPPORTED:0,IE:1,FF:2,NN:3,SAFARI:4,CHROME:5,AOL:6,OPERA:7,EDGE:8};
EBG.API.PlatformTypes={NON_SUPPORTED:0,WIN_95:1,WIN_98:2,WIN_2000:3,WIN_XP:4,WIN_ME:5,WIN_NT:6,MAC:7,WIN_VISTA:8,WIN_7:9,IPHONE:10,IPAD:11,IPOD:12,ANDROID_2_TAB:13,ANDROID_3_TAB:14,WIN_10:15,ANDROID_5_TAB:16,ANDROID_2_MOBILE:17,ANDROID_3_MOBILE:18,WIN_MOBILE_7:19,ANDROID_4_TAB:20,ANDROID_4_MOBILE:21,WIN_8:22,MAC_NEW:23,MAC_YOSEMITE:24,ANDROID_5_MOBILE:25,CROS:26,FBAN:27,SMART_TV:28,UBUNTU:29,LINUX:30,ANDROID_1:31};EBG.API.DeviceTypes={DESKTOP:0,MOBILE:1,TABLET:2,UNKNOWN:3};
EBG.VideoInteraction={STARTED:"ebVideoStarted",PERCENT_25_PLAYED:"eb25Per_Played",PERCENT_50_PLAYED:"eb50Per_Played",PERCENT_75_PLAYED:"eb75Per_Played",FULLPLAY:"ebVideoFullPlay",MUTE:"ebVideoMute",UNMUTE:"ebVideoUnmute",PAUSE:"ebVideoPause",REPLAY:"ebVideoReplay",UNMUTED:"ebVideoUnmuted",FULLSCREEN_START:"ebFSStart",FULLSCREEN_END:"ebFSEnd",FULLSCREEN_MUTE:"ebFSVideoMute",FULLSCREEN_PAUSE:"ebFSVideoPause",SLIDER_DRAGGED:"ebSliderDragged",VIDEO_PLAY_DURATION:"ebVideoPlayDuration",VIDEO_ASSET_DURATION:"ebVideoAssetDuration",
FULLSCREEN_DURATION:"ebFSVideoPlayDuration",FULLSCREEN_ASSET_DURATION:"ebFSVideoAssetDuration",USER_INITIATED_VIDEO:"ebUserInitiatedVideo"};
EBG.EBMessage={REQ_INIT:"reqInit",INIT:"ebInit",INITDONE:"ebInitDone",GET_ENVIROMENT:"ebGetEnvironment",SHOW_DEFAULT_IMAGE:"ebShowDefaultImage",CLICKTHROUGH:"ebclickthrough",NOTIFIED_INTERACTION:"ebNotifiedInteraction",VERSION_TRACKING_IMPRESSION:"ebversiontrackingimpression",USER_ACTION_COUNTER:"ebCIUserActionCounter",AUTOMATIC_EVENT_COUNTER:"ebCIAutomaticEventCounter",START_TIMER:"ebCIStartTimer",UPDATE_TIMER:"ebUpdateTimer",STOP_TIMER:"ebCIStopTimer",START_VIDEO_TIMER:"ebStartVideoTimer",STOP_VIDEO_TIMER:"ebendvideotimer",
VIDEO_INTERACTION:"ebVideoInteraction",VIDEO_LOAD:"ebVideoLoad",INIT_VIDEO_LOADER:"ebInitVideoLoader",VIDEO_FS_OPEN:"ebVideoFSOpen",VIDEO_FS_CLOSE:"ebVideoFSClose",VIDEO_FS_AUTO_CLOSE:"ebVideoFSAutoClose",START_VIDEO:"ebtStartVideo",STOP_VIDEO:"ebtStoptVideo",UPDATE_VIDEO_DURATION:"ebtUpdateVideoDuration",FULL_SCREEN_OPEN:"ebFullScreenOpen",FULL_SCREEN_CLOSE:"ebFullScreenClose",FULL_SCREEN_AUTO_CLOSE:"ebFullScreenAutoClose",MOUSE_MOVE:"ebMouseMove",PAGE_LOAD:"ebPageLoad",TRIGGER_AD_START:"ebTriggerAdStart",
INIT_EXPANSION_PARAMS:"ebInitExpansionParams",NEW_SE:"ebNewSE",EXPAND:"ebExpandPanel",EXPAND_DONE:"ebExpandDone",COLLAPSE:"ebCollapsePanel",COLLAPSE_DONE:"ebCollapseDone",NOTIFY_INTERACTION_MONITOR:"NotifyInteractionMonitor",HIDE_INTRO:"ebHideIntro",INTRO_FULL_PLAY:"ebIntroFullPlay",KEEP_AD_OPREN:"ebKeepAdOpen",GO_TO_MINISITE:"ebGoToMiniSite",UPDATE_CLICK:"ebUpdateClick",DOCUMENT_LOADED:"ebDocumentLoaded",PLAY_VIDEO_ON_NATIVE_PLAYER:"playVideoOnNativePlayer",CREATE_CALENDAR_EVENT:"createCalendarEvent",
STORE_PICTURE:"storePicture",SDK_DATA_CHANGE:"sdkDataChange",SDK_EVENT:"sdkEvent",ADAPTOR_READY:"adaptorReady",SWIPE:"ebSwipe",DISPOSE:"ebDispose",SET_RESIZE_PROPS:"ebResizeProperties",RESIZE:"ebResize",SET_EXPAND_PROPS:"ebExpandProperties",SET_ORIENTATION_PROPS:"ebOrientationProperties",CLOSE:"ebClose",CLOSE_AD:"ebclosead",SET_STATE:"ebSetstate",RESET_STATE:"ebResetstate",REQ_MOUSE_MOVE:"ebReqMouseMove",ANIMATION:"ebAnimation",VISIBILITY:"ebVisibility"};EBG.DurationInteraction={TIMER:"Timer",AGGREGATE:"Aggregate"};
EBG.Animation={Easing:{linear:"linear",easeInQuad:"easeInQuad",easeOutQuad:"easeOutQuad",easeInOutQuad:"easeInOutQuad",easeInCubic:"easeInCubic",easeOutCubic:"easeOutCubic",easeInOutCubic:"easeInOutCubic",easeInQuart:"easeInQuart",easeOutQuart:"easeOutQuart",easeInOutQuart:"easeInOutQuart",easeInQuint:"easeInQuint",easeOutQuint:"easeOutQuint",easeInOutQuint:"easeInOutQuint"}};
EBG.INNERIFRAMEMessage={LOADED:"ebInnerIframeLoaded",INIT:"ebInitInnerIframe",VERIFY:"ebVerifyInnerIframe",EBO:"ebO",GLOBALPARAMS:"ebGlobalParams",CONTINUE_SENDING:"ContinueSending",NOT_LASTMSG:"NotLastMsg",LASTMSG:"LastMsg",ADCONFIG_REQUEST:"AdConfig_Request",SECRET_TAGS:"Secret_Tags"};
EBG.FS={EB_VERSION_TRACKING_IMPRESSION:"ebversiontrackingimpression",EB_CLICKTHROUGH:"ebclickthrough",EB_CREATIVE_EVENT_SUBSCRIPTION:"ebcreativeaddhdr",EB_CI_USER_ACTION_COUNTER:"ebciuseractioncounter",EB_CI_AUTOMATIC_EVENT_COUNTER:"ebciautomaticeventcounter",EB_VIDEO_INTERACTION:"ebvideointeraction",EB_START_TIMER:"ebstarttimer",EB_END_TIMER:"ebendtimer",EB_CI_START_TIMER:"ebcistarttimer",EB_CI_STOP_TIMER:"ebcistoptimer",EB_UPDATE_TIMER:"ebupdatetimer",EB_START_VIDEO_TIMER:"ebstartvideotimer",EB_STOP_VIDEO_TIMER:"ebendvideotimer",
EB_PAGE_LOAD:"ebpageload",EB_COMMAND:"ebcommand",EB_MSG:"ebmsg",EB_EXPAND_PANEL:"ebexpandpanel",EB_COLLAPSE_PANEL:"ebcollapsepanel",EB_SET_STATE:"ebsetstate",EB_RESET_STATE:"ebresetstate",EB_MOUSE_TRACKER:"ebmousetracker",EB_MOUSE_MOVE:"ebmousemove",EB_TEST_DC:"ebtestdc",EB_CLOSE_AD:"ebclosead",EB_REPLAY_AD:"ebreplayad",EB_REPLAY_EXP:"ebreplayexp",EB_LOAD_RICH_BANNER:"ebloadrichbanner",EB_SHOW_RICH_BANNER:"ebshowrichbanner",EB_INIT_VIDEO_LOADER:"ebinitvideoloader",EB_HIDE_INTRO:"ebhideintro",EB_INTRO_FULL_PLAY:"ebintrofullplay",
EB_KEEP_AD_OPREN:"ebkeepadopen",EB_GO_TO_MINISITE:"ebgotominisite",EB_VIDEO_LOAD:"ebvideoload",EB_VIDEO_LOAD_AND_PLAY:"ebvideoloadandplay",EB_FULL_SCREEN_OPEN:"ebfullscreenopen",EB_FULL_SCREEN_CLOSE:"ebfullscreenclose",EB_FULL_SCREEN_AUTO_CLOSE:"ebfullscreenautoclose",EB_VIDEO_FS_OPEN:"ebvideofsopen",EB_VIDEO_FS_CLOSE:"ebvideofsclose",EB_VIDEO_FS_AUTO_CLOSE:"ebvideofsautoclose",EB_START_VIDEO:"ebtstartvideo",EB_STOP_VIDEO:"ebtstopvideo",EB_UPDATE_VIDEO_DURATION:"ebtupdatevideoduration",EB_GET_JS_VAR:"ebgetjsvar",
EB_GET_ALL_JS_VARS:"ebgetalljsvars",EB_SET_JS_VAR:"ebsetjsvar",EB_INIT_SE:"ebinitse",EB_SET_SE_PROXY:"ebsetseproxy",EB_SE_EXPAND_STARTED:"ebseexpandstarted",EB_SE_RETRACT_STARTED:"ebseretractstarted",EB_SE_RETRACT_FINISHED:"ebseretractfinished",EB_NOTIFICATION:"notification",EB_VIDEO_ACTIVE_MODE:"ebvideoactivemode",EB_THROTTLE:"ebthrottle"};EBG.ActionType={USER:"user",AUTO:"auto"};EBG.ExpBaseInteractions={PANELS_VIEWED:"ebPanelsViewed",AUTO_SHOW:"autoshow",DURATION:"duration"};
EBG.SingleExpInteractions=EBG.ExpBaseInteractions;EBG.orientation={Both:"BOTH",Landscape:"LANDSCAPE",Portrait:"PORTAIT"};
EBG.adTypes={RichBannerHtml5:"Html5Banner",PoliteBannerHtml5:"Html5PoliteBanner",SEBannerHtml5:"Html5SEBanner",ExpBannerHtml5:"Html5ExpBanner",StdBanner:"StdBanner",Banner:"Banner",SingleExpBanner:"SingleExpBanner",ExpBanner:"ExpBanner",VisibilityAd:"Visibility",FloatingAd:"FloatingAd",FloatingAdWithRem:"FloatingAdWithReminder",TrackingAd:"Tracking",StdBannerHtml5:"Html5StdBanner",WallpaperAd:"WallpaperAd"};EBG.adParts={BANNER:"banner",PANEL:"panel",DEFAULTBANNER:"defaultBanner",RICHBANNER:"richBanner"};
EBG.WindowTarget={BLANK:"_blank",SELF:"_self",PARENT:"_parent",TOP:"_top"};EBG.Const={OUTER_DIV:"eyeDiv",DATACAPTURE:"/BurstingPipe/BurstingDataCapturePipe.asp",AKAMAIFCS_PLUID_9:"rtmp://flv.stream.atwola.com/flash/flv/mm",AKAMAIFCS_PLUID_43:"rtmp://eyeblaster.fcod.msecnd.net/vod/a10061/e1",AKAMAIFCS_PLUID_42_45:"rtmp://cp57388.edgefcs.net/ondemand",AKAMAI_DEFAULT:"rtmp://cp16207.edgefcs.net/ondemand",SHOW_HIDE_FLAG:"data-ebhidingoverlappingelement",SHOW_HIDE_BACKUP:"data-ebvisibilitybackup"};
EBG.PanelPositionType={PAGE_RELATIVE_PERCENTAGE:0,BANNER_RELATIVE_PIXELS:1,PAGE_RELATIVE_PIXELS:2,VIEWPORT_RELATIVE_PERCENTAGE:3,VIEWPORT_RELATIVE_PIXELS:4};EBG.PanelCorner={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_LEFT:3,BOTTOM_RIGHT:4};EBG.AnimationType={NONE:"none",LINEAR:"linear",EASE_OUT:"easeout",EASE_OUT_SNAP:"easeoutsnap"};EBG.ExpandCollapseMethod={CLIP:"clip",RESIZE:"resize"};
EBG.AnimationDefaults={easeOutCoefficient:0.1,stepTime:10,linearSteps:50,snapThreshold:10,animationType:EBG.AnimationType.NONE,snap:!1,checkShowHideOnEachStep:!1,hideAssetAfterExpand:!1,removeAssetAfterExpand:!1,hideAssetAfterCollapse:!0,removeAssetAfterCollapse:!0,method:EBG.ExpandCollapseMethod.ExpBanner,endAnimationHideAsset:!1,endAnimationRemoveAsset:!1};
EBG.AnimationPushDownDefaults={easeOutCoefficient:0.1,stepTime:50,linearSteps:20,snapThreshold:10,animationType:EBG.AnimationType.LINEAR,snap:!1,method:EBG.ExpandCollapseMethod.RESIZE,checkShowHideOnEachStep:!1,hideAssetAfterExpand:!1,removeAssetAfterExpand:!1,hideAssetAfterCollapse:!0,removeAssetAfterCollapse:!0,method:EBG.ExpandCollapseMethod.ExpBanner,endAnimationHideAsset:!1,endAnimationRemoveAsset:!1};
EBG.AnimProps={easeOutCoefficient:"easeOutCoefficient",snapThreshold:"snapThreshold",method:"method",endAnimationHideAsset:"endAnimationHideAsset",endAnimationRemoveAsset:"endAnimationRemoveAsset"};EBG.AnimDefaultProps={stepTime:"stepTime",linearSteps:"linearSteps",animationType:"animationType"};EBG.AnimNonDefaultPanelValues={animationType:EBG.AnimationType.NONE,stepTime:0,linearSteps:1};EBG.AnimExpansionProps={hideAssetAfterExpand:"hideAssetAfterExpand",removeAssetAfterExpand:"removeAssetAfterExpand"};
EBG.AnimCollapseProps={hideAssetAfterCollapse:"hideAssetAfterCollapse",removeAssetAfterCollapse:"removeAssetAfterCollapse"};EBG.ProtectedElementIds=["ebAd","eyeDiv","ebDefault","ebRich","ebDiv"];EBG.VisibilityMode={DEFAULT_MODE:"defaultMode",BASIC_MODE:"basicMode",ENHANCED_MODE:"enhancedMode"};EBG.AcCertProgram={IAB_EU:0,NAI_US:1};EBG.AcIconPosition={TopRight:0,TopLeft:1,BottomRight:2,BottomLeft:3};EBG.PreloadType={DefaultImg:0,PreloadImg:1,DefaultFlash:2};
EBG.ThrottleStates={LOAD:"load",THROTTLE:"throttle",RESUME:"resume",PAUSE:"pause",POLLED:"polled"};EBG.WebEnvironment={BROWSER:0,ANDROID_MOBILE_BROWESR:1,ANDROID_WEB_VIEW:2,IOS_MOBILE_BROWSER:3,IOS_WEB_VIEW:4,OTHER_MOBILE_BROWSER:5,OTHER_WEB_VIEW:6,ANDROID_UNKNOWN:97,IOS_UNKNOWN:98,UNKNOWN:99};EBG.SDK_STATES=EBG.SDK_STATES||{};EBG.SDK_STATES.API={DEFAULT:"SDKdefault",EXPANDED:"SDKexpanded",LOADING:"SDKloading",RESIZED:"SDKresized"};EBG.SDK_EVENTS=EBG.SDK_EVENTS||{};
EBG.SDK_EVENTS.API={STATE_CHANGE:"SDKstateChange",ERROR:"SDKerror",READY:"SDKready",VIEWABLE_CHANGE:"SDKviewableChange",SIZE_CHANGE:"SDKsizeChange",RESIZE_PROPS_CHANGE:"SDKresizePropsChange",EXPAND_PROPS_CHANGE:"SDKexpandPropsChange",WINDOW_SIZE_CHANGE:"windowSizeChange"};EBG.declareNamespace("Events");EBG.Events.EventTiming={BEFORE:"BEFORE",ONTIME:"ONTIME",AFTER:"AFTER",ONTIME_AND_AFTER:"ONTIME_AND_AFTER"};
EBG.Events.EventNames={CREATE_AD:"CREATE_AD",CREATE_ADAPTOR:"CREATE_ADAPTOR",CREATE_INT_MGR:"CREATE_INT_MGR",CREATE_ANIM_MGR:"CREATE_ANIM_MGR",CREATE_POSITIONING_HELPER:"CREATE_POSITIONING_HELPER",SHOW_AD:"SHOW_AD",ADD_CREATIVES:"ADD_CREATIVES",ADD_INTERACTION:"ADD_INTERACTION",ADD_EYE_DIV:"ADD_EYE_DIV",ADD_HTML5_MAIN_CREATIVE:"ADD_HTML5_MAIN_CREATIVE",ADD_HTML5_PANEL_CREATIVE:"ADD_HTML5_PANEL_CREATIVE",ADD_EMPTY_BANNER_CREATIVE:"ADD_EMPTY_BANNER_CREATIVE",ADD_BANNER_DEFAULT_IMAGE_CREATIVE:"ADD_BANNER_DEFAULT_IMAGE_CREATIVE",
ADD_BANNER_PRELOAD_IMAGE_CREATIVE:"ADD_BANNER_PRELOAD_IMAGE_CREATIVE",ADD_BANNER_DEFAULT_FLASH_CREATIVE:"ADD_BANNER_DEFAULT_FLASH_CREATIVE",ADD_BANNER_RICH_FLASH_CREATIVE:"ADD_BANNER_RICH_FLASH_CREATIVE",ADD_FLOATING_INTRO_CREATIVE:"ADD_FLOATING_INTRO_CREATIVE",ADD_FLOATING_REMINDER_CREATIVE:"ADD_FLOATING_REMINDER_CREATIVE",ADD_FLOATING_MINISITE_CREATIVE:"ADD_FLOATING_MINISITE_CREATIVE",ADD_PANEL_RICH_FLASH_CREATIVE:"ADD_PANEL_RICH_FLASH_CREATIVE",SHOW_BANNER_RICH_FLASH_CREATIVE:"SHOW_BANNER_RICH_FLASH_CREATIVE",
SHOW_PANEL_RICH_FLASH_CREATIVE:"SHOW_PANEL_RICH_FLASH_CREATIVE",SHOW_PANEL_CREATIVE:"SHOW_PANEL_CREATIVE",SHOW_REMINDER:"SHOW_REMINDER",SHOW_MINISITE:"SHOW_MINISITE",PAGE_LOAD:"PAGE_LOAD",COLLECT_TIMERS:"COLLECT_TIMERS",PAGE_UNLOAD:"PAGE_UNLOAD",PAGE_BEFORE_UNLOAD:"PAGE_BEFORE_UNLOAD",PAGE_HIDE:"PAGE_HIDE",PAGE_RESIZE:"PAGE_RESIZE",PAGE_SCROLL:"PAGE_SCROLL",PAGE_FOCUS:"PAGE_FOCUS",PAGE_FOCUSIN:"PAGE_FOCUSIN",PAGE_FOCUSOUT:"PAGE_FOCUSOUT",PAGE_BLUR:"PAGE_BLUR",PAGE_HIDDEN:"PAGE_HIDDEN",PAGE_VISIBLE:"PAGE_VISIBLE",
INTERACTION_REPORT_REMOTE_SERVERS:"INTERACTION_REPORT_REMOTE_SERVERS",START_TIMER:"START_TIMER",STOP_TIMER:"STOP_TIMER",UPDATE_TIMER:"UPDATE_TIMER",HANDLE_COUNTER_INTERACTION:"HANDLE_COUNTER_INTERACTION",DEFAULT_CLICK:"DEFAULT_CLICK",EXPAND:"EXPAND",COLLAPSE:"COLLAPSE",USER_INTERACTION:"USER_INTERACTION",MOUSE_OVER:"MOUSE_OVER",MOUSE_OUT:"MOUSE_OUT",MOUSE_MOVE:"MOUSE_MOVE",MODULE_LOAD:"MODULE_LOAD",USER_INITIATED_VIDEO:"USER_INITIATED_VIDEO",DWELL_UNIQUE:"DWELL_UNIQUE",DWELL_VIDEO_START:"DWELL_VIDEO_START",
DWELL_VIDEO_STOP:"DWELL_VIDEO_STOP",CREATIVE_CONTAINER_READY:"CREATIVE_CONTAINER_READY",RICH_FLASH_PLAYED:"RICH_FLASH_PLAYED",REPLAY_AD:"REPLAY_AD",BANDWITH_DETECTED:"BANDWITH_DETECTED",FULL_SCREEN_START:"FULL_SCREEN_START",FULL_SCREEN_END:"FULL_SCREEN_STOP",ANIMATE_PANEL:"ANIMATE_PANEL",CLOSE_AD:"CLOSE_AD",OPEN_PAGE:"OPEN_PAGE",MAX_AD_DURATION:"MAX_AD_DURATION",FLASH_IN_FRAME_TWO:"FLASH_IN_FRAME_TWO",SHOW_HIDE_ELEMENTS:"SHOW_HIDE_ELEMENTS",DEFAULT_IMPRESSION:"DEFAULT_IMPRESSION",AIE_LOADED:"AIE_LOADED",
INIT_MANAGERS:"INIT_MANAGERS",MOUSE_MOVE_NEEDED:"MOUSE_MOVE_NEEDED",VISIBILITY_CHECK:"VISIBILITY_CHECK",VISIBILITY_HIDDEN:"VISIBILITY_HIDDEN",AD_START:"AD_START",ELEMENT_LOADED:"ELEMENT_LOADED",AD_STACKING:"AD_STACKING",SCREEN_ORIENTATION:"SCREEN_ORIENTATION",PORTRAIT:"PORTRAIT",LANDSCAPE:"LANDSCAPE",CHANGE_PANEL_POSITION:"CHANGE_PANEL_POSITION",PANEL_FREQUENCY_LOADED:"PANEL_FREQUENCY_LOADED",THROTTLED:"THROTTLED",FLASH_DETECTED:"FLASH_DETECTED",ANIMATION:"ANIMATION"};
EBG.Events.EbEventNames={PAGE_LOAD:EBG.Events.EventNames.PAGE_LOAD,SCREEN_ORIENTATION:EBG.Events.EventNames.SCREEN_ORIENTATION,VISIBILITY:EBG.Events.EventNames.VISIBILITY_CHECK};EBG.Events.EventSubscription=function(a,c,d){this.eventName=a;this.callback=c;this.callbackBinding=d?d:null};
EBG.Events.EventSubscription.prototype={dispatcherFilters:null,timing:EBG.Events.EventTiming.ONTIME,isElementEvent:!1,elementId:"",isDocumentEvent:!1,isValid:function(){return EBG.isFunc(this.callback)&&(!this.callbackBinding||EBG.isObj(this.callbackBinding))},toString:function(){return EBG.format("EventSubscription: eventName={0}, timing={1}, callback={2}, callbackBinding={3}, dispatcherFilters={4}",this.eventName,this.timing,EBG.typeOf(this.callback),EBG.typeOf(this.callbackBinding),EBG.typeOf(this.dispatcherFilters))}};
EBG.declareClass(EBG.Events.EventSubscription,null);EBG.Events.Event=function(a){this.name=a;this.creationTime=+new Date};EBG.Events.Event.prototype={dispatcher:null,eventData:null,timing:null,toString:function(){return EBG.format("Event: name={0}, creationTime={1}, dispatcher={2}, eventData={3}",this.name,this.creationTime,EBG.typeOf(this.dispatcher),EBG.typeOf(this.eventData))}};EBG.declareClass(EBG.Events.Event,null);EBG.Events.EventManager=function(){this._subscriptions={}};
EBG.Events.EventManager.prototype={_subscriptions:{},subscribeToEvent:function(a){if(a.isValid())if(a.isElementEvent)EBG.adaptor&&EBG.adaptor.subscribeToEventOnElement(a.eventName,a.elementId,a.callback);else{var c=this._subscriptions[a.eventName]=this._subscriptions[a.eventName]||{},d;for(d in EBG.Events.EventTiming)EBG.Events.EventTiming.hasOwnProperty(d)&&(c[d]=c[d]||[]);-1==this._getSubscriptionId(a,c[a.timing])&&(c[a.timing].push(a),EBG.adaptor&&EBG.adaptor.hasEvent(a.eventName)&&EBG.adaptor.subscribeToEvent(a.eventName,
a.isDocumentEvent))}},unsubscribeFromEvent:function(a){if(a&&a.isValid())if(a.isElementEvent)EBG.adaptor&&EBG.adaptor.unsubscribeFromEventOnElement(a.eventName,a.elementId,a.callback);else if(this._subscriptions[a.eventName]&&this._subscriptions[a.eventName][a.timing]){var c=this._subscriptions[a.eventName][a.timing],a=this._getSubscriptionId(a,c);-1!=a&&(c[a]=null)}},dispatchEvent:function(a){var c=!1;switch(a.timing){case EBG.Events.EventTiming.BEFORE:case EBG.Events.EventTiming.ONTIME:case EBG.Events.EventTiming.AFTER:c=
this._dispatchEventByTiming(a,a.timing);break;case EBG.Events.EventTiming.ONTIME_AND_AFTER:c=(c=this._dispatchEventByTiming(a,EBG.Events.EventTiming.ONTIME))||this._dispatchEventByTiming(a,EBG.Events.EventTiming.AFTER);break;default:c=(c=(c=this._dispatchEventByTiming(a,EBG.Events.EventTiming.BEFORE))||this._dispatchEventByTiming(a,EBG.Events.EventTiming.ONTIME))||this._dispatchEventByTiming(a,EBG.Events.EventTiming.AFTER)}return c},attachToAdaptor:function(){EBG.adaptor.setListener(this.dispatchEvent,
this)},_dispatchEventByTiming:function(a,c){var d=this._subscriptions[a.name];if(!d)return!1;for(var d=d[c],e=!1,f=0;f<d.length;f++){var g=d[f];if(g&&(g=this._dispatchEventToSubscription(a,g),EBG.isBool(g)&&!g)){e=!0;break}}return e},_dispatchEventToSubscription:function(a,c){var d=c.dispatcherFilters;if(EBG.isObj(d))for(var e in d)if(d.hasOwnProperty(e)){var f=d[e],g=!0,h=e.split("."),i=a.dispatcher;if(i)for(var j=0;j<h.length;j++){var i=i[h[j]],k=j==h.length-1;if(!i||k&&i!==f){g=!1;break}}if(!g)return null}d=
null;e=c.callback;if(EBG.isFunc(e)){f=[a];try{d=e.apply(c.callbackBinding,f)}catch(l){}}return d},_getSubscriptionId:function(a,c){for(var d=0;d<c.length;d++)if(c[d]&&c[d].callback===a.callback&&c[d].callbackBinding===a.callbackBinding&&c[d].isDocumentEvent===a.isDocumentEvent&&this._compareFilters(c[d].dispatcherFilters,a.dispatcherFilters))return d;return-1},_compareFilters:function(a,c){if(!EBG.isObj(a))return EBG.isObj(c)?!1:!0;if(!EBG.isObj(c))return!1;for(var d in a)if(a.hasOwnProperty(d))if(c.hasOwnProperty(d)){if(a[d]!==
c[d])return!1}else return!1;for(d in c)if(c.hasOwnProperty(d)&&!a.hasOwnProperty(d))return!1;return!0}};EBG.declareClass(EBG.Events.EventManager,null);EBG.eventMgr=EBG.eventMgr||new EBG.Events.EventManager;EBG.declareNamespace("Adaptors");EBG.Adaptors.TagNames={DIV:"div",IFRAME:"iframe",IMG:"img",SCRIPT:"script",OBJECT:"object",EMBED:"embed",SPAN:"span",A:"a",BODY:"body"};EBG.Adaptors.InjectionMethod=EBG.API.InjectionMethod;
EBG.Adaptors.WindowProp={top:"top",left:"left",location:"location",menubar:"menubar",width:"width",height:"height"};EBG.Adaptors.MoreSupportedEvent={visibilitychange:1,mozvisibilitychange:1,msvisibilitychange:1,webkitvisibilitychange:1};EBG.Adaptors.StdWebAdaptor=function(){this._setEvents()};EBG.Adaptors.StdWebAdaptor.onEnvEvent=function(){EBG.adaptor._handleEvent.apply(EBG.adaptor,arguments)};
EBG.Adaptors.StdWebAdaptor.prototype={_environmentEvents:{},_logicalEvents:{},_subscribedEvents:{},_subscribedEventsOnElement:[],_listener:null,_listenerBinding:null,initInnerModules:function(a,c,d,e,f){if(!this.browser)this.browser=new EBG.Adaptors.Browser(a,c,d,e,f);if(!this.flash)this.flash=EBG.Adaptors.FlashDetector?new EBG.Adaptors.FlashDetector:null},registerSpecialBrowserEvents:function(){},loadModule:function(a,c,d,e,f){if(!a||!c||!d)return!1;c={tagName:EBG.Adaptors.TagNames.SCRIPT,attributes:{src:c.modulesDir+
a+".js"}};if(EBG.eventMgr&&e){var g=new EBG.Events.EventSubscription(EBG.Events.EventNames.MODULE_LOAD,function(c){c.eventData.moduleName==a&&e.call(f,c)});EBG.eventMgr.subscribeToEvent(g)}this.inject(c,EBG.Adaptors.InjectionMethod.APPEND,d)},copy:function(a){for(var c in this._subscribedEvents)this._subscribedEvents.hasOwnProperty(c)&&(this._removeEventListener(window,this._environmentEvents[c].name,EBG.Adaptors.StdWebAdaptor.onEnvEvent),a.subscribeToEvent(c));for(c=0;c<this._subscribedEventsOnElement.length;c++){var d=
this._subscribedEventsOnElement[c];if(d){var e=d.elementId,f=d.eventName,d=d.callback,g=this.getElementById(e);g&&(this._removeEventListener(g,f,d),a.subscribeToEventOnElement(f,e,d))}}a.flash=this.flash||null},intMonitorExist:function(){return EBG.isPreview&&top.ebHandleFsCommandsPrev},notifyIntMonitor:function(a){top.ebHandleFsCommandsPrev(a.command,a.args,a.objName,a.adId,a.elapsedTime)},hasEvent:function(a){return!!this._environmentEvents[a]},generateElementId:function(a,c){return EBG.format("eb{0}_{1}",
a,c)},_getTags:function(a,c){EBG.isGlobalDef("JSON");var d="";if(c&&a.tagName==EBG.Adaptors.TagNames.SCRIPT&&a.text&&!a.attributes)c.push(a);else{d="";a.attributes&&(this._setObjDefaultAttributes(a),d=this._getObjAttributesStr(a));d=EBG.format("<{0} {1}>",a.tagName,d);a.innerHTML&&(d+=a.innerHTML);a.text&&(d+=a.text);a.params&&(d+=this._getObjParamsStr(a));if(a.children)for(var e=0;e<a.children.length;e++)d+=this._getTags(a.children[e],c);d+=EBG.format("</{0}>",a.tagName)}return d},writeReportingIFrame:function(a,
c,d){this.inject({tagName:EBG.Adaptors.TagNames.IFRAME,attributes:{id:a,src:c,style:{width:"0px",height:"0px"},frameborder:0}},EBG.Adaptors.InjectionMethod.APPEND,this.getElementById(d))},writeScript:function(a,c,d){try{this.inject({tagName:EBG.Adaptors.TagNames.SCRIPT,attributes:{id:a,name:a,src:c}},EBG.Adaptors.InjectionMethod.APPEND,this.getElementById(d))}catch(e){}},write:function(a){this._documentWrite(this._getTags(a))},inject:function(a,c,d){var e=d.ownerDocument.createElement(a.tagName);
if(a.attributes){this._setObjDefaultAttributes(a);for(var f in a.attributes)EBG.isObj(a.attributes[f])?this.setStyleToElem(e,a.attributes[f]):e.setAttribute(f,a.attributes[f])}switch(c){case EBG.Adaptors.InjectionMethod.INSERT_BEFORE:d.parentNode.insertBefore(e,d);break;default:d.appendChild(e)}f="";if(a.innerHTML)f=a.innerHTML;var g=[];if(a.children)for(var h=0;h<a.children.length;h++){var i=a.children[h];f+=EBG.adaptor._getTags(i,g);i.meta&&!0==i.meta.isChromePowerSaver&&this._resizeAfterPaint(i.attributes.id,
i.meta.origWidth,i.meta.origHeight)}if(f)e.innerHTML=f;if(a.text)e.text=a.text;for(h=0;h<g.length;h++)this.inject(g[h],c,d);return e},addInlineDOM:function(a,c){this.inject(a,EBG.Adaptors.InjectionMethod.APPEND,this.getElementById(c))},setInnerHtml:function(a,c){a.innerHTML=c},setStyleToElem:function(a,c){for(var d in c)c.hasOwnProperty(d)&&(a.style[d]=c[d])},getStyleOfElem:function(a){if(a)return a.style},setListener:function(a,c){this._listener=a;this._listenerBinding=c},hasHiddenParent:function(a){if(!a)return!1;
for(var c="none"==window.getComputedStyle(a).display;(a=a.parentElement)&&!(c="none"==window.getComputedStyle(a).display););return c},subscribeToEvent:function(a,c){var d=this.getDisplayWin(),e=this.getPageWin();if(this.hasEvent(a)&&!this._subscribedEvents[a]){var f=this._environmentEvents[a],g=f.inCurWin?window:this.getPageWin();if(c)g=g.document;this._logicalEvents[f.name].signInAllWindows&&this.serving.detectServingMode(!0)===EBG.Adaptors.ServingMode.FRIENDLY_IFRAME&&d!==e?(this._addEventListener(e,
f.name,EBG.Adaptors.StdWebAdaptor.onEnvEvent),this._addEventListener(d,f.name,EBG.Adaptors.StdWebAdaptor.onEnvEvent)):this._addEventListener(g,f.name,EBG.Adaptors.StdWebAdaptor.onEnvEvent);this._subscribedEvents[a]={}}},subscribeToEventOnElement:function(a,c,d){var e=!1,f="string"==typeof c?this.getDisplayWin().document.getElementById(c):c;f||(e=!0);for(var g=this._subscribedEventsOnElement.length,h=0;h<g;h++)if(this._subscribedEventsOnElement[h]&&this._subscribedEventsOnElement[h].elementId==c&&
this._subscribedEventsOnElement[h].eventName==a){e=!0;break}e||(this._addEventListener(f,a,d),this._subscribedEventsOnElement[g]={elementId:c,eventName:a,callback:d})},unsubscribeFromEventOnElement:function(a,c,d){var e="string"==typeof c?this.getDisplayWin().document.getElementById(c):c;if(e){for(var f=this._subscribedEventsOnElement.length,g=-1,h=0;h<f;h++)if(this._subscribedEventsOnElement[h]&&this._subscribedEventsOnElement[h].elementId==c&&this._subscribedEventsOnElement[h].eventName==a&&this._subscribedEventsOnElement[h].callback==
d){g=h;break}0<=h&&(this._removeEventListener(e,a,d),this._subscribedEventsOnElement[g]=null)}},_addEventListener:function(a,c,d){"load"==c&&this.isPageLoaded()?setTimeout(function(){d({type:"load"})},5):window.addEventListener?a.addEventListener(c,d,!1):window.attachEvent&&a.attachEvent("on"+c,d)},_removeEventListener:function(a,c,d){window.removeEventListener?a.removeEventListener(c,d,!1):window.detachEvent&&a.detachEvent("on"+c,d)},_checkIfPropExist:function(a,c){return a&&0<=a?EBG.format(", {0}={1}",
c,a):""},openPage:function(a,c){var d=EBG.WindowTarget.BLANK,e="",f=null;if(c&&(d=c.target,c.xPos||c.yPos||c.width||c.height))e="titlebar=1,resizable=1,scrollbars=1,directories=0,toolbar=1,status=1"+this._checkIfPropExist(c.yPos,EBG.Adaptors.WindowProp.top),e+=this._checkIfPropExist(c.xPos,EBG.Adaptors.WindowProp.left),e+=this._checkIfPropExist(c.showAddressBar,EBG.Adaptors.WindowProp.location),e+=this._checkIfPropExist(c.showMenuBar,EBG.Adaptors.WindowProp.menubar),e+=this._checkIfPropExist(c.width,
EBG.Adaptors.WindowProp.width),e+=this._checkIfPropExist(c.height,EBG.Adaptors.WindowProp.height);return f=""!=e?window.open(a,d,e):window.open(a,d)},reportBeacon:function(a){navigator&&EBG.isFunc(navigator.sendBeacon)&&navigator.sendBeacon(a)},reportToRemoteServerUsingImage:function(){var a=[];return function(c){for(var d=0;d<a.length;d++)if(a[d]===c)return;this.ReportingImg=new Image;this.ReportingImg.src=c;a.push(c)}}(),getDataFromRemoteServer:function(a,c,d,e,f){return EBG.getDataFromRemoteServer(a,
c,d,e,f)},reportToRemoteServer:function(a,c,d){if(a&&!EBG.isOfflineDemo){var c=!!c,e=this.getRequestMethod(a),f;"POST"==e&&(f=a.split("?"),a=f[0],f=f[1]);var g=!1;try{if(this.browser.isSafari()&&"POST"==e){var h=document.createElement("iframe");h.style.display="none";h.style.width="0px";h.style.height="0px";document.body.appendChild(h);h=h.contentWindow?h.contentWindow:h.contentDocument.document?h.contentDocument.document:h.contentDocument;h.document.open();h.document.write(this.getIframeFormScript(a,
f));h.document.close();g=!0}else if(EBG._isXMLHttpRequestSupported()){var i=new XMLHttpRequest;i.open(e,a,c);if(c||!c&&!this.browser.isFF())i.withCredentials=!0;try{i.send(f)}catch(j){if(c)throw j;}g=!0}else if(window.XDomainRequest&&(!EBG.isDefined(d)||!d)&&c){var k=new XDomainRequest;k.open(e,a);k.send(f);g=!0}}catch(l){g=!1}g||this.reportToRemoteServerUsingImage(a)}},getIframeFormScript:function(a,c){return'<script>var e=document.createElement("form"),t="'+c+'".split("&");e.setAttribute("method","post"),e.setAttribute("action","'+
a+'");for(var i=0;i<t.length;++i){var a=t[i].substr(0,t[i].indexOf("=")),r=t[i].substr(t[i].indexOf("=")+1),m=document.createElement("input");m.setAttribute("type","hidden"),m.setAttribute("name",a),m.setAttribute("value",r),e.appendChild(m)}e.submit();<\/script>'},getElementById:function(a,c){var d=null,c=c?c:this.getDisplayWin();EBG.isDefinedNotNull(a)&&(d=c.document.getElementById(a));return d},supportsPageLoadEvents:function(){return!(this.browser.isOpera()&&14>this.browser.getVersion())&&!(this.browser.isIE()&&
7>this.browser.getVersion())},getHostName:function(a){return(a?a:this.getDisplayWin()).location.hostname},getDomain:function(a){return(a?a:this.getDisplayWin()).document.domain},getDisplayWin:function(){return window},getPageWin:function(){return window},inInnerIframe:function(){return!1},inPlacementIframe:function(){return!1},_setEvents:function(){this.supportsPageLoadEvents&&(this._setEvent(EBG.Events.EventNames.PAGE_LOAD,"load"),this._setEvent(EBG.Events.EventNames.PAGE_UNLOAD,"unload",!0),this._setEvent(EBG.Events.EventNames.PAGE_BEFORE_UNLOAD,
"beforeunload",!0),this._setEvent(EBG.Events.EventNames.PAGE_HIDE,"pagehide",!0));this._setEvent(EBG.Events.EventNames.PAGE_RESIZE,"resize");this._setEvent(EBG.Events.EventNames.SCREEN_ORIENTATION,"orientationchange");this._setEvent(EBG.Events.EventNames.MOUSE_MOVE,"mousemove",!1,["clientX","clientY","pageX","pageY","view"],!0)},_setEvent:function(a,c,d,e,f){this._environmentEvents[a]={name:c,inCurWin:d?d:!1};this._logicalEvents[c]={name:a,signInAllWindows:f};if(e){this._logicalEvents[c].attr=[];
for(a=0;a<e.length;a++)this._logicalEvents[c].attr[a]=e[a]}},_documentWrite:function(a){document.write(a)},isPageLoaded:function(){if(this._isPageLoaded)return!0;this._isPageLoaded=EBGInfra.isDefined(window.gEBMainWindow)&&EBGInfra.isDefined(gEBMainWindow.EBP)&&gEBMainWindow.EBP.isPageLoaded;if(!this._isPageLoaded&&this.getPageWin().document.readyState)this._isPageLoaded="complete"==this.getPageWin().document.readyState;return EBG.adaptor._isPageLoaded},_handleEvent:function(a){var c=this._logicalEvents[a.type].name;
switch(c){case EBG.Events.EventNames.PAGE_LOAD:this._isPageLoaded=!0;break;case EBG.Events.EventNames.PAGE_RESIZE:EBG.adaptor.inInnerIframe()&&this.serving.rehidePlacementIframe();break;case EBG.Events.EventNames.SCREEN_ORIENTATION:this._handleOrientationEvent();return;case EBG.Events.EventNames.PAGE_BEFORE_UNLOAD:if(this.browser.isIE()&&this._isPageLoaded)return}c&&(c=new EBG.Events.Event(c),EBGInfra.isDefinedNotNull(this._logicalEvents[a.type].attr)&&this._prepareLogicalEventData(c,a,this._logicalEvents[a.type].attr),
EBG.isFunc(this._listener)&&this._listener.call(this._listenerBinding,c))},_handleOrientationEvent:function(){},_prepareLogicalEventData:function(a,c,d){try{a.eventData={};for(var e=0;e<d.length;e++)a.eventData[d[e]]=c[d[e]]}catch(f){}},_getDefaultAttributes:function(a){var c={};switch(a.toLowerCase()){case EBG.Adaptors.TagNames.IFRAME:c={marginheight:"0px",marginwidth:"0px",frameborder:"0",scrolling:"no"}}return c},_getDefaultStyle:function(a){var c={border:"0px",padding:"0px",margin:"0px"};switch(a.toLowerCase()){case EBG.Adaptors.TagNames.DIV:EBG.mergeObj({top:"0px",
left:"0px",overflow:"visible",fontSize:"0px",lineHeight:"0px",textAlign:"left"},c,!0)}return c},_setObjDefaultAttributes:function(a){var c=this._getDefaultAttributes(a.tagName);EBG.mergeObj(a.attributes,c,!0);c.style=this._getDefaultStyle(a.tagName);a.attributes.style&&EBG.mergeObj(a.attributes.style,c.style,!0);a.attributes=c},_getObjParamsStr:function(a){var a=a.params,c="",d;for(d in a)a.hasOwnProperty(d)&&(c+=EBG.format("<PARAM name='{0}' value='{1}'>",d,a[d]));return c},_getObjAttributesStr:function(a){var a=
a.attributes,c="",d;for(d in a)if(a.hasOwnProperty(d)){var e=a[d];if(EBG.isObj(e)){var f=e,e="",g;for(g in f)if(f.hasOwnProperty(g)){var h=f[g];"textAlign"==g&&(g="text-align");e+=EBG.format("{0}:{1}; ",g,h)}}if(e)try{e=e.toString().replace(/\"/ig,"&quot;"),c+=EBG.format(' {0}="{1}"',d,e)}catch(i){}}return c},_resizeAfterPaint:function(a,c,d){c&&d&&EBG.runTimed(this,function(){var e=this.getElementById(a);this.setElemStyle(e,"width",c);this.setElemStyle(e,"height",d)},[],50)},handleEvent:function(a){this._handleEvent(a)},
setElemStyle:function(a,c,d){a.style[c]=d},getBrowserLanguage:function(){var a="en-US";if("undefined"!==typeof navigator.language)a=navigator.language;else if("undefined"!==typeof navigator.userLanguage)a=navigator.userLanguage;return a},getPositioningById:function(a,c,d){return this.getPositioningByElement(this.getElementById(a),c,d)},getPositioningByElement:function(a,c,d){a=a&&a.getBoundingClientRect?a.getBoundingClientRect():null;if(!a)return null;c=this.getScrollLeftTop(c,d);return{X:Math.floor(a.left)+
c.X,Y:Math.floor(a.top)+c.Y}},getScrollLeftTop:function(a,c){var d=this._getCurrentWindow(a,c),e=d.document,f={X:{"0":"XOffset",1:"Left"},Y:{"0":"YOffset",1:"Top"}},g;for(g in f)f[g]=d["page"+f[g][0]]||(e.documentElement?e.documentElement["scroll"+f[g][1]]:e.documentElement["page"+f[g][0]])||(e.body?e.body["scroll"+f[g][1]]:0);return f},_getCurrentWindow:function(a){try{return a?this.getDisplayWin():top}catch(c){}},getRequestMethod:function(a){return this.browser.isIE()&&6==this.browser.getVersion()||
this.isInApp()?"GET":2E3<a.length?"POST":"GET"},removeElement:function(a){if(a=this.getElementById(a))a.parentNode.removeChild(a),a.removeNode&&a.removeNode(!0)},appendChildElement:function(a,c){a&&c&&this.getElementById(a).appendChild(c)},getMaxZIndex:function(a){if(this.browser.isIE()&&8>this.browser.getVersion())return 10001;var c=0;if(a){var d=this.getStyleOfElem(a);d&&d.zIndex&&(c=d.zIndex);for(var e in a.childNodes)e&&a.childNodes[e]&&(d=this.getMaxZIndex(a.childNodes[e]),c=c>d?c:d)}return c},
setCookieKeyValuePair:function(a,c,d){if(EBG.isDefined(a)&&""!=a&&EBG.isDefined(c))c=EBG.isDefined(d)&&d?escape(c):c,document.cookie=a+"="+c+";"},isSafeFrame:function(){return!(!window.$sf||!$sf.ext)},isInApp:function(){return!1},isSkype:function(){try{return!!(window.$WLXRmAd||window.parent&&window.parent.$WLXRmAd)}catch(a){return!1}},isReady:function(){return!0},getBoundingClientRect:function(a,c){if(!a||!this.getElementById(a.id))return null;var c=c||{},d=a.getBoundingClientRect(),d={top:~~d.top,
left:~~d.left,bottom:~~d.bottom,right:~~d.right};d.width=~~d.width||d.right-d.left;d.height=~~d.height||d.bottom-d.top;if(c.clip)try{var e=/rect\((.*?)px(.*?)px(.*?)px(.*?)px\)/g.exec(this.getComputedStyle(a).getPropertyValue("clip"));if(e){for(var f=0;f<e.length;f++)e[f]=1*e[f].replace(/\D/g,"");if("0"!=e[0]){var g={top:d.top+e[1],left:d.left+e[4]};g.right=Math.min(g.left+(e[2]-e[4]),d.right);g.bottom=Math.min(g.top+(e[3]-e[1]),d.bottom);g.width=g.right-g.left;g.height=g.bottom-g.top;d=g}}}catch(h){}if(c.relativeToTop){for(var f=
e=0,g=EBG.getTopAccessibleWindow(),i=a.ownerDocument,i=i.defaultView||i.parentWindow;i!==g&&i.frameElement;)var j=i.frameElement.getBoundingClientRect(),e=e+j.top,f=f+j.left,i=i.parent;d.top+=e;d.left+=f;d.bottom+=e;d.right+=f}c.relativeToWindow&&(e=window.pageXOffset||document.documentElement.scrollLeft,f=window.pageYOffset||document.documentElement.scrollTop,d.top+=f,d.left+=e,d.bottom+=f,d.right+=e);return d},getComputedStyle:function(){return window.getComputedStyle?function(a,c){return(this.getElementWindow(a)||
window).getComputedStyle(a,c)}:function(a){var c={};c.el=a;c.getPropertyValue=function(c){var e=/(\-([a-z]){1})/g;"float"==c&&(c="styleFloat");e.test(c)&&(c=c.replace(e,function(a,c,d){return d.toUpperCase()}));return a.currentStyle[c]?a.currentStyle[c]:a.style[c]?a.style[c]:null};return c}}(),isPageVisible:function(){var a=!0;(a=(a=this._getVisibilityEventHidden())&&document[a]?!1:!0)&&this.browser.isIE()&&this.serving.detectServingMode(!0)!=EBG.Adaptors.ServingMode.IFRAME&&(a=a&&this.focused);return a},
_getVisibilityEventHidden:function(){var a=null;"undefined"!==typeof document.hidden?a="hidden":"undefined"!==typeof document.mozHidden?a="mozHidden":"undefined"!==typeof document.msHidden?a="msHidden":"undefined"!==typeof document.webkitHidden&&(a="webkitHidden");return a},getObjKeys:function(a){a=a||{};if(Object.keys)return Object.keys(a);var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(d);return c}};EBG.declareClass(EBG.Adaptors.StdWebAdaptor,null);
EBG.Adaptors.WebAdaptor=function(){this._init();EBG.callSuperConstructor(EBG.Adaptors.WebAdaptor,this);EBG.adaptor&&EBG.adaptor.copy(this)};
EBG.Adaptors.WebAdaptor.prototype={_previousWidth:-1,_previousHeight:-1,_screenOrientation:"",scrollBarWidth:0,_isReady:!1,focused:!1,_init:function(){this._sendReady()},isReady:function(){return this._isReady},isSDKDefined:function(){return!1},updateScrollBarWidth:function(){EBG.adaptor.scrollBarWidth=EBG.adaptor.getScrollerWidth()},initInnerModules:function(a,c,d,e,f,g){EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"initInnerModules",[a,c,d,e,f]);this.updateScrollBarWidth();if(!this.serving)this.serving=
EBG.Adaptors.ServingMgr?new EBG.Adaptors.ServingMgr:null;this.serving.noInDapIFFlag=g;this._addEventListener(this.getDisplayWin(),"resize",EBG.adaptor.updateScrollBarWidth)},_pageResizeHandler:function(){this._handleOrientationEvent()},_handleOrientationEvent:function(){this._checkOrientationEvent();EBG.runTimed(this,this._checkOrientationEvent,[],300)},_checkOrientationEvent:function(){if(this.browser.isMobile()&&this._isOrientationChange()){this._setScreenOrientation();var a=new EBG.Events.Event(EBG.Events.EventNames.SCREEN_ORIENTATION);
a.dispatcher=this;a.eventData={screenOrientation:this._screenOrientation};EBG.eventMgr.dispatchEvent(a)}},registerSpecialBrowserEvents:function(){if(this.browser.isIE())this._addEventListener(this.getPageWin(),"focus",this._updateFocused),10>this.browser.getVersion()&&(this._addEventListener(this.getPageWin().document,"focusout",this._updateFocusOut),this._addEventListener(this.getPageWin().document,"focusin",this._updateFocused)),this.focused=this.focused||"undefined"!=typeof gEBMainWindow&&"undefined"!=
typeof gEBMainWindow.EBP&&gEBMainWindow.EBP.focused;EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_RESIZE,this._pageResizeHandler,this));this._updateInitialOrientationValues()},_updateInitialOrientationValues:function(){this.browser.isMobile()&&this._setScreenOrientation(EBG.adaptor.serving._getTopFriendlyIframe(EBG.adaptor.getDisplayWin()))},_updateFocusOut:function(){EBG.runTimed(EBG.adaptor,function(){if(!(EBG.adaptor.getPageWin().screenTop>-2*EBG.adaptor.getPageWin().screen.availHeight)){var a=
new EBG.Events.Event(EBG.Events.EventNames.PAGE_HIDDEN);a.dispatcher=EBG.adaptor;EBG.eventMgr.dispatchEvent(a)}},[],50)},_updateFocused:function(){EBG.adaptor.focused=!0;var a=new EBG.Events.Event(EBG.Events.EventNames.PAGE_VISIBLE);a.dispatcher=EBG.adaptor;EBG.eventMgr.dispatchEvent(a);try{EBG.adaptor._removeEventListener(EBG.adaptor.getPageWin(),"focus",EBG.adaptor._updateFocused),10>EBG.adaptor.browser.getVersion()&&EBG.adaptor._removeEventListener(EBG.adaptor.getPageWin().document,"focusin",EBG.adaptor._updateFocused)}catch(c){}},
_setEvents:function(){EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"_setEvents",[]);this._setEvent(EBG.Events.EventNames.PAGE_SCROLL,"scroll");this._setEvent(EBG.Events.EventNames.PAGE_FOCUS,"focus");this._setEvent(EBG.Events.EventNames.PAGE_BLUR,"blur");var a=this._getVisibilityEventName();"undefined"===typeof document.addEventListener||"undefined"===typeof a||(this._setEvent(EBG.Events.EventNames.PAGE_HIDDEN,a,!0),this._setEvent(EBG.Events.EventNames.PAGE_VISIBLE,a,!0))},initServingMode:function(a,
c,d){c=c?c:!1;switch(a){case EBG.Adaptors.ServingMode.INNER_IFRAME:this.serving.setServingMode(EBG.Adaptors.ServingMode.INNER_IFRAME);break;case -1:this.serving.detectServingMode(!1);break;case 0:!EBG.isPreview&&d==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME&&!c?this.serving.setServingMode(EBG.Adaptors.ServingMode.FRIENDLY_IFRAME):!EBG.isPreview&&d==EBG.Adaptors.ServingMode.IFRAME&&!c?this.serving.setServingMode(EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME):c&&this.serving.setServingMode(EBG.Adaptors.ServingMode.SCRIPT);
break;case 1:case 2:this.serving.setServingMode(EBG.Adaptors.ServingMode.IFRAME)}},addPlaceHolder:function(a){this.inInnerIframe()&&(this.inject(a,EBG.Adaptors.InjectionMethod.INSERT_BEFORE,this.serving.placementIframe),this.serving.hidePlacementIframe())},getPageWin:function(){return this.serving&&this.serving.pageWin?this.serving.pageWin:window},getDisplayWin:function(){return this.serving&&this.serving.displayWin?this.serving.displayWin:window},_getDocument:function(){return this.getDisplayWin().document},
isCookiesSupported:function(){var a=navigator.cookieEnabled?!0:!1;if("undefined"==typeof navigator.cookieEnabled)if(document.cookie="ebTestcookie",-1!=document.cookie.indexOf("ebTestcookie")){var a=!0,c=new Date;c.setTime(c.getTime()-1E3);document.cookie="ebTestcookie; expires="+c.toGMTString()}else a=!1;return a},inInnerIframe:function(){return this.serving&&this.serving.placementIframe},inPlacementIframe:function(){return this.serving&&this.serving.servingMode===EBG.Adaptors.ServingMode.IFRAME},
setElemStyle:function(a,c,d){a.style[c]=d},setElemAttribute:function(a,c,d){a[c]=d},getClipTag:function(a,c,d,e){return EBG.format("rect({0}px {1}px {2}px {3}px)",a,c,d,e)},clip:function(a,c,d,e,f){a.style.clip=this.getClipTag(c,d,e,f)},unclip:function(a){a.style.clip="rect(auto auto auto auto)"},expand:function(a,c){this.setElemStyle(a,"left",EBG.px(-c.x));this.setElemStyle(a,"top",EBG.px(-c.y));this.setElemStyle(a,"width",EBG.px(c.width));this.setElemStyle(a,"height",EBG.px(c.height));this.unclip(a)},
collapse:function(a,c,d){c=this.getClipParams(c,d);this.clip(a,c.top,c.right,c.bottom,c.left)},resize:function(a,c,d){this.setElemStyle(a,"width",EBG.px(c));this.setElemStyle(a,"height",EBG.px(d))},getClipParams:function(a,c){return{top:a.y,right:a.x+c.width,bottom:a.y+c.height,left:a.x}},getCurrentStyleAttr:function(a,c){var d=null;try{d=a.currentStyle?a.currentStyle[c]:a.ownerDocument.defaultView.getComputedStyle(a,null).getPropertyValue(c)}catch(e){}if(!d&&"embed"==a.tagName.toLowerCase()&&a.parentNode&&
"object"==a.parentNode.tagName.toLowerCase())a=a.parentNode,d=a.currentStyle?a.currentStyle[c]:a.ownerDocument.defaultView.getComputedStyle(a,null).getPropertyValue(c);return d},getViewPortMetrics:function(){return this.getWindowViewPortMetrics()},getWindowViewPortMetrics:function(a){try{var a=a?a:this.getDisplayWin(),c=a.document,d={Height:0,Width:0},e=c.documentMode;if(this.browser.isIE()&&(5==e||!this.browser.isStrictType(c)))d.Width=c.body.clientWidth,d.Height=c.body.clientHeight;else if(this.browser.isIE())d.Width=
c.documentElement.clientWidth,d.Height=c.documentElement.clientHeight;else if(d.Width=a.innerWidth,d.Height=a.innerHeight,"hidden"!=c.body.style.overflow){if(c.body.offsetWidth>d.Width||c.body.scrollWidth>d.Width||0<a.scrollMaxX)d.Height-=this.scrollBarWidth;if(c.body.offsetHeight>d.Height||c.body.scrollHeight>d.Height||0<a.scrollMaxY)d.Width-=this.scrollBarWidth}}catch(f){}return d},getPageMetrics:function(a){try{var c=a?a.document:this.getDisplayWin().document,a={Height:0,Width:0};a.Height=Math.max(c.body.scrollHeight,
c.documentElement.scrollHeight,c.body.offsetHeight,c.documentElement.offsetHeight,c.body.clientHeight,c.documentElement.clientHeight);a.Width=Math.max(c.body.scrollWidth,c.documentElement.scrollWidth,c.body.offsetWidth,c.documentElement.offsetWidth,c.body.clientWidth,c.documentElement.clientWidth);return a}catch(d){}},saveInitialScrollBarState:function(a){a.EBG=a.EBG||{};var c=a.document;a.EBG._scrollBarsInitialState=null!=a.EBG._scrollBarsInitialState?a.EBG._scrollBarsInitialState:c.body.style.overflow},
showScrollBars:function(a){a=a?a:this.getDisplayWin();this.saveInitialScrollBarState(a);a.document.body.style.overflow="auto"},hideScrollBars:function(a){a=a?a:this.getDisplayWin();this.saveInitialScrollBarState(a);a.document.body.style.overflow="hidden"},restoreScrollBarsState:function(a){var a=a?a:this.getDisplayWin(),c=a.document;if(null!=a.EBG._scrollBarsInitialState)c.body.style.overflow=a.EBG._scrollBarsInitialState},_getCurrentWindow:function(a,c){try{return this.serving.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME?
a=!0:c==EBG.Adaptors.ServingMode.IFRAME&&this.browser.isFF()&&(a=!0),a?this.getDisplayWin():top}catch(d){}},getPositioningById:function(a,c,d,e){c=this.serving.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME?!0:c;return this.getPositioningByElement(this.getElementById(a),c,d,e)},getIframePosition:function(){var a={X:0,Y:0};if(EBG.adaptor.serving.detectServingMode(!0)==EBG.Adaptors.ServingMode.IFRAME&&"undefined"!=typeof this.getDisplayWin().mozInnerScreenX)a.X=this.getDisplayWin().mozInnerScreenX,
a.Y=this.getDisplayWin().mozInnerScreenY;return a},getPositioningByElement:function(a,c,d,e){if(!a)return null;var c=this.serving.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME||EBG.isPreview?!0:c,f=a.getBoundingClientRect?a.getBoundingClientRect():null;if(!f)return null;a=Math.round(f.left);f=Math.round(f.top);if(!EBG.isDefined(e)||!e)c=this.getScrollLeftTop(c,d),a+=c.X,f+=c.Y;return{X:a,Y:f}},getScrollLeftTop:function(a,c){a=c==EBG.Adaptors.ServingMode.IFRAME?!0:a;return EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,
this,"getScrollLeftTop",[a,c])},getBodyPositioning:function(a){var c=this.getDisplayWin(),d=this.isCurrWin();(a=EBG.adaptor.getPositioningByElement(c.document.body,!d,a))||(a={X:0,Y:0});return a},isCurrWin:function(){return this.getDisplayWin()===this.getPageWin()},_calculatePositioning:function(){return null},getScrollerWidth:function(){try{if(EBG.adaptor.browser._platform==EBG.adaptor.browser._platformTypes.IPAD||EBG.adaptor.browser._platform==EBG.adaptor.browser._platformTypes.IPHONE)return 0;
var a=null,c=null,d=0,e=0,f=0,a=document.createElement("div");a.style.position="absolute";a.style.top="-1000px";a.style.left="-1000px";a.style.width="100px";a.style.height="50px";a.style.overflow="auto";c=document.createElement("div");c.style.width="100%";c.style.height="200px";a.appendChild(c);document.body.appendChild(a);e=c.offsetWidth;document.body.removeChild(document.body.lastChild);a.style.overflow="hidden";document.body.appendChild(a);d=c.offsetWidth;document.body.removeChild(document.body.lastChild);
return d-e?d-e:0}catch(g){}},getResolution:function(){var a=0;switch(window.screen.width){case 640:a=1;break;case 800:a=2;break;case 1024:a=4;break;case 1152:a=8;break;case 1280:a=16;break;case 1600:a=32;break;case 1400:a=64;break;case 1920:a=128;break;case 1680:a=256;break;case 1366:a=512;break;case 1440:a=1024;break;case 1360:a=2048;break;case 768:a=4096;break;case 1093:a=8192;break;case 960:a=16384;break;case 2560:a=32768}return a},_handleEvent:function(a){var c=this._logicalEvents[a.type].name;
switch(c){case EBG.Events.EventNames.PAGE_HIDDEN:case EBG.Events.EventNames.PAGE_VISIBLE:c=this.isPageVisible()?EBG.Events.EventNames.PAGE_VISIBLE:EBG.Events.EventNames.PAGE_HIDDEN;break;default:EBG.callSuperFunction(EBG.Adaptors.WebAdaptor,this,"_handleEvent",[a]);return}c&&(c=new EBG.Events.Event(c),EBGInfra.isDefinedNotNull(this._logicalEvents[a.type].attr)&&this._prepareLogicalEventData(c,this._logicalEvents[a.type].eventData,this._logicalEvents[a.type].attr),EBG.isFunc(this._listener)&&this._listener.call(this._listenerBinding,
c))},_isOrientationChange:function(){var a=EBG.adaptor.serving._getTopFriendlyIframe(EBG.adaptor.getDisplayWin());return a.innerWidth!==this._previousWidth||a.innerHeight!=this._previousHeight?this._screenOrientation!==(a.innerHeight>=a.innerWidth?EBG.Events.EventNames.PORTRAIT:EBG.Events.EventNames.LANDSCAPE):!1},_setScreenOrientation:function(a){a=a?a:EBG.adaptor.serving._getTopFriendlyIframe(EBG.adaptor.getDisplayWin());this._screenOrientation=a.innerHeight>=a.innerWidth?EBG.Events.EventNames.PORTRAIT:
EBG.Events.EventNames.LANDSCAPE;this._previousWidth=a.innerWidth;this._previousHeight=a.innerHeight},getScreenOrientation:function(a){("boolean"==typeof a?a:1)&&this._setScreenOrientation();return this._screenOrientation},_sendReady:function(){this._isReady=!0;var a=new EBG.Events.Event(EBG.EBMessage.ADAPTOR_READY);a.dispatcher=this;a.timing=EBG.Events.EventTiming.BEFORE;if(!EBG.eventMgr.dispatchEvent(a))a.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(a)},getMouseCoordinates:function(a){var c=
{mouseX:0,mouseY:0};if(a)EBG.adaptor.browser.isIE()?(c.mouseX=a.clientX?a.clientX:0,c.mouseY=a.clientY?a.clientY:0):(c.mouseX=a.pageX?a.pageX:0,c.mouseY=a.pageY?a.pageY:0),c.view=a.view;return c},_getVisibilityEventName:function(){var a=null;"undefined"!==typeof document.hidden?a="visibilitychange":"undefined"!==typeof document.mozHidden?a="mozvisibilitychange":"undefined"!==typeof document.msHidden?a="msvisibilitychange":"undefined"!==typeof document.webkitHidden&&(a="webkitvisibilitychange");return a},
getElementWindow:function(a){if(!a)return null;a=a.ownerDocument;return a.defaultView||a.parentWindow||window}};EBG.declareClass(EBG.Adaptors.WebAdaptor,EBG.Adaptors.StdWebAdaptor);EBG.Adaptors.Browser=function(a,c,d,e,f){this.set(a,c,d,e,f)};
EBG.Adaptors.Browser.prototype={_platform:0,_browserType:0,_browserVer:0,_browserCode:0,_deviceType:0,_browserTypes:EBG.API.BrowserTypes,_platformTypes:EBG.API.PlatformTypes,_deviceTypes:EBG.API.DeviceTypes,set:function(a,c,d,e,f){a=a?a:this._platformTypes.NON_SUPPORTED;c=c?c:this._browserTypes.NON_SUPPORTED;f=f?f:this._browserTypes.NON_SUPPORTED;this._platform=a;this._browserType=c;this._browserVer=d?d:0;this._browserCode=f;this._deviceType=e?e:0},getVersion:function(){return this._browserVer},getDocumentMode:function(){return window.document.documentMode},
isIE:function(){return this._browserType==this._browserTypes.IE||this._browserType==this._browserTypes.AOL},isEdge:function(){return this._browserType==this._browserTypes.EDGE},isStrictType:function(a){var c=!1;this.isIE()&&(c=a?"CSS1Compat"==a.compatMode:"CSS1Compat"==document.compatMode);return c},isFF:function(){return this._browserType==this._browserTypes.FF},isSafari:function(){return this._browserType==this._browserTypes.SAFARI},isChrome:function(){return this._browserType==this._browserTypes.CHROME},
isOpera:function(){return this._browserType==this._browserTypes.OPERA},isMac:function(){return this._platform==this._platformTypes.MAC||this._platform==this._platformTypes.MAC_NEW||this._platform==this._platformTypes.MAC_YOSEMITE},isMobile:function(){var a=!1;if(this._deviceType==this._deviceTypes.MOBILE||this._deviceType==this._deviceTypes.TABLET)a=!0;return a},isiOS:function(){for(var a in this._platformTypes)if(this._platformTypes[a]==this._platform&&a.match(/mac|iphone|ipad|ipod/i))return!0;return!1},
isAndroid:function(){for(var a in this._platformTypes)if(this._platformTypes[a]==this._platform&&0<=a.indexOf("ANDROID"))return!0;return!1},isAndroidNative:function(){return this.isAndroid()&&this.isSafari()},isThirdPartyAllowed:function(){return!this.isSafari()||this.isMobile()},getEnvironment:function(){if(EBG.adaptor.browser.isMobile()){if(EBG.adaptor.browser.isiOS()){var a=window.navigator&&window.navigator.standalone;return!(navigator.userAgent||navigator.vendor||window.opera).match(/safari/i)&&
!a?EBG.WebEnvironment.IOS_WEB_VIEW:EBG.WebEnvironment.IOS_MOBILE_BROWSER}return EBG.adaptor.browser.isAndroid()?EBG.adaptor.browser.isChrome()||EBG.adaptor.browser.isFF()?EBG.WebEnvironment.ANDROID_MOBILE_BROWESR:EBG.WebEnvironment.ANDROID_UNKNOWN:EBG.adaptor.browser.isIE()?EBG.WebEnvironment.OTHER_MOBILE_BROWSER:EBG.WebEnvironment.UNKNOWN}return EBG.WebEnvironment.BROWSER}};EBG.Adaptors.ServingMode={SCRIPT:"SCRIPT",IFRAME:"IFRAME",FRIENDLY_IFRAME:"FRIENDLY_IFRAME",INNER_IFRAME:"INNER_IFRAME",TOPMOST_FRIENDLY_IFRAME:"TOPMOST_FRIENDLY_IFRAME"};
EBG.Adaptors.IframeMode={SERVE:"SERVE",VERIFY:"VERIFY",SERVEANDVERIFY:"SERVEANDVERIFY"};EBG.Adaptors.ServingMgr=function(){this.displayWin=window;this.servingMode=EBG.Adaptors.ServingMode.SCRIPT;this._supportPostMessage=!!window.postMessage};
EBG.Adaptors.ServingMgr.prototype={noInDapIFFlag:null,displayWin:null,pageWin:null,placementIframe:null,_placementIframeAttr:null,servingMode:null,ebO:null,addinEyeRef:null,aieServerRequestPrefix:"/BurstingPipe/adServer.bs?cn=chdm&referrer=",aieServerRequestPrefixVersion:"&cv=2",setDisplayWin:function(a){this.displayWin=a},setPageWin:function(){var a=this.detectServingMode(!0);switch(this.servingMode){case EBG.Adaptors.ServingMode.SCRIPT:switch(a){case EBG.Adaptors.ServingMode.SCRIPT:this.pageWin=
window;break;case EBG.Adaptors.ServingMode.FRIENDLY_IFRAME:this.pageWin=top;break;case EBG.Adaptors.ServingMode.IFRAME:case EBG.Adaptors.ServingMode.INNER_IFRAME:this.pageWin=this.displayWin}break;case EBG.Adaptors.ServingMode.FRIENDLY_IFRAME:this.pageWin=top;break;case EBG.Adaptors.ServingMode.IFRAME:case EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME:case EBG.Adaptors.ServingMode.INNER_IFRAME:this.pageWin=this.displayWin}},setServingMode:function(a){this.servingMode=a;var c=null;switch(a){case EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME:c=
this._getTopFriendlyIframe();break;case EBG.Adaptors.ServingMode.INNER_IFRAME:c=top;break;case EBG.Adaptors.ServingMode.FRIENDLY_IFRAME:c=top;break;case EBG.Adaptors.ServingMode.SCRIPT:this.setDisplayWin(window);this.setPageWin();return}EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_UNLOAD,this._restorePlacementIframe,this));c&&(EBG.isGlobalDef("gstrEbDisplayPos")&&(c=eval("parent."+gstrEbDisplayPos)),this.setDisplayWin(c),this.setPageWin(),c!==window&&this._findPlacementIframe())},
isFIF:function(a){if(this.noInDapIFFlag)return!1;var c="inFIF"in a?a.inFIF:!1;return("inDapIF"in a?a.inDapIF:!1)||c},detectServingMode:function(a){try{for(var c=EBG.Adaptors.ServingMode.SCRIPT,d=window;d.self!==d.parent;){var e=null;try{e=EBG.adaptor.getHostName(d.parent)}catch(f){}if(EBGInfra.isDefinedNotNull(e)&&EBG.adaptor.getHostName(d)===e||this.isFIF(d))c=EBG.Adaptors.ServingMode.FRIENDLY_IFRAME,d=d.parent;else{c=EBG.Adaptors.ServingMode.IFRAME;break}}if(a)return c;this.setServingMode(c)}catch(g){}},
detectServingEnvironment:function(a){a=EBG.isDefinedNotNull(a)?a:this.detectServingMode(!0);if(this.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME||this.servingMode==EBG.Adaptors.ServingMode.IFRAME&&EBG.isDefinedNotNull(this.addinEyeRef))a=EBG.Adaptors.ServingMode.INNER_IFRAME;var c=this._getTopFriendlyIframe(window);if(window!=c&&c!=top)a=EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME;return a},_getTopFriendlyIframe:function(a){a=a?a:window;if(EBG.adaptor.isSafeFrame())return a;for(;a.self!==
a.parent;){var c=null;try{c=EBG.adaptor.getHostName(a.parent)}catch(d){}if(EBGInfra.isDefinedNotNull(c)&&EBG.adaptor.getHostName(a)===c||this.isFIF(a))a=a.parent;else break}return a},_restorePlacementIframe:function(){this._placementIframeAttr&&(EBGInfra.mergeObj(this._placementIframeAttr,this.placementIframe,!0),EBGInfra.mergeObj(this._placementIframeAttr.style,this.placementIframe.style,!0))},hidePlacementIframe:function(){var a=this.placementIframe;if(!this._placementIframeAttr)this._placementIframeAttr=
{width:a.width,height:a.height},this._placementIframeAttr.style={width:EBG.adaptor.getCurrentStyleAttr(a,"width"),height:EBG.adaptor.getCurrentStyleAttr(a,"height"),visibility:EBG.adaptor.getCurrentStyleAttr(a,"visibility"),border:EBG.adaptor.getCurrentStyleAttr(a,"border")};a.style.visibility="hidden";a.width=a.height=0;a.style.width=a.style.height=a.style.border="0px"},rehidePlacementIframe:function(){this._placementIframeAttr&&this.hidePlacementIframe()},handleAieServing:function(a){this.ebO=EBG.cloneObj(a);
if(EBG.adaptor.browser.isIE()&&9>EBG.adaptor.browser.getVersion())try{delete this.ebO.ut,delete this.ebO.fru}catch(c){this.ebO.ut="",this.ebO.fru=""}if(EBG.iframeLocation)this._handleAddInEyeServerResponse('{"iflExists":1,"iflCheck":0}');else if(a.aiE&&EBG.isDefined(a.aiE.iflExists))this._handleAddInEyeServerResponse(JSON.stringify(a.aiE));else{var d=encodeURIComponent(document.referrer||document.location.href);d?EBG.adaptor.getDataFromRemoteServer(ebPtcl+a.bs+this.aieServerRequestPrefix+d+this.aieServerRequestPrefixVersion,
this._handleAddInEyeServerResponse,this,!0,!1)||this._handleAddInEyeServerResponse('{"iflExists":1,"iflCheck":0}'):this._handleAddInEyeServerResponse(null)}},_handleAddInEyeServerResponse:function(a,c){var d;try{d=!c&&a?JSON.parse(a):{iflExists:0,iflCheck:1}}catch(e){d={iflExists:0,iflCheck:1}}this.ebO.aiE=d;if(!this.ebO.dmn)this.ebO.dmn=d.Domain?d.Domain:this._ebGetHostName(document.referrer);if(d&&d.iflExists)this.insertInnerIframe(this.ebO.phid,d.iflCheck?EBG.Adaptors.IframeMode.SERVEANDVERIFY:
EBG.Adaptors.IframeMode.SERVE);else{this.ebO.ifrm=0;this.ebO.adConfig.showAieDefaultImage=1;var f=new EBG.Events.Event(EBG.Events.EventNames.AIE_LOADED);f.eventData={loadDefault:this.ebO.adConfig.showAieDefaultImage,currentResponse:this.ebO};f.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(f);d.iflCheck&&this.insertInnerIframe(this.ebO.phid,EBG.Adaptors.IframeMode.VERIFY)}},insertInnerIframe:function(a,c){this._supportPostMessage?(this._initPmMessages(c),this.listenToMessages()):
this._startHashProtocol(c);var d={tagName:EBG.Adaptors.TagNames.IFRAME,attributes:{id:"addineyeIframe",src:this._getAddineyeLocation(),style:{display:ebO.ffs.CFF_addineyeDispNone?"none":"block"},width:"0",height:"0"}};EBG.adaptor.addInlineDOM(d,a);this.addinEyeRef=EBG.adaptor.getElementById("addineyeIframe");this._supportPostMessage||this._sendMessageHashProtocol()},_getAddineyeLocation:function(){var a="eyeblaster/addineyeV2"+("https://"==EBG.protocol?"-secure":"")+".html";this._getTopFriendlyIframe();
if(EBG.iframeLocation)a=EBG.iframeLocation;if("http"!=a.substr(0,4)){var c=this.ebO.dmn;if(!c)return"";a=EBG.protocol+c+"/"+a}return a},_buildSecretTagsObj:function(){return{gstrEbPreLoadScripts:EBG.isGlobalDef("gstrEbPreLoadScripts")?gstrEbPreLoadScripts:void 0,gnEbLowBWLimit:EBG.isGlobalDef("gnEbLowBWLimit")?gnEbLowBWLimit:void 0,gstrEbPreLoadScripts:EBG.isGlobalDef("gstrEbPreLoadScripts")?gstrEbPreLoadScripts:void 0,gfEbInlineBanner:EBG.isGlobalDef("gfEbInlineBanner")?gfEbInlineBanner:void 0,gEbEyeDivRefElement:EBG.isGlobalDef("gEbEyeDivRefElement")?
gEbEyeDivRefElement:void 0,gstrEbDisplayPos:EBG.isGlobalDef("gstrEbDisplayPos")?gstrEbDisplayPos:void 0,gnEbMinZIndex:EBG.isGlobalDef("gnEbMinZIndex")?gnEbMinZIndex:void 0,gfEbForceStreaming:EBG.isGlobalDef("gfEbForceStreaming")?gfEbForceStreaming:void 0,gfEbUseIntFlash:EBG.isGlobalDef("gfEbUseIntFlash")?gfEbUseIntFlash:void 0,gEbfLoadAsAS2:EBG.isGlobalDef("gEbfLoadAsAS2")?gEbfLoadAsAS2:void 0,gEbURLTokens:EBG.isGlobalDef("gEbURLTokens")?gEbURLTokens:void 0}},_startHashProtocol:function(a){this._hashMessages=
[];if(a==EBG.Adaptors.IframeMode.VERIFY||a==EBG.Adaptors.IframeMode.SERVEANDVERIFY)this._hashMessages.push(this._buildHashMessages({ebProtocol:ebPtcl,ebBs:EBG.bs,addineyeDomain:this.ebO.dmn},EBG.INNERIFRAMEMessage.VERIFY,a==EBG.Adaptors.IframeMode.VERIFY?EBG.INNERIFRAMEMessage.LASTMSG:EBG.INNERIFRAMEMessage.NOT_LASTMSG));if(a==EBG.Adaptors.IframeMode.SERVE||a==EBG.Adaptors.IframeMode.SERVEANDVERIFY){var a={ebPtcl:ebPtcl,ebBigS:ebBigS,ebResourcePath:this.ebO&&this.ebO.adConfig&&this.ebO.adConfig.resourcePath?
this.ebO.adConfig.resourcePath:ebResourcePath,ebRand:ebRand,ebPli:ebPli,ebAdID:ebAdID},c={ptcl:ebPtcl,bs:EBG.bs,adId:ebO.adConfig.adId},d=this._buildSecretTagsObj();this.ebO.adConfig=this.ebO.tn!=EBG.adTypes.VisibilityAd?null:{tn:ebO.adConfig.tn,rnd:ebO.adConfig.rnd,adId:ebO.adConfig.adId,uid:ebO.adConfig.adId+"_"+ebO.adConfig.rnd};this._hashMessages.push(this._buildHashMessages(c,EBG.INNERIFRAMEMessage.ADCONFIG_REQUEST));this._hashMessages.push(this._buildHashMessages(this.ebO,EBG.INNERIFRAMEMessage.EBO));
this._hashMessages.push(this._buildHashMessages(a,EBG.INNERIFRAMEMessage.GLOBALPARAMS,EBG.INNERIFRAMEMessage.NOT_LASTMSG));this._hashMessages.push(this._buildHashMessages(d,EBG.INNERIFRAMEMessage.SECRET_TAGS,EBG.INNERIFRAMEMessage.LASTMSG))}EBG.msgProtocol.postMessage("",window.location.href,window);EBG.msgProtocol.receiveMessages(this._handleMessagesHashProtocol,10)},_buildHashMessages:function(a,c,d){a.typeObj=c;a.lastMsg=d?d:EBG.INNERIFRAMEMessage.NOT_LASTMSG;a.parentURL=document.location.href;
return escape(JSON.stringify(a))},_sendMessageHashProtocol:function(){EBG.msgProtocol.postMessage(EBG.adaptor.serving._hashMessages[0],EBG.adaptor.serving.addinEyeRef.src,EBG.adaptor.serving.addinEyeRef);EBG.adaptor.serving._hashMessages.splice(0,1);0==EBG.adaptor.serving._hashMessages.length&&EBG.msgProtocol.finishMessaging()},listenToMessages:function(){EBG.pm.bind(EBG.INNERIFRAMEMessage.LOADED,this._handlePostMessage,this)},_ebGetHostName:function(a){var c="",a=a.toLowerCase(),c=7<=a.length&&"http://"==
a.substr(0,7)?a.substr(7):8<=a.length&&"https://"==a.substr(0,8)?a.substr(8):a,a=c.indexOf("/");0<a&&(c=c.substr(0,a));return c},_findPlacementIframe:function(){try{var a=this.displayWin,c=window,d=null,e=-1;do{var e=-1,d=null,f=c.parent.frames;if(!EBG.isDefined(f.length))for(var g=c.parent.document.getElementsByTagName(EBG.Adaptors.TagNames.IFRAME),f=[],h=0;h<g.length;h++)f.push(g[h].contentWindow);for(h=0;h<f.length;h++)try{if(f[h]==c){e=h;d=c;break}}catch(i){}c=c.parent}while(c!=a);if(!(0<=e))throw new exception("ServingMgr._findPlacementIframe",
"Could not find placement iframe!");c=null;try{if("undefined"!=typeof d.frameElement)c=d.frameElement}catch(j){}if(!c){for(var k=a.document.getElementsByTagName(EBG.Adaptors.TagNames.IFRAME),h=0;h<k.length;h++)k[h].contentWindow==d&&(e=h);if(e>=k.length)throw new exception("ServingMgr._findPlacementIframe",EBG.format("frames List is too short ({0}). Needed frame is {1}",k.length,e));c=k[e]}this.placementIframe=c}catch(l){}},_handleMessagesHashProtocol:function(a){switch(a.data){case EBG.INNERIFRAMEMessage.CONTINUE_SENDING:EBG.adaptor.serving._sendMessageHashProtocol()}},
_handlePostMessage:function(a){a&&a==EBG.INNERIFRAMEMessage.LOADED&&EBG.adaptor.serving._sendInitToInnerIframe()},_sendInitToInnerIframe:function(){for(var a=0;a<EBG.adaptor.serving._pmMessages.length;a++)EBG.pm({target:this.addinEyeRef.contentWindow,type:EBG.adaptor.serving._pmMessages[a].msgType,data:EBG.adaptor.serving._pmMessages[a].data});EBG.adaptor.serving._pmMessages={}},_initPmMessages:function(a){this._pmMessages=[];(a==EBG.Adaptors.IframeMode.VERIFY||a==EBG.Adaptors.IframeMode.SERVEANDVERIFY)&&
this._pmMessages.push({msgType:EBG.INNERIFRAMEMessage.VERIFY,data:{ebProtocol:ebPtcl,ebBs:EBG.bs,addineyeDomain:this.ebO.dmn}});if((a==EBG.Adaptors.IframeMode.SERVE||a==EBG.Adaptors.IframeMode.SERVEANDVERIFY)&&EBG.adaptor.serving.ebO)a={ebO:EBG.adaptor.serving.ebO,ebPtcl:ebPtcl,ebBigS:ebBigS,ebResourcePath:this.ebO&&this.ebO.adConfig&&this.ebO.adConfig.resourcePath?this.ebO.adConfig.resourcePath:ebResourcePath,ebRand:ebRand,secretTagData:this._buildSecretTagsObj(),ebPli:ebPli,ebAdID:ebAdID},this._pmMessages.push({msgType:EBG.INNERIFRAMEMessage.INIT,
data:a})}};EBG.Adaptors.FlashDetector=function(){this._init()};
EBG.Adaptors.FlashDetector.prototype={version:0,checkingBlock:!1,checkedBlock:!1,isBlocked:null,_flashPlayerVersion:null,_detectionPixelTimeout:null,_throttleTimeout:null,_detectionPixelTimeoutDuration:2E3,_init:function(){var a=-1;try{a=(new ActiveXObject("Shockwaveflash.Shockwaveflash.7")).GetVariable("$version"),a=this._splitFlashMajorMinorVersions(a),a=Number(a)}catch(c){}if(-1==a)try{var d=0,e=0,f=0;if(null!=navigator.plugins&&0<navigator.plugins.length){var g=navigator.mimeTypes;if(g&&g["application/x-shockwave-flash"]&&
g["application/x-shockwave-flash"].enabledPlugin&&g["application/x-shockwave-flash"].enabledPlugin.description){var h=g["application/x-shockwave-flash"].enabledPlugin.description.split(" "),i=h[2].split("."),d=i[0],e=i[1],f=h[3];""==f&&(f=h[4]);isNaN(f[0])&&(f=f.substring(1));0<f.indexOf("d")&&(f=f.substring(0,f.indexOf("d")))}a=Number(d+"."+e+f)}}catch(j){}if(!isNaN(a))this.version=a},_splitFlashMajorMinorVersions:function(a){if(a)return a=a.split(" ")[1].split(","),EBG.format("{0}.{1}{2}",a[0],
a[1],a[2])},_handlePixelMessage:function(a){clearTimeout(this._detectionPixelTimeout);this._detectionPixelTimeout=null;this.flashPlayerVersion=a;this.isBlocked=!1;EBG.runTimed(this,this._dispatchFlashDetected,[],10)},_handleDetectionPixelTimeout:function(a){var c=EBG.adaptor.browser.isFF()||EBG.adaptor.isPageVisible(),d=EBG.adaptor.hasHiddenParent(EBG.adaptor.getElementById("ebFlashDetection"));if(c&&a&&!d){this.checkedBlock=!0;this.checkingBlock=!1;a=EBG.adaptor.getDisplayWin();if(a.EBG&&a.EBG!=
EBG&&a.EBG.adaptor.flash&&EBG.isDefinedNotNull(a.EBG.adaptor.flash.flashPlayerVersion))this.flashPlayerVersion=a.EBG.adaptor.flash.flashPlayerVersion;this.isBlocked=!this.flashPlayerVersion;this._dispatchFlashDetected();clearTimeout(this._detectionPixelTimeout);this._detectionPixelTimeout=null}else clearTimeout(this._detectionPixelTimeout),this._detectionPixelTimeout=EBG.runTimed(this,this._handleDetectionPixelTimeout,[c],this._detectionPixelTimeoutDuration)},_dispatchFlashDetected:function(){this.checkedBlock=
!0;this.checkingBlock=!1;var a=new EBG.Events.Event(EBG.Events.EventNames.FLASH_DETECTED);a.dispatcher=this;a.eventData={isBlocked:this.isBlocked,versionStr:this.flashPlayerVersion,versionInt:this.version};EBG.eventMgr.dispatchEvent(a);EBG.adaptor.removeElement("ebFlashDetectionDiv")},_buildRenderPixelJson:function(){var a={play:"true",resId:"ebFlashDetection",resPath:ebBigS+"/Res/Assets/Pixel"+EBG.flashPixelVer+"/pixel.swf",unique:0,wmode:"opaque",tagName:EBG.Adaptors.TagNames.OBJECT,attributes:{id:"ebFlashDetection",
dir:"ltr",name:"ebFlashDetection",style:{position:"absolute",textAlign:"left",width:"1px",height:"1px"},codebase:EBG.format("{0}download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#",EBG.protocol),version:"9,0,0,0"},params:{play:"true",wmode:"opaque",menu:"false",flashVars:"id=ebFlashDetection",allowScriptAccess:"always",allowFullScreen:"true"}};this.isSupportShockwave()?(a.attributes.type="application/x-shockwave-flash",a.attributes.data=a.resPath):(a.attributes.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",
a.params.movie=a.resPath);return a},_createScriptTag:function(){var a=EBG.format("function {0}(args)","DoFS_FlashDetectionPixel"),a=a+EBG.format("{ try{ if(!args||args=='null')args=''; return {0}(args);}catch(e){if(window.mmFSExceptionAlert)mmFSExceptionAlert('Command: '+command+'\\nargs: '+args.toString()+'\\n\\nexception in DoFS func:\\n'+e.message)}}","EBG.adaptor.flash._handlePixelMessage");return{tagName:EBG.Adaptors.TagNames.SCRIPT,text:a}},_handleThrottleEvent:function(a){a&&a.state&&(a.state==
EBG.ThrottleStates.THROTTLE||a.state==EBG.ThrottleStates.PAUSE?this._setThrottleState(a):a.state==EBG.ThrottleStates.RESUME?(clearTimeout(this._throttleTimeout),this._setThrottleState(a)):a.state==EBG.ThrottleStates.LOAD&&a.elemId&&a.id&&this._verifyThrottleDetectLocation(a))},_verifyThrottleDetectLocation:function(a){if(a.elemId&&a.id){var c=EBG.adaptor.getBoundingClientRect(EBG.adaptor.getElementById(a.elemId)),d=EBG.adaptor.getElementById(a.id),e=EBG.adaptor.getBoundingClientRect(d);if(c&&e&&EBG.isNumber(c.width)&&
EBG.isNumber(e.width))if(0==c.width||0==c.height||0==e.width||0==e.height)EBG.runTimed(this,this._verifyThrottleDetectLocation,[a],30);else if(EBG.serializeObject(c)!=EBG.serializeObject(e)){var a=parseInt(d.style.marginTop,10),f=parseInt(d.style.marginLeft,10);d.style.marginTop=EBG.px(a-(e.top-c.top));d.style.marginLeft=EBG.px(f-(e.left-c.left))}}},_setThrottleState:function(a){if(a.adUId){var c=new EBG.Events.Event(EBG.Events.EventNames.THROTTLED),d=a.adUId.split("_")[1];c.dispatcher={_adConfig:{rnd:d,
uid:a.adUId}};c.eventData=a;EBG.eventMgr.dispatchEvent(c)}},removeThrottleDetectionSwf:function(a){EBG.adaptor.removeElement("ebFlashThrottleDetection_"+a)},isSupportShockwave:function(){var a=!0;if(EBG.adaptor.browser.isIE()&&11>EBG.adaptor.browser.getVersion()||10<EBG.adaptor.browser.getVersion()&&9>EBG.adaptor.getDisplayWin().document.documentMode)a=!1;return a},doFlashBlockDetection:function(a){this.checkingBlock=!0;var c={tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:"ebFlashDetectionDiv",
style:{width:"0px",height:"0px"}},children:[this._buildRenderPixelJson(),this._createScriptTag()]};EBG.adaptor.inInnerIframe()?EBG.adaptor.inject(c,EBG.Adaptors.InjectionMethod.INSERT_BEFORE,EBG.adaptor.serving.placementIframe):a&&EBG.adaptor.getElementById(a)&&EBG.adaptor.addInlineDOM(c,a);this._detectionPixelTimeout=EBG.runTimed(this,this._handleDetectionPixelTimeout,[],this._detectionPixelTimeoutDuration)},getFlashVersionForBlockingDetection:function(){var a=0;try{if(!(document.documentMode||navigator.appName&&
"Opera"==navigator.appName)){var c=navigator.mimeTypes;if(c&&c["application/x-shockwave-flash"]&&c["application/x-shockwave-flash"].enabledPlugin&&c["application/x-shockwave-flash"].enabledPlugin.version){var d=c["application/x-shockwave-flash"].enabledPlugin.version,e=d.split(".");if(18>e[0]||18==e[0]&&209>e[3])a=20}else if(c&&c["application/x-shockwave-flash"]&&c["application/x-shockwave-flash"].enabledPlugin&&c["application/x-shockwave-flash"].enabledPlugin.filename&&(d=c["application/x-shockwave-flash"].enabledPlugin.filename,
e=d.split(".")[0].split("_"),18>e[1]||18==e[1]&&209>e[4]))a=21}}catch(f){}return a}};EBG.Adaptors.Wallpaper=function(){this._currentBg=this._getCurrentBackground()};
EBG.Adaptors.Wallpaper.prototype={SetBackgroundImage:function(a){var c=EBG.adaptor.getPageWin().document;if(a.imgSrc){if(!a.color)a.color=this._currentBg.color?this._currentBg.color:"transparent";var d=a.color,d=d+(" url('"+a.imgSrc+"') ");a.tiling="repeat"==a.tiling.toLowerCase()||"repeat-x"==a.tiling.toLowerCase()||"repeat-y"==a.tiling.toLowerCase()||"no-repeat"==a.tiling.toLowerCase()?a.tiling.toLowerCase():this._currentBg.tiling?this._currentBg.tiling:"no-repeat";var d=d+(" "+a.tiling),d=a.scrolling?
d+" scroll":d+" fixed",e="";"center"==a.positionX.toLowerCase()||"right"==a.positionX.toLowerCase()||"left"==a.positionX.toLowerCase()?e=a.positionX.toLowerCase():a.positionX="";"center"==a.positionY.toLowerCase()||"top"==a.positionY.toLowerCase()||"bottom"==a.positionY.toLowerCase()?e+=" "+a.positionY.toLowerCase():a.positionY="";if(!a.positionX||!a.positionY)e=c.body.style.backgroundPosition?c.body.style.backgroundPosition:"center top";c.body.style.background=d+(" "+e)}},RemoveBackgroundImage:function(){this._currentBg.imgSrc?
this.SetBackgroundImage(this._currentBg):EBG.adaptor.getPageWin().document.body.style.background=""},_getCurrentBackground:function(){var a=new EBG.Adaptors.Wallpaper.BgData,c=EBG.adaptor.getPageWin().document.body;if(""!=c.style.backgroundImage)a.imgSrc=c.style.backgroundImage.substr(4,c.style.backgroundImage.length-5);if(""!=c.style.backgroundColor)a.color=c.style.backgroundColor;if(""!=c.style.backgroundRepeat)a.tiling=c.style.backgroundRepeat;if(""!=c.style.backgroundAttachment)a.scrolling="fixed"==
c.style.backgroundAttachment?!1:!0;if(""!=c.style.backgroundPosition)posArr=c.style.backgroundPosition.split(" "),a.positionX=posArr[0],a.positionY=posArr[1];return a}};EBG.Adaptors.Wallpaper.BgData=function(){};EBG.Adaptors.Wallpaper.BgData.prototype={color:"",imgSrc:"",tiling:"",positionX:"",positionY:"",scrolling:!1,contentWidth:null};EBG.declareNamespace("Interactions");
EBG.Interactions.SystemInts={CLICK:"_eyeblaster",AD_DURATION:"ebAdDuration",REPLAY:"ebReplay",CLOSE:"ebClose",CLOSE_REM:"ebRemClose",DEFAULT_CLICK:"ebDefaultClick",USER_INTERACTION:"ebUserInteraction",UNIQUE_VIDEO_STARTED:"ebUniqueVideoStarted",DWELL_TIME:"ebDwellTime",DWELL_UNIQUE:"ebUniqueDwell",RICH_FLASH_PLAYED:"ebRichFlashPlayed",INT_DURATION:"ebIntDuration",VISIBILITY_RECORDABLE:"VsR",VISIBILITY_AGENCY_RECORDABLE:"VsRAg",VISIBILITY_ADVERTISER_RECORDABLE:"VsRAd",VISIBILITY_ADVERTISER:"VsAd",
VISIBILITY_AGENCY:"VsAg",VISIBILITY_IAB:"VsIAB",VISIBILITY_ADVERTISER_DURATION:"VsAdDu",VISIBILITY_AGENCY_DURATION:"VsAgDu",VISIBILITY_AVG_AD_SURFACE:"VsAvSu",VISIBILITY_AVG_SCREEN_SHARE:"VsAvSc",REM_DURATION:"ebRemDuration",INTRO_FULL_PLAY:"ebFullPlay",REM_FULL_PLAY:"ebRemFullPlay",SWIPE:"ebSwipe",AD_START:"AdStart",AD_STACKING:"AdStacking",MULTI_BURN:"MultiBurn",AD_COLLISION:"AdCollision",AD_CAROUSEL:"AdCarousel",AD_PARAMS:"AdParams",PLAYER_PARAMS:"plparams"};
EBG.Interactions.VideoInteractionOrder=[EBG.VideoInteraction.STARTED,EBG.VideoInteraction.PERCENT_25_PLAYED,EBG.VideoInteraction.PERCENT_50_PLAYED,EBG.VideoInteraction.PERCENT_75_PLAYED,EBG.VideoInteraction.FULLPLAY];EBG.Interactions.Categories={SYSTEM:2,VIDEO:1,CUSTOM:0};EBG.Interactions.InitiationTypes={AUTO:"auto",USER:"user"};EBG.Interactions.InteractionTypes={COUNTER:"Counter",TIMER:"Timer"};
EBG.Interactions.checkURL=function(a){var c=a.toLowerCase();-1==c.indexOf("http://")&&-1==c.indexOf("https://")&&-1==c.indexOf("ftp://")&&-1==c.indexOf("aim:")&&-1==c.indexOf("mailto:")&&-1==c.indexOf("fb://")&&(a=0==c.indexOf("/")?"http://"+EBG.adaptor.getHostName()+a:"http://"+a);return a};EBG.Interactions.RemoteServersData=function(){};EBG.Interactions.RemoteServersData.prototype={networkUrl:null,agencyUrl:null};EBG.declareClass(EBG.Interactions.RemoteServersData,null);
EBG.Interactions.InteractionData=function(a,c,d){this.reportingName=a;this.adUId=c;this.category=d};EBG.Interactions.InteractionData.prototype={initiationType:EBG.Interactions.InitiationTypes.AUTO,category:EBG.Interactions.Categories.SYSTEM,isPanel:!1};EBG.declareClass(EBG.Interactions.InteractionData,null);EBG.Interactions.CounterInteractionData=function(a,c,d){EBG.callSuperConstructor(EBG.Interactions.CounterInteractionData,this,[a,d,c]);this.remoteServers=new EBG.Interactions.RemoteServersData};
EBG.Interactions.CounterInteractionData.prototype={reportImmediately:!1,countAsClick:!1,remoteServers:null,clickURL:null,numLeftToReport:10,state:null};EBG.declareClass(EBG.Interactions.CounterInteractionData,EBG.Interactions.InteractionData);EBG.Interactions.TimerInteractionData=function(a,c,d){this.reportingName=a;EBG.callSuperConstructor(EBG.Interactions.TimerInteractionData,this,[a,d,c])};EBG.Interactions.TimerInteractionData.prototype={value:0,startTime:0,idleDuration:0};
EBG.declareClass(EBG.Interactions.TimerInteractionData,EBG.Interactions.InteractionData);EBG.Interactions.AggregationInteractionData=function(a,c,d){this.reportingName=a;EBG.callSuperConstructor(EBG.Interactions.AggregationInteractionData,this,[a,d,c])};EBG.Interactions.AggregationInteractionData.prototype={value:0,isPlaying:!1};EBG.declareClass(EBG.Interactions.AggregationInteractionData,EBG.Interactions.InteractionData);EBG.declareNamespace("Utilities.InteractionUtil");
EBG.Utilities.InteractionUtil=function(){};
EBG.Utilities.InteractionUtil.prototype={getBannerRedirectUrl:function(a){if(!a||!a.adConfig)return"";var c=a.adConfig.protocol+EBG.combinePaths(a.adConfig.bsPath,EBG.format("{0}/adServer.bs?cn=brd&Page={1}&PluID={2}&Pos={3}&EyeblasterID={4}",a.adConfig.interactionServer,a.adConfig.page,a.adConfig.pluId,a.adConfig.rnd,a.adConfig.adId));EBGInfra.isDefinedNotNull(a.clickVal)&&(c+="&clk="+a.clickVal);!a.adConfig.isPreview&&!a.isClickTag&&(c+="&sct=1");if(a.adConfig.massVersioning){if(a.adConfig.massVersioning.adVersions||a.adConfig.massVersioning.defaultAdVersion)a.sClickedVersion?
c+="&vid="+a.sClickedVersion+"&vcl=1":a.versionToReport&&(c+="&vid="+a.versionToReport);a.adConfig.massVersioning.targetAudienceId&&(c+="&ta="+a.adConfig.massVersioning.targetAudienceId);a.adConfig.massVersioning.deliveryGroupId&&(c+="&dg="+a.adConfig.massVersioning.deliveryGroupId);a.adConfig.massVersioning.versionTargetAudienceId&&(c+="&tav="+a.adConfig.massVersioning.versionTargetAudienceId);a.adConfig.massVersioning.dgTargetAudienceId&&(c+="&tadg="+a.adConfig.massVersioning.dgTargetAudienceId);
a.adConfig.massVersioning.originalDeliveryGroupId&&(c+="&dgo="+a.adConfig.massVersioning.originalDeliveryGroupId)}a.sJumpUrl&&(c+="&rtu="+encodeURIComponent(a.sJumpUrl));a.cvurl&&(c+=EBG.format("&cvurl={0}",encodeURIComponent('"'+a.cvurl.split("|").join('","')+'"')));a.fIsDefClick=EBG.isBool(a.fIsDefClick)?a.fIsDefClick:!1;a.fIsDefClick||(c+="&di=0");EBGInfra.isDefinedNotNull(a.adConfig.sPublisherPlacementId)&&(c+="&pc="+a.adConfig.sPublisherPlacementId);EBGInfra.isDefinedNotNull(a.adConfig.sID)&&
(c+="&sessionid="+a.adConfig.sID);a.adConfig.usercookie&&(c+="&usercookie="+a.adConfig.usercookie);EBGInfra.isDefinedNotNull(a.adConfig.optOut)&&(c+="&OptOut="+a.adConfig.optOut);EBGInfra.isDefinedNotNull(a.adConfig.ncu)&&(c+="&ncu="+encodeURIComponent(a.adConfig.ncu));EBGInfra.isDefinedNotNull(a.adConfig.ebReferrer)&&(c+="&ebReferrer="+encodeURIComponent(a.adConfig.ebReferrer));EBGInfra.isDefinedNotNull(a.adConfig.lineId)&&(c+="&lineid="+encodeURIComponent(a.adConfig.lineId));EBGInfra.isDefinedNotNull(a.adConfig.diAppId)&&
(c+="&diappid="+a.adConfig.diAppId);return c}};EBG.declareClass(EBG.Utilities.InteractionUtil,null);EBG.InteractionUtil=EBG.InteractionUtil||new EBG.Utilities.InteractionUtil;EBG.Interactions.Interaction=function(){};
EBG.Interactions.Interaction.prototype={unique:1,_escapeInteractionName:function(a){a=a.toString();a=a.replace(/\~/ig,"_");a=a.replace(/\^/ig,"_");a=a.replace(/\|/ig,"_");return escape(a)},_buildReportFormat:function(a,c,d,e){e||(e=0);return EBG.format("{0}{2}{1}{3}{1}{4}{1}{5}{6}{7}{8}{9}",EBG.Interactions.InteractionManager.charIntDelimeter,EBG.Interactions.InteractionManager.charAdFieldsDelimeter,this._escapeInteractionName(this.interactionData.reportingName),d,e,a,this.unique,c,this.interactionData.category,
this.interactionData.isPanel?1:0)}};EBG.Interactions.CounterInteraction=function(a){EBG.callSuperConstructor(EBG.Interactions.CounterInteraction,this);this.interactionData=a?a:new EBG.Interactions.CounterInteractionData};
EBG.Interactions.CounterInteraction.prototype={type:EBG.Interactions.InteractionTypes.COUNTER,handle:function(a){var c=this.interactionData,d=c.counterJumpUrlData,e=d&&d.tmpData?d.tmpData.isClick:!1,f=d&&d.tmpData?d.tmpData.isProductClick:!1,g=!1,h=!0,i=!1,i="",j=(d&&d.tmpData?d.tmpData.clickUrl:null)||(d?d.jumpUrl:""),d=d&&d.tmpData&&d.tmpData.windowWasOpen?!0:!1;this.shouldReportInteraction()?(this._handleRemoteServers(),c.counterJumpUrlData&&(h=j&&this._isEBClick()?!1:!0,g=j&&(e||this._isEBClick())?
!0:!1,(i=e||this._isEBClick())?g?d||this.handleBRDFlow():(e||f)&&this.reportThirdPartyUrls():!d&&j&&(j=EBG.Interactions.checkURL(j),this._openOrRedirect(j))),i=h?this._getReportingData(a,g):""):!d&&j&&(j=EBG.Interactions.checkURL(j),this._openOrRedirect(j));return i},reportThirdPartyUrls:function(){var a=this.interactionData.reportingName.toLowerCase()==EBG.Interactions.SystemInts.DEFAULT_CLICK.toLowerCase(),c=this.interactionData.counterJumpUrlData,d=[];if(c&&c.tmpData&&c.tmpData.isClick&&(d=this.interactionData.adConfig.clickTrackingUrls,
a||this.interactionData.adConfig.showOnlyImage))for(a=0;a<this.interactionData.adConfig.defaultClickTrackingUrls.length;a++)d[d.length]=this.interactionData.adConfig.defaultClickTrackingUrls[a];if(c&&c.tmpData&&c.tmpData.isProductClick&&c.tmpData.clickedVerUrl)d[d.length]=c.tmpData.clickedVerUrl;for(a=0;a<d.length;a++)EBG.adaptor.reportToRemoteServerUsingImage(d[a])},shouldReportInteraction:function(){var a=!0;0==this.interactionData.numLeftToReport||EBG.isPreview||EBG.isInWorkshop?a=!1:this.interactionData.numLeftToReport--;
return a},handleBRDFlow:function(){var a=this.interactionData,c=this.interactionData.counterJumpUrlData,d=EBGInfra.isDefinedNotNull(c)&&c.tmpData?c.tmpData.clickUrl:null,e=d||EBGInfra.isDefinedNotNull(c)&&c.jumpUrl;this._isEBClick()&&(d||(e=""));a=a.reportingName.toLowerCase()==EBG.Interactions.SystemInts.DEFAULT_CLICK.toLowerCase();d=0;c.tmpData.isClick?d=1:c.tmpData.isProductClick&&(d=2);e=""==e?"":EBG.Interactions.checkURL(e);e=this._getBannerRedirectUrl(e,d,a,c.tmpData.clickedVersion);e=EBG.Interactions.checkURL(e);
this._openOrRedirect(e)},_openOrRedirect:function(a){-1==this.interactionData.counterJumpUrlData.target.indexOf(EBG.WindowTarget.BLANK)?(this.interactionData.reportImmediately=!0,EBG.runTimed(this,this._openPage,[a,this.interactionData.counterJumpUrlData],1E3)):this._openPage(a,this.interactionData.counterJumpUrlData)},getClickTagUrl:function(a){var c="",a=EBG.isDefined(a)&&""!=a?EBG.Interactions.checkURL(a):void 0;EBG.isPreview?EBG.isInWorkshop?c=EBG.format("ReportPage_{0}.html",HTMLPageVer):(c=
this.interactionData.counterJumpUrlData.jumpUrl,4<=c.length&&"http"!=c.substr(0,4)&&(c=EBG.format("{0}{1}",ebPtcl,c))):(c=this._getBannerRedirectUrl(a,null,null,null,!0),c=EBG.format("{0}/ReportPage{1}.html?ebReportURL={2}$$ebImpressionID={3}",ebBigS,EBG.reportPageVer,escape(c),EBG.Ads.Ad.Fn.getRandFromAdUId(this.interactionData.adConfig.uid)),a=-1,EBG.adaptor.browser.isIE()&&(a=9<=EBG.adaptor.browser.getVersion()?4096:2048,a-=c.length),a=this._getReportPageTrackingUrls(a),c+=a);return c},_getReportPageTrackingUrls:function(a){var c=
"$$ebTURLs=[";if(-1!=a){if(c.length>=a)return"";a-=c.length}for(var d=this.interactionData.adConfig.clickTrackingUrls,e=0;e<d.length;e++){var f=EBG.format('{0}"{1}"',0!=e?",":"",d[e]);if(-1!=a){if(f.length>=a)break;a-=f.length}c+=f}return c+"]"},_openPage:function(a,c){var d=c.tmpData.clickedVerUrl?encodeURIComponent('"'+c.tmpData.clickedVerUrl.split("|").join('","')+'"'):"",e=c.tmpData.clickedVerUrl&&!EBG.isPreview&&!EBG.isInWorkshop?a+"&cvurl="+d:a;switch(EBG.adaptor.getRequestMethod(e)){case "GET":EBG.adaptor.openPage(e,
c);break;case "POST":var f=c.target;if(!(EBG.adaptor.browser.isIE()&&9>=EBG.adaptor.browser.getVersion()))c.target=!c.target||c.target==EBG.WindowTarget.BLANK?"ebReportPage"+parseInt(1E8*Math.random()):c.target,EBG.adaptor.openPage("",c);EBG.runTimed(this,function(){function d(a,c){var e=document.createElement("input");e.setAttribute("type","hidden");e.setAttribute("name",a);e.setAttribute("value",c);return e}var h=document.createElement("form");h.setAttribute("method","post");h.setAttribute("action",
a.substring(0,e.indexOf("?"))+"?cn=brd&ebReferrer="+encodeURIComponent(this.interactionData.adConfig.ebReferrer));h.setAttribute("target",c.target);c.target=f;var i=this._urlQueryStringToJSON(e),j;for(j in i)h.appendChild(d(j,unescape(i[j])));EBG.adaptor.getDisplayWin().document.body.appendChild(h);h.submit()},[],25);break;default:EBG.adaptor.openPage(e,c)}},_urlQueryStringToJSON:function(a){var c={},d=a.substring(a.indexOf("?")+1);if(!d)return c;for(var a=[],e=0,f=0;f<d.length;f++)switch(d.charAt(f)){case "&":a.push(d.substring(e,
f));e=f+1;break;case "$":if("="==d.charAt(f-1)&&"$"==d.charAt(f+1))for(f+=2;!("$"==d.charAt(f)&&"$"==d.charAt(f-1));)f++}a.push(d.substring(e));for(f=0;f<a.length;f++)d=a[f],c[d.substring(0,d.indexOf("="))]=d.substring(d.indexOf("=")+1);return c},_getReportScript:function(a,c){return'<script type="text/javascript">var clkURLs = ["'+a.join('","')+'"];var reported = false;var cntr = 0; for (var i=0;i<'+a.length+';i++){var img = document.createElement("img");img.onload = img.onerror = function(){cntr++; if (cntr=='+
a.length+' && !reported){reported = true; window.location.replace("'+c+'");}};try{img.src = clkURLs[i];}catch(e){cntr++; if (cntr=='+a.length+' && !reported){reported = true; window.location.replace("'+c+'");}}}setTimeout(function(){if (!reported){reported=true;window.location.replace("'+c+'");}}, 1000);<\/script><body></body>'},_getReportingData:function(a,c){var d=0,e=0;c||(d=this.interactionData.counterJumpUrlData&&this.interactionData.counterJumpUrlData.tmpData.isClick?1:0,e=this.interactionData.initiationType==
EBG.Interactions.InitiationTypes.USER?1:0);var f=this.interactionData.value?this.interactionData.value:0;if(EBG.isObj(f)&&(this.interactionData.reportingName==EBG.Interactions.SystemInts.AD_PARAMS||this.interactionData.reportingName==EBG.Interactions.SystemInts.PLAYER_PARAMS)){if(this.interactionData.reportingName==EBG.Interactions.SystemInts.AD_PARAMS)f.idx=this.interactionData.numToReport-this.interactionData.numLeftToReport;f=EBG.serializeObject(f)}d=this._buildReportFormat(d,e,f,a);this.unique=
0;return d},_getBannerRedirectUrl:function(a,c,d,e,f){var g=this.interactionData.adConfig,h;if(g.massVersioning&&(g.massVersioning.adVersions||g.massVersioning.defaultAdVersion))h=e?e:EBG.Ads.Ad.Fn.getVersionToReport(g.massVersioning.adVersions);return EBG.InteractionUtil.getBannerRedirectUrl({adConfig:g,sJumpUrl:a,clickVal:c,fIsDefClick:d,sClickedVersion:e,isClickTag:f,versionToReport:h})},_handleRemoteServers:function(){if(!EBG.isPreview&&this.interactionData.remoteServers){var a=this.interactionData.remoteServers,
c=new EBG.Events.Event(EBG.Events.EventNames.INTERACTION_REPORT_REMOTE_SERVERS);c.dispatcher=this;c.timing=EBG.Events.EventTiming.BEFORE;c.eventData={remoteServers:a};EBG.eventMgr.dispatchEvent(c)||(a.networkUrl&&(c=this._replaceRSTokens(a.networkUrl),EBG.adaptor.reportToRemoteServerUsingImage(c)),a.agencyUrl&&(a=this._replaceRSTokens(a.agencyUrl),EBG.adaptor.reportToRemoteServerUsingImage(a)))}},_replaceRSTokens:function(a){try{a=a.replace(/\[ebInteraction\]/ig,this.interactionData.reportingName),
a=a.replace(/\[ebInteractionNum\]/ig,EBG.intMgr.adsData[this.interactionData.adConfig.uid].numOfInteractions)}catch(c){}return a},_getReportingPage:function(){var a=this.interactionData.adConfig.page,a=a.replace(/\~/ig,"_"),a=a.replace(/\^/ig,"_"),a=a.replace(/\|/ig,"_");return escape(a)},_isEBClick:function(){return this.interactionData&&(EBG.strEQ(this.interactionData.reportingName,EBG.Interactions.SystemInts.CLICK)||EBG.strEQ(this.interactionData.reportingName,EBG.Interactions.SystemInts.DEFAULT_CLICK))}};
EBG.declareClass(EBG.Interactions.CounterInteraction,EBG.Interactions.Interaction);EBG.Interactions.TimerInteraction=function(a){EBG.callSuperConstructor(EBG.Interactions.TimerInteraction,this);this.interactionData=a?a:new EBG.Interactions.TimerInteractionData};
EBG.Interactions.TimerInteraction.prototype={type:EBG.Interactions.InteractionTypes.TIMER,handle:function(a){var c=this.interactionData.value;this.isRunning()&&(this.stop(),this.start());var c=this.interactionData.value-c,c=0<c?c:0,d=this.interactionData.idleDuration/1E3;this.interactionData.value-=d<=c?d:c;this.interactionData.idleDuration=0;c=EBG.Interactions.InteractionManager.MAX_AD_DURATION_SEC;this.interactionData.value=this.interactionData.value>c?c:this.interactionData.value;this.interactionData.value=
Math.floor(this.interactionData.value);return 0>=this.interactionData.value?!1:this._buildReportFormat(0,0,this.interactionData.value,a,0)},start:function(){var a=new EBG.Events.Event(EBG.Events.EventNames.START_TIMER);a.dispatcher=this;a.timing=EBG.Events.EventTiming.BEFORE;a.eventData={interaction:this};if(!EBG.eventMgr.dispatchEvent(a)){if(!this.isRunning())this.interactionData.startTime=(new Date).getTime(),a.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(a)}},stop:function(){if(this.isRunning()){var a=
new EBG.Events.Event(EBG.Events.EventNames.STOP_TIMER);a.dispatcher=this;a.timing=EBG.Events.EventTiming.BEFORE;a.eventData={interaction:this};if(!EBG.eventMgr.dispatchEvent(a))this.interactionData.value+=this.getElapsedTime()/1E3,this.interactionData.startTime=0,a.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(a)}},getElapsedTime:function(){return(new Date).getTime()-this.interactionData.startTime},update:function(a){var c=new EBG.Events.Event(EBG.Events.EventNames.UPDATE_TIMER);
c.dispatcher=this;c.timing=EBG.Events.EventTiming.BEFORE;c.eventData={interaction:this};if(!EBG.eventMgr.dispatchEvent(c))this.interactionData.value+=a,c.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(c)},clear:function(){this.interactionData.value=0;this.interactionData.startTime=0},increaseIdleDuration:function(a){this.interactionData.idleDuration+=a},isRunning:function(){return 0<this.interactionData.startTime},isFinished:function(){return 0===this.interactionData.startTime&&
0<this.interactionData.value},getValue:function(){return this.interactionData.value},getType:function(){return EBG.DurationInteraction.TIMER}};EBG.declareClass(EBG.Interactions.TimerInteraction,EBG.Interactions.Interaction);EBG.Interactions.IdleManager=function(){this.currentIdleDuration=0;this._startTime=(new Date).getTime();this.intervalId=EBG.setInterval(this,this._checkIfIdle,[],EBG.Interactions.IdleManager.IDLE_INTERVAL)};EBG.Interactions.IdleManager.IDLE_INTERVAL=5E3;
EBG.Interactions.IdleManager.prototype={_totalIdleDuration:0,_lastActiveTimeStamp:0,updateIdleDuration:function(){this.currentIdleDuration=0;var a=(new Date).getTime();if(0!==this._lastActiveTimeStamp)this.currentIdleDuration=a-this._lastActiveTimeStamp,this.currentIdleDuration>EBG.Interactions.IdleManager.IDLE_INTERVAL+2E3&&(this._totalIdleDuration+=this.currentIdleDuration,EBG.intMgr.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.HANDLE_IDLE))},_checkIfIdle:function(){this.updateIdleDuration();
if((this._lastActiveTimeStamp=(new Date).getTime())-this._startTime-this._totalIdleDuration>1E3*EBG.Interactions.InteractionManager.MAX_AD_DURATION_SEC)EBG.intMgr.unLoadHandler(EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT,!1),EBG.eventMgr.dispatchEvent(new EBG.Events.Event(EBG.Events.EventNames.MAX_AD_DURATION)),EBG.clearInterval(this.intervalId)}};EBG.declareClass(EBG.Interactions.IdleManager,null);
EBG.Interactions.StdInteractionManager=function(){this.adsData=EBG.intMgr?EBG.intMgr.adsData:{};this.adsIntQueues=EBG.intMgr?EBG.intMgr.adsIntQueues:{}};
EBG.Interactions.StdInteractionManager.prototype={copy:function(a){this.adsIntQueues=a.adsIntQueues;this.adsData=a.adsData},initAdData:function(a,c){var d=a.uid;this.adsIntQueues[d]=this.adsIntQueues[d]?this.adsIntQueues[d]:[];d=this.adsData[d]={adConfig:a,isUserInteractionOccur:!1,isClickOccur:!1,isProductClicked:[],numOfInteractions:0,delayIntReport:c,videoState:{},assetsTimers:{},clickReportScript:""};d[EBG.Interactions.InteractionTypes.COUNTER]={};d[EBG.Interactions.InteractionTypes.TIMER]={};
d.adConfig.isStdAd||this._addSystemInteractions(a)},allowInteractionReport:function(a){if(this.adsData[a])this.adsData[a].delayIntReport=!1},addInteraction:function(a,c){var d=EBG.isDefinedNotNull(c)?c.toLowerCase():a.interactionData.reportingName.toLowerCase(),e=a.interactionData.adUId,f=new EBG.Events.Event(EBG.Events.EventNames.ADD_INTERACTION);f.eventData=a;f.dispatcher={_adConfig:{rnd:this.adsData[e].adConfig.rnd}};f.timing=EBG.Events.EventTiming.BEFORE;var g=EBG.eventMgr.dispatchEvent(f),h=
this.adsData[e];if(!g){if(!h)return;h[a.type][d]=a;a.interactionData.adConfig=this.adsData[e].adConfig}f.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(f)},getClickTag:function(a){return(a=this._getCounterInteraction(EBG.Interactions.SystemInts.CLICK,a))?a.getClickTagUrl():""},getClickTarget:function(a){var c="_blank";if(!EBG.isPreview&&EBG.isInWorkshop&&(a=this._getCounterInteraction(EBG.Interactions.SystemInts.CLICK,a)))c=a.interactionData.counterJumpUrlData.target;return c},
handleCloseAdParts:function(a,c){if(a&&1==a.fClose){var d=new EBG.Events.Event(EBG.Events.EventNames.CLOSE_AD);d.dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(c)}};d.eventData={closeDueToClickthrough:!0};EBG.eventMgr.dispatchEvent(d)}},handleCounterInteraction:function(a,c,d,e,f,g){var h=this._getCounterInteraction(a,c),i=h?h.interactionData:null,j=i?i.counterJumpUrlData:null,k=this.adsData[c],l=k.adConfig.isStdAd,m="",g=EBGInfra.isDefined(g)?g:!0,d=d||0;if(!l&&i)i.initiationType=e?EBG.Interactions.InitiationTypes.USER:
i.initiationType,this._handleUserInteraction(c,i),this._handleSpecialInteractions(a,c,d);if(h&&(a=new EBG.Events.Event(EBG.Events.EventNames.HANDLE_COUNTER_INTERACTION),a.dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(c)}},a.timing=EBG.Events.EventTiming.BEFORE,a.eventData={interaction:h},!EBG.eventMgr.dispatchEvent(a))){if(j)j.tmpData=f,j.tmpData.isClick=i.countAsClick&&!k.isClickOccur,k.isClickOccur=j.tmpData.isClick?!0:k.isClickOccur,j.tmpData.isProductClick=i.countAsClick&&j.tmpData.clickedVersion&&
!k.isProductClicked[j.tmpData.clickedVersion],j.tmpData.isProductClick&&(k.isProductClicked[j.tmpData.clickedVersion]=!0);else if(f&&f.value)h.interactionData.value=f.value;m=g?h.handle(d):"";k.numOfInteractions++;m&&(this._handleReportData(c,i,m),this._isReportDataInQueue(c,m)||this.reportInteractionQueues());this.handleCloseAdParts(j,c);a.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(a)}},isInteractionExist:function(a,c,d){if(this.adsData[d]&&this.adsData[d][c])return this.adsData[d][c][a]?
!0:!1},_getCounterInteraction:function(a,c){a=a.toLowerCase();if(this.adsData[c]&&this.adsData[c][EBG.Interactions.InteractionTypes.COUNTER]&&this.adsData[c][EBG.Interactions.InteractionTypes.COUNTER][a])return this.adsData[c][EBG.Interactions.InteractionTypes.COUNTER][a]},getRepScr:function(a){if(this.adsData[a]&&this.adsData[a].clickReportScript)return this.adsData[a].clickReportScript}};EBG.declareClass(EBG.Interactions.StdInteractionManager,null);
EBG.Interactions.InteractionManager=function(a){EBG.callSuperConstructor(EBG.Interactions.InteractionManager,this);EBG.intMgr&&EBG.intMgr.copy(this);this._interactionServer=a.is||"BurstingPipe";this._interactionPipe=EBG.combinePaths(EBG.protocol+EBG.bs,this._interactionServer+"/adServer.bs?cn=int&iv=2&int=");this._interactionsStrPipe=EBG.combinePaths(EBG.protocol+EBG.bs,this._interactionServer+"/adServer.bs?cn=int&iv=2&interactionsStr=");this.idleManager=new EBG.Interactions.IdleManager;this._timedReport=
EBG.isDefined(EBG.intReportTimeout)&&null!=EBG.intReportTimeout&&0<=EBG.intReportTimeout?EBG.intReportTimeout:this._timedReport;this._subscribeToEvents()};EBG.Interactions.InteractionManager.charAdFieldsDelimeter="~";EBG.Interactions.InteractionManager.charIntDelimeter="^";EBG.Interactions.InteractionManager.intStackLength=7;EBG.Interactions.InteractionManager.MAX_AD_DURATION_SEC=900;EBG.Interactions.InteractionManager.INTERACTION_THRESHOLD_SEC=86400;
EBG.Interactions.InteractionManager.HandleAllTimersOptions={REPORT:0,PAUSE:1,HANDLE_IDLE:2};
EBG.Interactions.InteractionManager.prototype={_isUnloadHandled:!1,_pausedTimers:null,_masterOrdinalNumber:null,_seqTimersReportData:{index:-1,intervals:[5,10,20,40,60,120,240]},_timedReport:1E4,_interactionPipe:null,_interactionServer:null,startAggregate:function(a,c,d){if(null==this._masterOrdinalNumber)this._masterOrdinalNumber=d;this.startTimer(a,c,d)},startTimer:function(a,c,d){var e=this._getTimerInteraction(a,c);if(e){e.start();if(EBGInfra.isDefined(d)&&EBGInfra.notNull(d))switch(e=this.adsData[c],
e=e.assetsTimers[d]?e.assetsTimers[d]:e.assetsTimers[d]={},a){case EBG.VideoInteraction.VIDEO_PLAY_DURATION:this._startAssetTimer(e,EBG.VideoInteraction.VIDEO_ASSET_DURATION,c,d);break;case EBG.VideoInteraction.FULLSCREEN_DURATION:this._startAssetTimer(e,EBG.VideoInteraction.FULLSCREEN_ASSET_DURATION,c,d)}EBG.isGlobalDef("JSON")}},_handleVideoStarted:function(a,c){var d=new EBG.Events.Event(EBG.Events.EventNames.DWELL_VIDEO_START);d.dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(a)}};d.eventData=
{assetId:c};EBG.eventMgr.dispatchEvent(d)},_startAssetTimer:function(a,c,d,e){if(!a[c]){var f;null!=this._masterOrdinalNumber?(f=new EBG.Interactions.AggregationInteractionData(c,EBG.Interactions.Categories.VIDEO,d),a[c]=new EBG.Interactions.AggregateInteraction(f)):(f=new EBG.Interactions.TimerInteractionData(c,EBG.Interactions.Categories.VIDEO,d),a[c]=new EBG.Interactions.TimerInteraction(f))}a[c].start();this._handleVideoStarted(d,e)},updateAggregation:function(a,c,d,e){if(null==this._masterOrdinalNumber)this._masterOrdinalNumber=
e;var f=this._getTimerInteraction(a,c);if(f&&(this._masterOrdinalNumber==e&&f.update(d),EBGInfra.isDefined(e)&&EBGInfra.notNull(e)))switch(f=this.adsData[c],f=f.assetsTimers[e]?f.assetsTimers[e]:f.assetsTimers[e]={},a){case EBG.VideoInteraction.VIDEO_PLAY_DURATION:this._updateAssetAggregation(f,EBG.VideoInteraction.VIDEO_ASSET_DURATION,c,d,e);break;case EBG.VideoInteraction.FULLSCREEN_DURATION:this._updateAssetAggregation(f,EBG.VideoInteraction.FULLSCREEN_ASSET_DURATION,c,d,e)}},_updateAssetAggregation:function(a,
c,d,e){a[c]||(d=new EBG.Interactions.AggregationInteractionData(c,EBG.Interactions.Categories.VIDEO,d),a[c]=new EBG.Interactions.AggregateInteraction(d));a[c].update(e)},stopAggregate:function(a,c,d){this._masterOrdinalNumber=null;this.stopTimer(a,c,d)},stopTimer:function(a,c,d){var e=this._getTimerInteraction(a,c),f=this.adsData[c].assetsTimers,g=!0;if(e){if(EBGInfra.isDefined(d)&&EBGInfra.notNull(d)&&f[d])switch(a){case EBG.VideoInteraction.VIDEO_PLAY_DURATION:f[d][EBG.VideoInteraction.VIDEO_ASSET_DURATION].stop();
g=!this._isRunningVideoAsset(c,!1);break;case EBG.VideoInteraction.FULLSCREEN_DURATION:f[d][EBG.VideoInteraction.FULLSCREEN_ASSET_DURATION].stop()}g&&e.stop();if(EBGInfra.isDefined(d)&&EBGInfra.notNull(d))a=new EBG.Events.Event(EBG.Events.EventNames.DWELL_VIDEO_STOP),a.dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(c)}},a.eventData={assetId:d},EBG.eventMgr.dispatchEvent(a)}},clearTimer:function(a,c){var d=this._getTimerInteraction(a,c);d&&d.clear()},_isRunningAnyVideoAsset:function(a){return this._isRunningVideoAsset(a,
!1)||this._isRunningVideoAsset(a,!0)},_isRunningVideoAsset:function(a,c){var d=this.adsData[a].assetsTimers,e;for(e in d)if(d.hasOwnProperty(e)){var f=c?"ebFSVideoAssetDuration":"ebVideoAssetDuration";if(d[e][f]&&d[e][f].isRunning())return!0}return!1},updateTimer:function(a,c,d,e){if(a=this._getTimerInteraction(a,c))a.update(d),EBGInfra.isDefined(e)&&EBGInfra.notNull(e)&&this.adsData[c].assetsTimers[e].update(d)},getTimerValue:function(a,c){var d=this._getTimerInteraction(a,c);return d?d.getValue():
0},isTimerRunning:function(a,c){var d=this._getTimerInteraction(a,c);return d?d.isRunning():!1},_handleUserInteraction:function(a,c){if(c.initiationType==EBG.Interactions.InitiationTypes.USER&&!this.adsData[a].isUserInteractionOccur){this.adsData[a].isUserInteractionOccur=!0;var d=new EBG.Events.Event(EBG.Events.EventNames.USER_INTERACTION);d.dispatcher={_adConfig:{rnd:EBG.Ads.Ad.Fn.getRandFromAdUId(a)}};EBG.eventMgr.dispatchEvent(d);this._reportUserInteraction(a)}},_handlePanelsViewed:function(a,
c){c.isPanel&&c.initiationType==EBG.Interactions.InitiationTypes.USER&&this.handleCounterInteraction(EBG.ExpBaseInteractions.PANELS_VIEWED,a)},_handleReportData:function(a,c,d){c.reportingName==EBG.Interactions.SystemInts.AD_PARAMS||c.reportingName==EBG.Interactions.SystemInts.PLAYER_PARAMS?this._handleDataParams(a,c,d):(this.adsIntQueues[a].push(d),a=this.adsIntQueues[a].length==EBG.Interactions.InteractionManager.intStackLength?!0:!1,(c&&(c.reportImmediately||c.counterJumpUrlData&&c.counterJumpUrlData.tmpData.isClick)||
a)&&this.reportInteractionQueues())},_handleDataParams:function(a,c,d){this._shouldReportDataParamsNow(a,c,d)&&(c=this._getAdReportData(a),d=encodeURIComponent(d),a=this._getPipeParams(a,!1),this._reportServer(this._interactionsStrPipe+"$$"+c+d+"$$"+a,!0))},_shouldReportDataParamsNow:function(a,c){return!c.numToReport?!0:1==c.numToReport-c.numLeftToReport?!0:!1},_handleSpecialInteractions:function(a,c,d){var e=this._getCounterInteraction(a,c),a=e.interactionData;this._handleUserInteraction(c,a);switch(a.reportingName){case EBG.VideoInteraction.STARTED:e.unique&&
this._reportUniqueVideoStarted(c);this.adsData[c].isUserInteractionOccur&&this._reportUserInitatedVideo(c,d);break;case EBG.VideoInteraction.FULLSCREEN_START:if(this._isRunningVideoAsset(c,!1))switch(e=this._getTimerInteraction(EBG.VideoInteraction.VIDEO_PLAY_DURATION,c),e=e.getType(),e){case EBG.DurationInteraction.TIMER:this.startTimer(EBG.VideoInteraction.FULLSCREEN_DURATION,c,d);this.stopTimer(EBG.VideoInteraction.VIDEO_PLAY_DURATION,c,d);break;case EBG.DurationInteraction.AGGREGATE:this.startAggregate(EBG.VideoInteraction.FULLSCREEN_DURATION,
c,d),this.stopAggregate(EBG.VideoInteraction.VIDEO_PLAY_DURATION,c,d)}break;case EBG.VideoInteraction.FULLSCREEN_END:if(this._isRunningVideoAsset(c,!0))switch(e=this._getTimerInteraction(EBG.VideoInteraction.VIDEO_PLAY_DURATION,c),e=e.getType(),e){case EBG.DurationInteraction.TIMER:this.startTimer(EBG.VideoInteraction.VIDEO_PLAY_DURATION,c,d);this.stopTimer(EBG.VideoInteraction.FULLSCREEN_DURATION,c,d);break;case EBG.DurationInteraction.AGGREGATE:this.startAggregate(EBG.VideoInteraction.VIDEO_PLAY_DURATION,
c,d),this.stopAggregate(EBG.VideoInteraction.FULLSCREEN_DURATION,c,d)}break;case EBG.VideoInteraction.FULLPLAY:this.stopTimer(EBG.VideoInteraction.VIDEO_PLAY_DURATION,c,d)}this._handlePanelsViewed(c,a)},handleVideoInteraction:function(a,c,d,e){if(EBGInfra.isDefined(d)&&EBGInfra.notNull(d)){var f=this.adsData[c].videoState;f[d]||(f[d]=0);var g=!0,h=EBG.indexOfArray(EBG.Interactions.VideoInteractionOrder,a);-1!=h&&(h==f[d]?f[d]++:g=!1);g&&this.handleCounterInteraction(a,c,d,e)}},handleAllTimers:function(a,
c){if(a==EBG.Interactions.InteractionManager.HandleAllTimersOptions.PAUSE)this._pausedTimers=[];var d=new EBG.Events.Event(EBG.Events.EventNames.COLLECT_TIMERS);d.dispatcher=this;d.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(d);for(var e in this.adsData)if(this.adsData.hasOwnProperty(e)){var d=this.adsData[e],f=d[EBG.Interactions.InteractionTypes.TIMER];f&&this._handleTimers(f,a,e);if(d.assetsTimers)for(var g in d.assetsTimers)d.assetsTimers.hasOwnProperty(g)&&this._handleTimers(d.assetsTimers[g],
a,e,g);d=new EBG.Events.Event(EBG.Events.EventNames.COLLECT_TIMERS);d.dispatcher=this;d.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.dispatchEvent(d);a===EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT&&(d=0<=this._seqTimersReportData.index,c=EBG.isBool(c)?c:!0,!c&&this.adsData[e].adConfig&&navigator&&navigator.sendBeacon?this.reportInteractionQueues(c,d,!0):this.reportInteractionQueues(c,d))}},_handleTimers:function(a,c,d,e){for(var f in a)if(a.hasOwnProperty(f)){var g=a[f];
if(g.isRunning()||g.isFinished())switch(c){case EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT:(g=g.handle(e))&&this.adsIntQueues[d].push(g);break;case EBG.Interactions.InteractionManager.HandleAllTimersOptions.PAUSE:g.stop();this._pausedTimers.push(g);break;case EBG.Interactions.InteractionManager.HandleAllTimersOptions.HANDLE_IDLE:g.increaseIdleDuration(this.idleManager.currentIdleDuration)}}},pauseAllTimers:function(){return this.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.PAUSE,
!0)},resumeAllTimers:function(){if(null!=this._pausedTimers){for(var a=0;a<this._pausedTimers.length;a++)this._pausedTimers[a].start();this._pausedTimers=null}},reportInteractionQueues:function(a,c,d){if(!(EBG.getTime()>EBG.Interactions.InteractionManager.INTERACTION_THRESHOLD_SEC)){var a=EBG.isBool(a)?a:!0,c=EBG.isBool(c)?c:!1,e="",f=this._interactionPipe,g;for(g in this.adsData)if(this.adsData.hasOwnProperty(g)){var h=this.adsIntQueues[g];if(!this.adsData[g].delayIntReport)for(;h.length;){for(var i=
this._getAdReportData(g),j=0,k=this._isUnloadHandled?h.length:EBG.Interactions.InteractionManager.intStackLength,l=0;l<h.length&&l<k;l++)i+=h[l],j++;for(l=0;l<j;l++)h.shift();this._isUnloadHandled?(""!=e&&(e+="|"),e+=i):this._reportServer(f+i+this._getPipeParams(g,c),a,d)}}if(this._isUnloadHandled&&""!=e){for(g in this.adsData)if(this.adsData.hasOwnProperty(g)){e=f+e+this._getPipeParams(g,c);break}this._reportServer(e,a,d)}}},_reportServer:function(a,c,d){if(!EBG.isPreview||EBG.isGlobalDef("gfEbForceReportInt"))d?
EBG.adaptor.reportBeacon(a):EBG.adaptor.reportToRemoteServer(a,c)},_isReportDataInQueue:function(a,c){for(var d=!1,e=this.adsIntQueues[a],f=0;f<e.length;f++)if(e[f]===c){d=!0;break}return d},_getPipeParams:function(a,c){var d="",e=this.adsData[a].adConfig.usercookie;e&&(d+=EBG.format("&usercookie={0}",e));(e=this.adsData[a].adConfig.optOut)&&(d+=EBG.format("&OptOut={0}",e));c&&(d+=EBG.format("&iseq={0}",this._seqTimersReportData.index));EBG.isGlobalDef("gfEbForceReportInt")&&(d+="&pr=1");d+=EBG.format("&rnd={0}",
Math.random());EBG.adaptor.flash&&(d+=EBG.format("&flv={0}",EBG.adaptor.flash.version));EBG.isDefined(EBG.adaptor.getResolution)&&(d+=EBG.format("&res={0}",EBG.adaptor.getResolution()));EBGInfra.isDefinedNotNull(this.adsData[a].adConfig.diAppId)&&(d+="&diappid="+this.adsData[a].adConfig.diAppId);return d},_getAdReportData:function(a){var c=this.adsData[a].adConfig,d=EBG.Interactions.InteractionManager.charAdFieldsDelimeter;return EBG.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}{9}{10}{11}{12}",EBG.Ads.Ad.Fn.getAdIdFromAdUId(a),
d,c.page,d,c.pluId,d,c.massVersioning.targetAudienceId,d,c.massVersioning.deliveryGroupId,d,EBG.Ads.Ad.Fn.getVersionToReport(c.massVersioning.adVersions),d,this.adsData[a].adConfig.sID)},_addSystemInteractions:function(a){var a=a.uid,c=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.USER_INTERACTION,EBG.Interactions.Categories.SYSTEM,a);c.numLeftToReport=1;this.addInteraction(new EBG.Interactions.CounterInteraction(c));c=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.UNIQUE_VIDEO_STARTED,
EBG.Interactions.Categories.VIDEO,a);c.numLeftToReport=1;this.addInteraction(new EBG.Interactions.CounterInteraction(c));c=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.DWELL_UNIQUE,EBG.Interactions.Categories.SYSTEM,a);c.reportImmediately=!0;c.numLeftToReport=1;this.addInteraction(new EBG.Interactions.CounterInteraction(c));c=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.REPLAY,EBG.Interactions.Categories.SYSTEM,a);this.addInteraction(new EBG.Interactions.CounterInteraction(c));
a=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.RICH_FLASH_PLAYED,EBG.Interactions.Categories.SYSTEM,a);a.numLeftToReport=1;this.addInteraction(new EBG.Interactions.CounterInteraction(a))},_reportUserInitatedVideo:function(a,c){this.handleVideoInteraction(EBG.VideoInteraction.USER_INITIATED_VIDEO,a,c)},_reportUserInteraction:function(a){this.handleCounterInteraction(EBG.Interactions.SystemInts.USER_INTERACTION,a)},_reportUniqueVideoStarted:function(a){this.handleCounterInteraction(EBG.Interactions.SystemInts.UNIQUE_VIDEO_STARTED,
a)},reportDwellUnique:function(a,c){c&&this.handleCounterInteraction(EBG.Interactions.SystemInts.DWELL_UNIQUE,a,null,!1)},reportRichFlashPlayed:function(a){this.handleCounterInteraction(EBG.Interactions.SystemInts.RICH_FLASH_PLAYED,a)},reportReplay:function(a){this.handleCounterInteraction(EBG.Interactions.SystemInts.REPLAY,a,0,EBG.ActionType.USER)},_getTimerInteraction:function(a,c){a=a.toLowerCase();if(this.adsData[c]&&this.adsData[c][EBG.Interactions.InteractionTypes.TIMER]&&this.adsData[c][EBG.Interactions.InteractionTypes.TIMER][a])return this.adsData[c][EBG.Interactions.InteractionTypes.TIMER][a]},
_subscribeToEvents:function(){EBG.adaptor.supportsPageLoadEvents()?(EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_BEFORE_UNLOAD,this.unLoadHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_UNLOAD,this.unLoadHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDE,this.unLoadHandler,this)),EBG.setInterval(this,this.reportInteractionQueues,[],this._timedReport)):
this._setNextTimerSeq(!0)},_handleAllTimersSeq:function(){var a=EBG.adaptor.browser.isMobile();EBG.adaptor.supportsPageLoadEvents();this.reportInteractionQueues(!a);this._pausedTimers||(this.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT,!a),this.resumeAllTimers());this._setNextTimerSeq(!1)},_setNextTimerSeq:function(a){a="undefined"!=typeof a&&a?this._seqTimersReportData.index=0:++this._seqTimersReportData.index;a<this._seqTimersReportData.intervals.length&&EBG.runTimed(this,
this._handleAllTimersSeq,[],1E3*this._seqTimersReportData.intervals[a])},unLoadHandler:function(){if(!this._isUnloadHandled)this._isUnloadHandled=!0,this.handleAllTimers(EBG.Interactions.InteractionManager.HandleAllTimersOptions.REPORT,!1)},getAdDuration:function(a){var c=0;(a=this._getTimerInteraction(EBG.Interactions.SystemInts.AD_DURATION,a))&&(c=a.getElapsedTime());return c}};EBG.declareClass(EBG.Interactions.InteractionManager,EBG.Interactions.StdInteractionManager);
EBG.DataProfile={GENERAL:"general",SERVING:"serving",USERINFO:"userInfo",PLATFORM:"platform",FRAUD:"fraud",VISIBILITY:"visibility",ERROR:"error"};EBG.DataPipe=function(a,c){this._profile=this._buildProfile(c||this._defaultProfile);this._duration=0;this._firstTickDelay=5E3;this._serverPipeUrl=a;EBG.setInterval(this,function(){this._duration++},[],1E3);EBG.setInterval(this,function(){this._observedHandler()},[],100);c&&c.length&&EBG.runTimed(this,this._tick,[],this._firstTickDelay)};
EBG.DataPipe.prototype={_data:{general:{}},_observedObjects:[],_tickCount:0,_tickDelay:1,_maxTicks:1,_completeProfile:{general:{sid:!0,dur:!0,adid:!1,frmt:!1},serving:{prtcl:!1,dmn:!1,url:!1,vurl:!1,srvmd:!1,aie:!1,imapp:!1},userInfo:{geo:!1,ip:!1},platform:{os:!1,osv:!1,brsrc:!1,brsrv:!1,brsrt:!1,flsv:!1,scrw:!1,scrh:!1,env:!1,mraid:!1,mraidw:!1},fraud:{bot:!1,injct:!1,stack:!1},visibility:{vsbp:!1,pct:!1,scrsr:!1,loc:!1,vsr:!1,vsri:!1,uvsr:!1,vsiab:!1,uvsiab:!1},error:{errn:!1,msg:!1}},_defaultProfile:{general:{adid:!1,
sid:!0,dur:!0}},_buildProfile:function(a){for(var c={},d=0;d<a.length;d++)c[a[d]]=EBG.cloneObj(this._completeProfile[a[d]]);EBG.mergeObj(this._defaultProfile,c,!1);return c},_clear:function(){for(var a in this._profile){var c=this._profile[a],d=void 0;for(d in c)!this._profile[a][d]&&this._data[a]&&(this._data[a][d]=null,delete this._data[a][d])}},_post:function(){var a={x:function(){if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;for(var a=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0",
"MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],d,e=0;e<a.length;e++)try{d=new ActiveXObject(a[e]);break}catch(f){}return d},post:function(c,d,e,f){try{var g=a.x();g.open("POST",c,f);g.onreadystatechange=function(){4==g.readyState&&e&&e(g.responseText)};g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send(JSON.stringify(d))}catch(h){}}};return a.post}(),_tick:function(){++this._tickCount;this.flush();this._tickCount<this._maxTicks&&(EBG.runTimed(this,this._tick,
[],1E3*Math.pow(2,this._tickDelay)),this._tickDelay++)},send:function(a,c,d){d=d||{};if(this._profile[a]){this._data[a]=this._data[a]||{};for(var e in c)e in this._profile[a]&&(this._data[a][e]=c[e]);if(d.constant)for(e in this._data[a])this._profile[a][e]=!0;d.flush&&this.flush()}},flush:function(){this._data.general.dur=this._duration;var a={},c;for(c in this._data)for(var d in this._data[c])a[d]=this._data[c][d];this._post(this._serverPipeUrl,a);this._clear()},watch:function(a,c,d,e,f){if(this._profile[a]&&
d){var g=this;Object.observe?Object.observe(d,function(h){for(var i=0;i<h.length;i++)if(h[i].name===e){var j={};j[c]=d[e].toString();g.send(a,j,f)}}):this._observedObjects.push({ns:a,key:c,value:d[e],obj:d,prop:e,options:f})}},_observedHandler:function(){for(var a=0;a<this._observedObjects.length;a++){var c=this._observedObjects[a];if(c.obj[c.prop]!==c.value){c.value=c.obj[c.prop];var d={};d[key]=c.obj[c.prop].toString();this.send(ns,d,c.options)}}}};
EBG.DataPipeManager=function(a,c){this._default=c;this._dpUrl=a};EBG.DataPipeManager.prototype={_pipes:{},createPipe:function(a,c){var d=new EBG.DataPipe(this._dpUrl,c||this._default);d.send(EBG.DataProfile.GENERAL,{sid:a});this._pipes[a]=d},getPipe:function(a){this._pipes[a]||this.createPipe(a);return this._pipes[a]},send:function(a,c,d,e){(a=this._pipes[a])&&a.send(c,d,e)}};EBG.declareNamespace("Positioning");EBG.Positioning.PositionManager=function(){};
EBG.Positioning.PositionManager.prototype={isVisibile:function(a,c,d){try{return 0<this.calculateVisibilityPercentage(a,c,d)?!0:!1}catch(e){}},calculateVisibilityPercentage:function(a,c,d,e,f,g,h){try{var i=0,j=0,k=0,l=!(EBG.adaptor.getDisplayWin()!=top&&h==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME),m=EBG.adaptor.getScrollLeftTop(l,h),o=EBG.adaptor.getViewPortMetrics(l,g,h),n=this.calculateRightBottowCoordinate(m,o.Width,o.Height),q=EBG.adaptor.getPositioningById(a,!l,h);if(null!=q){a={X:0,Y:0};try{!l&&
window.frameElement&&(a=EBG.adaptor.getPositioningByElement(window.frameElement,!1,h))}catch(s){a={X:0,Y:0}}q.X+=a.X;q.Y+=a.Y;"undefined"!=typeof e&&(q.X+=e);"undefined"!=typeof f&&(q.Y+=f);var r=this.calculateRightBottowCoordinate(q,c,d),k=c*d,j=this.calculateVisibleArea(m,n,q,r),i=k?j/k:0}return i}catch(p){}},calculateRightBottowCoordinate:function(a,c,d){var e={X:0,Y:0};e.X=a.X+c;e.Y=a.Y+d;return e},calculateVisibleArea:function(a,c,d,e){try{var f=0,g=0;if(d.Y==e.Y&&d.X==e.X||c.X<=a.X||c.Y<=a.Y)return 0;
d.X<=a.X&&a.X<=e.X?f=c.X<=e.X?c.X-a.X:e.X-a.X:a.X<=d.X&&d.X<=c.X&&(f=e.X>=c.X?c.X-d.X:e.X-d.X);d.Y<=a.Y&&a.Y<=e.Y?g=c.Y<=e.Y?c.Y-a.Y:e.Y-a.Y:a.Y<=d.Y&&d.Y<=c.Y&&(g=e.Y>=c.Y?c.Y-d.Y:e.Y-d.Y);return f*g}catch(h){}},getFullRectWithClip:function(a,c){var d=null,d=EBG.adaptor.getDisplayWin()===EBG.adaptor.getPageWin(),e=null;if(a){var d=EBG.adaptor.getPositioningByElement(a,!d,c),e={width:a.offsetWidth,height:a.offsetHeight},f=a.style.clip,g=0,h=0,i=e.height,j=e.width;""!=f&&(f=f.substring(f.indexOf("(")+
1).replace(/,/g,"").replace(/ /g,""),f=f.split("px"),h=parseInt(f[0]),j=parseInt(f[1]),i=parseInt(f[2]),g=parseInt(f[3]));e.left=d.X+g;e.top=d.Y+h;e.width-=e.width-j;e.width-=g;e.height-=e.height-i;e.height-=h;e.right=e.left+e.width;e.bottom=e.top+e.height}return e},isOverlapping:function(a,c,d){if(!a||0==a.offsetWidth&&0==a.offsetHeight||!c||0==c.offsetWidth&&0==c.offsetHeight)return!1;a=EBG.posHelper.getFullRectWithClip(a,d);c=EBG.posHelper.getFullRectWithClip(c,d);return!a||!c||a.bottom<c.top||
a.top>c.bottom||a.right<c.left||a.left>c.right?!1:!0}};EBG.declareClass(EBG.Positioning.PositionManager,null);EBG.declareNamespace("RichModules");EBG.RichModules.BasicVisibilityProvider=function(a,c){this._resObjId=a;this._res=EBG.adaptor.getElementById(a);this._adConfig=this.adConfig=c;this._subscribeToEvents();this._trackElementLocation()};EBG.RichModules.BasicVisibilityProvider._isAvailable=function(){return!1};
EBG.RichModules.BasicVisibilityProvider.prototype={name:"Basic",_isStarted:!1,_calculateVisibilityPercentage:function(){return 0},_getViewPortMetrics:function(){return null},_dispatchCheckVisibility:function(a){if(this._isStarted){var c=new EBG.Events.Event(EBG.Events.EventNames.VISIBILITY_CHECK);c.dispatcher=this;c.eventData=a;c.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.dispatchEvent(c)}},_dispatchVisibilityHidden:function(){var a=new EBG.Events.Event(EBG.Events.EventNames.VISIBILITY_HIDDEN);
a.dispatcher=this;a.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.dispatchEvent(a)},_subscribeToEvents:function(){},updateResourceObjId:function(a){this._resObjId=a;this._res=EBG.adaptor.getElementById(a);this._trackElementLocation()},_isVisible:function(){return!1},_calculateVisibilityResult:function(){var a={};try{a.assetId=this._resObjId,a.percentage=this._calculateVisibilityPercentage(),a.viewPort=this._getViewPortMetrics()}catch(c){}return a},start:function(){this._isStarted=!0},_trackElementLocation:function(){if(this._intervalHandler)clearInterval(this._intervalHandler),
this._intervalHandler=null;var a=this,c=EBG.adaptor.getBoundingClientRect(this._res,{clip:!0});if(c)this._intervalHandler=EBG.setInterval(this,function(){var d=EBG.adaptor.getBoundingClientRect(a._res,{clip:!0}),e;for(e in d)if(d[e]!=c[e]){c=d;a.onElementMoved();break}},[],200)},onElementMoved:function(){}};EBG.declareClass(EBG.RichModules.BasicVisibilityProvider,null);EBG.declareNamespace("RichModules");
EBG.RichModules.GeometricVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.GeometricVisibilityProvider,this,[a,c])};EBG.RichModules.GeometricVisibilityProvider._isAvailable=function(a){var c=!0,d=a.actualServingMode==EBG.Adaptors.ServingMode.IFRAME,e=EBG.Initializer._getAdClass({tn:a.templateName}),f=!e.requiresIframeBust&&!a.UiVz,e=e.requiresIframeBust&&!EBG.iframeLocation&&a.aiE&&!a.aiE.iflExists;if(d&&(f||e)||a.ffs.CFF_MRAIDVis&&EBG.adaptor.isInApp())c=!1;return c};
EBG.RichModules.GeometricVisibilityProvider.prototype={name:"Geometric",_focusOnResourceElem:null,_justReceivedFocusOnPage:null,_reachedMaxAdDuration:!1,_calculateVisibilityPercentage:function(a){var a=a||{},c=EBG.adaptor.getBoundingClientRect(this._res,{clip:!0}),d=a.resourceObjId||this._resObjId,e=a.width||c.width,c=a.height||c.height,f=a.offsetX||this.adConfig.offsetX,g=a.offsetY||this.adConfig.offsetY,a=a.actualServingMode||this.adConfig.actualServingMode,h=0;if(!EBG.adaptor.isPageVisible())return 0;
try{var i=0,j=0,k=this._getViewPortTopLeft(),l=this._getViewPortMetrics(),m=this.calculateRightBottowCoordinate(k,l.Width,l.Height),o=EBG.adaptor.getPositioningById(d,(this.adConfig.displayWin||EBG.adaptor.getDisplayWin())!=top&&a==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME,a);if(null!=o){var n;n=EBG.adaptor.browser.isFF()?this._getInnerFrameTopLeft(this.adConfig.displayWin||EBG.adaptor.getDisplayWin(),a):this._getNestedInnerFrameTopLeft(a);o.X+=n.X;o.Y+=n.Y;"undefined"!=typeof f&&(o.X+=f);"undefined"!=
typeof g&&(o.Y+=g);var q=this.calculateRightBottowCoordinate(o,e,c),j=e*c,i=this.calculateVisibleArea(k,m,o,q),h=j?i/j:0}return 100*h}catch(s){return 0}},_getViewPortMetrics:function(){var a="undefined"!=typeof this.adConfig&&EBG.isDefinedNotNull(this.adConfig)?this.adConfig.actualServingMode:EBG.adaptor.serving.detectServingMode(!0),a=EBG.adaptor._getCurrentWindow(void 0,a);heightWidth=EBG.adaptor.getWindowViewPortMetrics(a);if(EBG.adaptor.browser.isFF()&&"undefined"!=typeof a.outerWidth&&EBG.adaptor.serving.detectServingMode(!0)==
EBG.Adaptors.ServingMode.IFRAME&&("undefined"==typeof this.adConfig||!EBG.isDefined(this.adConfig.UiVz)||!this.adConfig.UiVz)&&!EBG.iframeLocation&&"undefined"!=typeof this.adConfig&&this.adConfig.aiE&&!this.adConfig.aiE.iflExists)heightWidth.Width=a.outerWidth,heightWidth.Height=a.outerHeighth,EBG.isDefined(a.scrollMaxX)&&0<a.scrollMaxX&&EBG.isDefined(EBG.adaptor.scrollBarWidth)&&0<EBG.adaptor.scrollBarWidth&&(heightWidth.Height-=EBG.adaptor.scrollBarWidth),EBG.isDefined(a.scrollMaxY)&&0<a.scrollMaxY&&
EBG.isDefined(EBG.adaptor.scrollBarHeight)&&0<EBG.adaptor.scrollBarHeight&&(heightWidth.Width-=EBG.adaptor.scrollBarHeight);return heightWidth},calculateRightBottowCoordinate:function(a,c,d){var e={X:0,Y:0};e.X=a.X+c;e.Y=a.Y+d;return e},calculateVisibleArea:function(a,c,d,e){try{var f=0,g=0;if(d.Y==e.Y&&d.X==e.X||c.X<=a.X||c.Y<=a.Y)return 0;d.X<=a.X&&a.X<=e.X?f=c.X<=e.X?c.X-a.X:e.X-a.X:a.X<=d.X&&d.X<=c.X&&(f=e.X>=c.X?c.X-d.X:e.X-d.X);d.Y<=a.Y&&a.Y<=e.Y?g=c.Y<=e.Y?c.Y-a.Y:e.Y-a.Y:a.Y<=d.Y&&d.Y<=c.Y&&
(g=e.Y>=c.Y?c.Y-d.Y:e.Y-d.Y);return f*g}catch(h){}},_isVisible:function(a){var a=a||{},c=EBG.adaptor.getBoundingClientRect(this._res,{clip:!0});return!!this._calculateVisibilityPercentage({resourceObjId:a.resourceObjId||this._resObjId,width:a.width||c.width,height:a.height||c.height,offsetX:a.offsetX||this.adConfig.offsetX,offsetY:a.offsetY||this.adConfig.offsetY,isUIVZ:a.isUIVZ||this.adConfig.UiVz,actualServingMode:a.actualServingMode||this.adConfig.actualServingMode})},_subscribeToEvents:function(){try{EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,
this,"_subscribeToEvents");EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_RESIZE,this._pageResizeHandler,this));EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_SCROLL,this._pageScrollHandler,this));if(!EBG.adaptor._getVisibilityEventName()||EBG.adaptor.browser.isAndroidNative()&&4.4>EBG.adaptor.browser.getVersion())EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_FOCUS,this._pageFocusHandler,
this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_BLUR,this._pageBlurHandler,this)),this._subscribeToElementEvents();var a=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDDEN,this._pageHiddenHandler,this);a.isDocumentEvent=!0;EBG.eventMgr.subscribeToEvent(a);a=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_VISIBLE,this._pageVisibleHandler,this);a.isDocumentEvent=!0;EBG.eventMgr.subscribeToEvent(a);EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.RICH_FLASH_PLAYED,
this.onChange,this))}catch(c){}},_subscribeToElementEvents:function(){var a=this,c=function(){a._resourceBlurHandler()},d=new EBG.Events.EventSubscription("focus",function(){a._resourceFocusHandler()},this);d.isElementEvent=!0;d.elementId=this._resObjId;EBG.eventMgr.subscribeToEvent(d);if(EBG.adaptor.browser.isIE()&&this.actualServingMode!=EBG.Adaptors.ServingMode.SCRIPT)d=new EBG.Events.EventSubscription("blur",c,this),d.isElementEvent=!0,d.elementId=this._resObjId,EBG.eventMgr.subscribeToEvent(d)},
updateResourceObjId:function(a){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"updateResourceObjId",[a]);EBG.adaptor._getVisibilityEventName()||this._subscribeToElementEvents()},_getInnerFrameTopLeft:function(a,c){var d={X:0,Y:0};try{if((this.adConfig.displayWin||EBG.adaptor.getDisplayWin())!=top&&c==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME&&a.frameElement)d=EBG.adaptor.getPositioningByElement(a.frameElement,!1,c)}catch(e){}return d},_getNestedInnerFrameTopLeft:function(a){var c=
{X:0,Y:0};try{var d=this.adConfig.displayWin||EBG.adaptor.getDisplayWin();if(a==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME){var e=this._getViewPortTopLeft();c.X+=e.X;for(c.Y+=e.Y;d!=top&&d.frameElement;){var f=d.frameElement.getBoundingClientRect();c.X+=f.left;c.Y+=f.top;d=d.parent}}}catch(g){}return c},_getViewPortTopLeft:function(){var a=!((this.adConfig.displayWin||EBG.adaptor.getDisplayWin())!=top&&this.adConfig.actualServingMode==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME);return EBG.adaptor.getScrollLeftTop(a,
this.adConfig.actualServingMode)},_pageVisibleHandler:function(){this._dispatchCheckVisibility(this._calculateVisibilityResult())},_pageHiddenHandler:function(){this._dispatchVisibilityHidden();this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&this._dispatchCheckVisibility({percentage:0,viewPort:this._getViewPortMetrics()})},_resourceFocusHandler:function(){this._focusOnResourceElem=!0;EBG.runTimed(this,function(){this._focusOnResourceElem=!1},[],60);this._pageFocusHandler()},_resourceBlurHandler:function(){EBG.runTimed(this,
function(){!this._justReceivedFocusOnPage&&!this._focusOnResourceElem&&this._pageBlurHandler()},[],30)},_pageFocusHandler:function(){this._justReceivedFocusOnPage=!0;EBG.runTimed(this,function(){this._justReceivedFocusOnPage=!1},[],60);this._dispatchCheckVisibility(this._calculateVisibilityResult())},_pageBlurHandler:function(){EBG.runTimed(this,function(){this._justReceivedFocusOnPage||this._pageHiddenHandler()},[],30)},_pageScrollHandler:function(){this._dispatchCheckVisibility(this._calculateVisibilityResult())},
_pageResizeHandler:function(){if(!this._resizeTimeOut){var a=this;this._resizeTimeOut=setTimeout(function(){a._resizeTimeOut=null;var c=a._calculateVisibilityResult();a._dispatchCheckVisibility(c)},100)}},_maxAdDurationHandler:function(){this._reachedMaxAdDuration=!0},start:function(){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"start");this._dispatchCheckVisibility(this._calculateVisibilityResult())},onElementMoved:function(){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,
this,"onElementMove");this._dispatchCheckVisibility(this._calculateVisibilityResult())},onChange:function(){this._dispatchCheckVisibility(this._calculateVisibilityResult())}};EBG.declareClass(EBG.RichModules.GeometricVisibilityProvider,EBG.RichModules.BasicVisibilityProvider);EBG.declareNamespace("RichModules");EBG.RichModules.SafeFrameVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.SafeFrameVisibilityProvider,this,[a,c]);this._initSafeFrameObject()};
EBG.RichModules.SafeFrameVisibilityProvider._isAvailable=function(){return!!EBG.adaptor.isSafeFrame()};
EBG.RichModules.SafeFrameVisibilityProvider.prototype={name:"SafeFrame",_safeFrameObj:null,_intervalHandler:null,_lastPercentage:null,_lastViewport:null,_initSafeFrameObject:function(){this._safeFrameObj=window.$sf&&$sf.ext},_calculateVisibilityPercentage:function(){try{return EBG.adaptor.isPageVisible()?this._safeFrameObj.inViewPercentage():0}catch(a){return 0}},_getViewPortRect:function(){var a=this._safeFrameObj.geom().win;return{w:parseInt(a.w),h:parseInt(a.h)}},_getViewPortMetrics:function(){var a=
this._getViewPortRect();return{Height:a.h,Width:a.w}},_isVisible:function(){return!!this._calculateVisibilityPercentage()},_checkVisibility:function(){var a=this._calculateVisibilityResult();if(this._lastPercentage!=a.percentage||!this._lastViewport||this._lastViewport.Height!=a.viewPort.Height||this._lastViewport.Width!=a.viewPort.Width)this._dispatchCheckVisibility(a),this._lastPercentage=a.percentage,this._lastViewport=a.viewPort},start:function(){EBG.callSuperFunction(EBG.RichModules.SafeFrameVisibilityProvider,
this,"start");EBG.setInterval(this,this._checkVisibility,[],EBG.RichModules.VisibilityManager.VisibilityCheckInterval)}};EBG.declareClass(EBG.RichModules.SafeFrameVisibilityProvider,EBG.RichModules.BasicVisibilityProvider);EBG.declareNamespace("RichModules");EBG.RichModules.AddingEyeProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.AddingEyeProvider,this,[a,c])};
EBG.RichModules.AddingEyeProvider._isAvailable=function(a){var c=!1,d=EBG.serverResponses[a.uid];!d.requiresIframeBust&&a.actualServingMode==EBG.Adaptors.ServingMode.IFRAME&&d.aiE.iflExists&&"Visibility"!=a.templateName&&(c=!0);return c};
EBG.RichModules.AddingEyeProvider.prototype={name:"AddingEye",shouldReportRecordable:function(){return!1},start:function(){EBG.runTimed(this,this._addVisibilityAd,[],50)},_addVisibilityAd:function(){var a=EBG.serverResponses[this.adConfig.uid],c=EBG.cloneObj(a);c.tn=c.adConfig.templateName="Visibility";c.ifrm=2;c.soi=0;c.adConfig.focused=EBG.adaptor.focused;window.ebOArr[ebOArr.length]=c;var d=ebSrc.replace(a.tn,c.tn),d=d.replace(/ex(debug|_api|)\.js/ig,".js"),a=document.createElement("SCRIPT");a.src=
d;c.ebSrc=d;(c=document.getElementById(c.phid))&&c.appendChild(a)}};EBG.declareClass(EBG.RichModules.AddingEyeProvider,EBG.RichModules.BasicVisibilityProvider);EBG.declareNamespace("RichModules");EBG.RichModules.FFVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.FFVisibilityProvider,this,[a,c])};
EBG.RichModules.FFVisibilityProvider._isAvailable=function(a){return(EBG.adaptor.browser.isFF()||EBG.adaptor.browser.isSafari()&&(8<=EBG.adaptor.browser.getVersion()||6<=EBG.adaptor.browser.getVersion()&&!EBG.adaptor.browser.isMac()))&&a.actualServingMode==EBG.Adaptors.ServingMode.IFRAME};
EBG.RichModules.FFVisibilityProvider.prototype={name:"FF",_focusOnResourceElem:null,_justReceivedFocusOnPage:null,_reachedMaxAdDuration:!1,_getInnerFrameTopLeft:function(){return EBG.adaptor.getIframePosition()},_getViewPortTopLeft:function(){var a=EBGInfra.callSuperFunction(EBG.RichModules.FFVisibilityProvider,this,"_getViewPortTopLeft");return{X:(this.adConfig.displayWin||EBG.adaptor.getDisplayWin()).screenX+a.X,Y:(this.adConfig.displayWin||EBG.adaptor.getDisplayWin()).screenY+a.Y}},_getViewPortMetrics:function(){var a=
this.adConfig.displayWin||EBG.adaptor.getDisplayWin(),c={Height:0,Width:0};if(EBG.isDefined(a.outerWidth)&&(0<a.outerWidth||0<a.outerHeight))c.Width=a.outerWidth,c.Height=a.outerHeight;else if(EBG.isDefined(a.screen.availWidth))c.Width=a.screen.availWidth,c.Height=a.screen.availHeight;EBG.isDefined(a.scrollMaxX)&&0<a.scrollMaxX&&EBG.isDefined(EBG.adaptor.scrollBarWidth)&&0<EBG.adaptor.scrollBarWidth&&(c.Height-=EBG.adaptor.scrollBarWidth);EBG.isDefined(a.scrollMaxY)&&0<a.scrollMaxY&&EBG.isDefined(EBG.adaptor.scrollBarHeight)&&
0<EBG.adaptor.scrollBarHeight&&(c.Width-=EBG.adaptor.scrollBarHeight);return c},_subscribeToEvents:function(){EBG.runTimed(this,this._visibilityPollingCheck,[],EBG.RichModules.VisibilityManager.VisibilityPollingTimer)},_visibilityPollingCheck:function(){this._reachedMaxAdDuration||(this._dispatchCheckVisibility(this._calculateVisibilityResult()),EBG.runTimed(this,this._visibilityPollingCheck,[],EBG.RichModules.VisibilityManager.VisibilityPollingTimer))}};
EBG.declareClass(EBG.RichModules.FFVisibilityProvider,EBG.RichModules.GeometricVisibilityProvider);EBG.declareNamespace("RichModules");EBG.RichModules.FlashVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.FlashVisibilityProvider,this,[a,c]);try{this.maxVisibilityArea=c.width*c.height,this.pixelContainer=this._writeFlashRenderPixels(),this._subscribeToEvents()}catch(d){}};
EBG.RichModules.FlashVisibilityProvider._isAvailable=function(a){return(EBG.adaptor.browser.isChrome()||EBG.adaptor.browser.isEdge()&&a.ffs.CFF_EdgeFlashProvider)&&EBG.adaptor.flash&&9<=EBG.adaptor.flash.version?!0:!1};
EBG.RichModules.FlashVisibilityProvider.prototype={name:"Flash",pixelContainerId:null,pixels:[],maxVisibilityArea:0,_calculationTimeOut:!1,_isReady:!1,_loadedPixelsCounter:0,pixelCountPerAxis:5,_calculateVisibilityPercentage:function(){if(!this._isReady)return-1;var a=0;this.maxVisibilityArea=(this.adConfig.width-2)*(this.adConfig.height-2);if(EBG.adaptor.isPageVisible()){for(var c=this.adConfig.height-2,d=this.adConfig.width-2,e=0,f=0,g=EBG.filterArray(this.pixels,function(a){return a.isVisible}),
h=0;h<g.length;h++)var i=g[h],d=Math.min(d,i.X),f=Math.max(f,i.X),c=Math.min(c,i.Y),e=Math.max(e,i.Y);c<e&&d<f&&(a=Math.round(100*((e-c)*(f-d)/this.maxVisibilityArea)))}return a},_calculateVisibilityPercentageByAlgorithem:function(a,c){return 100*(1-(a+(c-a*c)))},_getViewPortMetrics:function(){return null},getAxisHiddenAreaPercent:function(a,c){for(var d=0,e=0;e<this.pixels.length;e++)this.pixels[e].axis==a&&!this.pixels[e].isVisible&&(d+=c);return d/this.maxVisibilityArea},_handlePixelMessage:function(a){var c=
{};if(0<a.length)for(var a=a.split(","),d=["id","isVisible","axis"],e=0;e<a.length;e++){var f=a[e];c[d[e]]='"'==f.charAt(0)||"'"==f.charAt(0)||"false"==f||"true"==f?eval(f):f}for(e=0;e<this.pixels.length;e++)if(this.pixels[e].id==c.id){this.pixels[e].isVisible="1"===c.isVisible;if(!this.pixels[e].loaded)this.pixels[e].loaded=!0,this._loadedPixelsCounter++;this._triggerCalculation();break}},_writeFlashRenderPixels:function(){var a=EBG.adaptor.getPositioningById(this._resObjId,!0,this.adConfig.actualServingMode),
c=EBG.adaptor.generateElementId("VisibilityDiv",this.adConfig.uid),a={tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:c,dir:"ltr",style:{position:"absolute",width:EBG.px(this.adConfig.width),height:EBG.px(this.adConfig.height),top:EBG.px(a.Y),left:EBG.px(a.X),"z-index":-10}},children:this._createPixelsJson()};if("undefined"!=typeof this.adConfig.display)a.attributes.style.display=this.adConfig.display;EBG.adaptor.addInlineDOM(a,this.adConfig.placeHolderId);return EBG.adaptor.getElementById(c)},_createPixelsJson:function(){var a=
this._getPixelCordinates();if(!a||0==a.length)throw"could not get cordinates for creating render pixels";for(var c=[],d,e,f=0;f<a.length;f++)d=a[f],e=this._resObjId+"pixel"+d.X+":"+d.Y,c.push(this._buildRenderPixelJson(e,d.axis,d.X,d.Y)),this.pixels.push({id:e,axis:d.axis,X:d.X,Y:d.Y,isVisible:!1,loaded:!1});c.push(this._createScriptTag());return c},_createScriptTag:function(){var a="handlePixel_"+this.adConfig.uid,c=EBG.format("EBG.ads['{0}'].visibilityMgr._visibilityProvider._handlePixelMessage",
this.adConfig.uid),a=EBG.format("function {0}(args)",a),a=a+EBG.format("{ try{ if(!args||args=='null')args=''; return {0}(args);}catch(e){if(window.mmFSExceptionAlert)mmFSExceptionAlert('Command: '+command+'\\nargs: '+args.toString()+'\\n\\nexception in DoFS func:\\n'+e.message)}}",c);return{tagName:EBG.Adaptors.TagNames.SCRIPT,text:a}},_getPixelCordinates:function(){for(var a=[],c=(this.adConfig.width-2)/(this.pixelCountPerAxis-1),d=1,e=1;e<this.pixelCountPerAxis-1;e++)a.push({X:c*e+1,Y:1,axis:"X"}),
a.push({X:c*e+1,Y:this.adConfig.height-1,axis:"X"});c=(this.adConfig.height-2)/(this.pixelCountPerAxis-1);for(e=d=1;e<this.pixelCountPerAxis-1;e++)a.push({X:1,Y:c*e+1,axis:"Y"}),a.push({X:this.adConfig.width-1,Y:c*e+1,axis:"Y"}),d=Math.abs(d-this.adConfig.width);return a},_buildRenderPixelJson:function(a,c,d,e){a={play:"true",resId:this.adConfig.uid,resPath:this.adConfig.bigSDir+"/Res/Assets/Pixel"+EBG.flashPixelVer+"/pixel.swf",unique:0,wmode:"opaque",tagName:EBG.Adaptors.TagNames.OBJECT,attributes:{id:a,
dir:"ltr",name:a,style:{position:"absolute",textAlign:"left",width:"1px",height:"1px",left:EBG.px(d),top:EBG.px(e),"z-index":1E3},codebase:EBG.format("{0}download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#",EBG.protocol),version:EBG.format("{0},0,0,0",this.adConfig.flashVer)},params:{play:"true",wmode:"opaque",menu:"false",flashVars:"ebAdUID="+this.adConfig.uid+"&id="+a+"&axis="+c,allowScriptAccess:"always",allowFullScreen:"true"}};this._isSupportShockwave()?(a.attributes.type="application/x-shockwave-flash",
a.attributes.data=a.resPath):(a.attributes.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",a.params.movie=a.resPath);return a},_isSupportShockwave:function(){var a=!0;if(EBG.adaptor.browser.isIE()&&11>EBG.adaptor.browser.getVersion()||10<EBG.adaptor.browser.getVersion()&&9>(this.adConfig.displayWin||EBG.adaptor.getDisplayWin()).document.documentMode)a=!1;return a},_subscribeToEvents:function(){EBG.callSuperFunction(EBG.RichModules.BasicVisibilityProvider,this,"_subscribeToEvents");EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_RESIZE,
this._repositonPixels,this))},_repositonPixels:function(){var a=EBG.adaptor.getPositioningById(this._resObjId,!0,this.adConfig.actualServingMode);this.pixelContainer.style.top=EBG.px(a.Y);this.pixelContainer.style.left=EBG.px(a.X)},updateResourceObjId:function(a){EBG.callSuperFunction(EBG.RichModules.FlashVisibilityProvider,this,"updateResourceObjId",[a]);this._repositonPixels()},_triggerCalculation:function(){clearInterval(this._intervalHandler);if(this._checkPixelsLoaded()&&!this._calculationTimeOut){var a=
this;this._calculationTimeOut=setTimeout(function(){a._calculationTimeOut=null;var c=a._calculateVisibilityResult();a._dispatchCheckVisibility(c)},600)}},_checkPixelsLoaded:function(){if(!this._isReady)this._isReady=2*this.pixelCountPerAxis==this._loadedPixelsCounter;return this._isReady},start:function(){EBG.callSuperFunction(EBG.RichModules.FlashVisibilityProvider,this,"start");this._triggerCalculation()}};EBG.declareClass(EBG.RichModules.FlashVisibilityProvider,EBG.RichModules.BasicVisibilityProvider);
EBG.RichModules.MouseVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.MouseVisibilityProvider,this,[a,c]);try{this._subscribeToEvents();this._scrollWidth=EBG.adaptor.getScrollerWidth();var d=this.adConfig.displayWin||EBG.adaptor.getDisplayWin();this._screenResolution={width:d.screen.availWidth,height:d.screen.availHeight};this._screenOriginalResolution={width:d.screen.availWidth,height:d.screen.availHeight};if(!this._browserStateSupported())this._resolutionBaseScreenSize=
this._resolutionToScreenSize(this._screenResolution),this._resourceInitialPosition={top:d.screenTop,left:d.screenLeft};this._resourceFullSize=this.adConfig.width*this.adConfig.height;this._mouseMoveEventInvoker()}catch(e){}};EBG.RichModules.MouseVisibilityProvider._isAvailable=function(){var a=!1,c=EBG.adaptor.browser.getDocumentMode()||5;EBG.adaptor.browser.isIE()&&11>c&&11>EBG.adaptor.browser._browserVer&&(a=!0);return a};
EBG.RichModules.MouseVisibilityProvider.prototype={name:"Mouse",_isStarted:!1,_resObj:null,_lastViewPort:null,_resourceRect:null,_resourceFullSize:null,_screenResolution:null,_screenOriginalResolution:null,_screenInitialPosition:{top:0,left:0},_resolutionBaseScreenSize:null,_intervalId:null,_calculateVisibilityPercentage:function(){if(!this._isReady)return-1;var a=this._getViewPortRect(),c=this._resourceRect;if(!a||!c)return-1;var d=0;EBG.adaptor.isPageVisible()&&(d=100*(EBG.posHelper.calculateVisibleArea({X:a.left,
Y:a.top},{X:a.right,Y:a.bottom},{X:c.left,Y:c.top},{X:c.right,Y:c.bottom})/this._resourceFullSize));return d},_calcResourceRect:function(a){var c;if(8==EBG.adaptor.browser._browserVer&&8==EBG.adaptor.browser.getDocumentMode()){var d=(c=EBG.adaptor.getElementById(this._resObjId))&&c.getBoundingClientRect?c.getBoundingClientRect():{top:0,left:0};c=a.screenY-(a.clientY-d.top);a=a.screenX-(a.clientX-d.left)}else c=a.screenY-a.offsetY,a=a.screenX-a.offsetX;return{top:c,left:a,bottom:c+this.adConfig.height,
right:a+this.adConfig.width}},_getViewPortRect:function(){var a=null,c=this._getWindowRect();c&&(a={top:0>c.top?0:c.top,left:0>c.left?0:c.left,bottom:c.bottom>this._screenResolution.height?this._screenResolution.height:c.bottom,right:c.right>this._screenResolution.width?this._screenResolution.width:c.right});return a},_getWindowRect:function(){var a=null,c=this.adConfig.displayWin||EBG.adaptor.getDisplayWin();if(this._browserStateSupported())var a=this._isFullScreen(c),d=!a?6:0,e=c.screenX+d,f=c.screenY+
70,a={top:f,left:e,bottom:f+c.outerHeight-this._scrollWidth-(!a?70:0),right:e+c.outerWidth-this._scrollWidth+d};else this._resolutionBaseScreenSize&&(c=this._getUnsupportedWindowTopLeft(c),a={top:c.top,left:c.left,bottom:c.top+this._resolutionBaseScreenSize.height,right:c.left+this._resolutionBaseScreenSize.width});return a},_getUnsupportedWindowTopLeft:function(a){var c={top:this._screenInitialPosition.top,left:this._screenInitialPosition.left},d=0<a.screenLeft?a.screenLeft:0,e=d-this._resourceInitialPosition.left,
f=(0<e?this._screenOriginalResolution.width-this._resourceInitialPosition.left%this._screenOriginalResolution.width:this._resourceInitialPosition.left%this._screenOriginalResolution.width)+1,g=0;if(Math.abs(e)>f&&0<=d&&d<this._screenResolution.width)g=(1+Math.floor(Math.abs(Math.abs(e)-f)/this._screenOriginalResolution.width))*this._screenOriginalResolution.width,c.left=0>e?c.left-g:c.left+g;a=0<a.screenTop?a.screenTop:0;e=a-this._resourceInitialPosition.top;f=(0<e?this._screenOriginalResolution.height-
this._resourceInitialPosition.top%this._screenOriginalResolution.height:this._resourceInitialPosition.top%this._screenOriginalResolution.height)+1;if(Math.abs(e)>f&&0<=a&&a<this._screenResolution.height)g=(1+Math.floor(Math.abs(Math.abs(e)-f)/this._screenOriginalResolution.height))*this._screenOriginalResolution.height,c.top=0>e?c.top-g:c.top+g;return c},_isFullScreen:function(a){return!this._browserStateSupported()?!0:a.screenX+a.outerWidth==this._screenOriginalResolution.width},_getViewPortMetrics:function(){var a=
this._getViewPortRect();return a?{Width:a.right-a.left,Height:a.bottom-a.top}:null},_isVisible:function(){return!!this._calculateVisibilityPercentage()},_mouseMoveEventInvoker:function(){if((this._resObj=this._resObj?this._resObj:EBG.adaptor.getElementById(this._resObjId))&&this._resObj.parentNode&&this._resObj.parentNode.fireEvent){var a=this;this._resObj.parentNode.attachEvent("onmousemove",function(c){var d=a._calcResourceRect(c),e=a._getViewPortRect();if(!a._resourceRect)a._screenInitialPosition.left=
Math.floor(c.screenX/a._screenOriginalResolution.width)*a._screenOriginalResolution.width,a._screenInitialPosition.top=Math.floor((50<c.screenY?c.screenY-50:0)/a._screenOriginalResolution.height)*a._screenOriginalResolution.height;a._handleMultipleScreen(c);a._handleRecievedData(d,e)});this._intervalId=EBG.setInterval(this._resObj.parentNode,function(){this.fireEvent("onmousemove")},[],200)}else EBG.runTimed(this,this._mouseMoveEventInvoker,[],100)},_handleMultipleScreen:function(a){var c=this._getWindowRect();
if(c){if(a.screenY>this._screenOriginalResolution.height){var d=c.bottom>a.screenY?c.bottom:a.screenY;if(this._screenResolution.height<d)this._screenResolution.height=d}if(a.screenX>this._screenOriginalResolution.width&&(a=c.right>a.screenX?c.right:a.screenX,this._screenResolution.width<a))this._screenResolution.width=a}},_handleRecievedData:function(a,c){if(!this._resourceRect||this._checkRectanglesDifferent(this._resourceRect,a,1)||this._checkRectanglesDifferent(this._lastViewPort,c,1))this._resourceRect=
a,this._lastViewPort=c,this._triggerCalculation()},_checkRectanglesDifferent:function(a,c,d){for(var e in a)if(a.hasOwnProperty(e)&&Math.abs(a[e]-c[e])>d)return!0;return!1},_subscribeToEvents:function(){EBG.callSuperFunction(EBG.RichModules.BasicVisibilityProvider,this,"_subscribeToEvents")},_resolutionToScreenSize:function(a){var c={width:a.width,height:a.height};1680==a.width&&1050==a.height?c={width:1444,height:806}:1366==a.width&&768==a.height?c={width:1173,height:562}:1360==a.width&&768==a.height?
c={width:1167,height:562}:1280==a.width&&1024==a.height?c={width:1097,height:785}:1280==a.width&&960==a.height?c={width:1097,height:730}:1152==a.width&&864==a.height?c={width:985,height:645}:1024==a.width&&768==a.height?c={width:875,height:562}:800==a.width&&600==a.height&&(c={width:680,height:416});return c},_triggerCalculation:function(){if(this._isReady||this._isStarted&&this._resourceRect)this._isReady=!0,this._dispatchCheckVisibility(this._calculateVisibilityResult())},_browserStateSupported:function(){return 9<=
EBG.adaptor.browser._browserVer&&9<=EBG.adaptor.browser.getDocumentMode()},updateResourceObjId:function(a){this._resObj=null;this._intervalId&&EBG.clearInterval(this._intervalId);EBG.callSuperFunction(EBG.RichModules.MouseVisibilityProvider,this,"updateResourceObjId",[a]);this._mouseMoveEventInvoker()},start:function(){EBG.callSuperFunction(EBG.RichModules.MouseVisibilityProvider,this,"start");this._isStarted=!0;this._triggerCalculation()}};
EBG.declareClass(EBG.RichModules.MouseVisibilityProvider,EBG.RichModules.BasicVisibilityProvider);EBG.declareNamespace("RichModules");EBG.RichModules.MraidVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.MraidVisibilityProvider,this,[a,c])};EBG.RichModules.MraidVisibilityProvider._isAvailable=function(a){var c=a.actualServingMode==EBG.Adaptors.ServingMode.IFRAME;return a.ffs.CFF_MRAIDVis&&EBG.adaptor.isInApp()&&!c?(a.UiVz=!1,!0):!1};
EBG.RichModules.MraidVisibilityProvider.prototype={name:"Mraid",_calculateVisibilityPercentage:function(a){var a=a||{},c=this.adConfig.width,d=this.adConfig.height,c=a.width||c,d=a.height||d,e=a.offsetX||this.adConfig.offsetX,a=a.offsetY||this.adConfig.offsetY;Math.random();var f=0;if(!EBG.adaptor.isPageVisible())return 0;try{var g=0,h=0,i=EBG.adaptor.getCurrentPosition(),j={X:0,Y:0},k=this.calculateRightBottowCoordinate(j,i.width,i.height),i={X:0,Y:0};if(null!=i){"undefined"!=typeof e&&(i.X+=e);
"undefined"!=typeof a&&(i.Y+=a);var l=this.calculateRightBottowCoordinate(i,c,d),h=c*d,g=this.calculateVisibleArea(j,k,i,l),f=h?g/h:0}return 100*f}catch(m){return 0}},_getViewPortMetrics:function(){var a=EBG.adaptor.getScreenSize();return{Width:a.width,Height:a.height}}};EBG.declareClass(EBG.RichModules.MraidVisibilityProvider,EBG.RichModules.GeometricVisibilityProvider);
EBG.RichModules.GridVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.GridVisibilityProvider,this,[a,c]);try{this._subscribeToEvents(),this._visibilityDiv=this._writeVisibilityDiv(),this._setGridCoordinates(),this._gridIntervalHandler=EBG.setInterval(this,this._checkPercentageChanged,[],500)}catch(d){}};EBG.RichModules.GridVisibilityProvider._isAvailable=function(){var a=!1,c=EBG.adaptor.browser.getDocumentMode()||5;EBG.adaptor.browser.isIE()&&10<c&&(a=!0);return a};
EBG.RichModules.GridVisibilityProvider.prototype={name:"Grid",_isStarted:!1,_isReady:!1,_visibilityDiv:null,_gridIntervalHandler:null,_grid:[],_gridPointsCount:64,_lastCalculatedVisibility:null,_writeVisibilityDiv:function(){var a=EBG.adaptor.getPositioningById(this._resObjId,!0,this.adConfig.actualServingMode),c=EBG.adaptor.generateElementId("VisibilityDiv",this.adConfig.uid),a={tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:c,style:{position:"absolute",width:EBG.px(this.adConfig.width),height:EBG.px(this.adConfig.height),
top:EBG.px(a.Y),left:EBG.px(a.X),pointerEvents:"none"}},children:[]};EBG.adaptor.addInlineDOM(a,this.adConfig.placeHolderId);return EBG.adaptor.getElementById(c)},_setGridCoordinates:function(){for(var a=parseInt(this._visibilityDiv.style.left,10),c=parseInt(this._visibilityDiv.style.top,10),d=this._gridPointsCount/2,e=(this.adConfig.width-1)/(d-1),f=(this.adConfig.height-1)/(d-1),g=0;g<d;g++)this._grid.push({X:Math.floor(a+e*g),Y:Math.floor(c+f*g)}),this._grid.push({X:Math.floor(a+e*g),Y:Math.floor(c+
f*(d-1-g))})},_repositonDiv:function(){var a=EBG.adaptor.getPositioningById(this._resObjId,!0,this.adConfig.actualServingMode);this.pixelContainer.style.top=EBG.px(a.Y);this.pixelContainer.style.left=EBG.px(a.X)},_calculateVisibilityPercentage:function(){this._visibilityDiv.style.pointerEvents="auto";if(!EBG.adaptor.isPageVisible())return 0;for(var a=0,c=0;c<this._grid.length;c++)this._isPointVisible(this._grid[c])&&a++;this._visibilityDiv.style.pointerEvents="none";return 100*(a/this._gridPointsCount)},
_isPointVisible:function(a){return"outside"!=this._visibilityDiv.componentFromPoint(a.X,a.Y)},_checkPercentageChanged:function(){if(this._isStarted){var a=this._calculateVisibilityPercentage();a!=this._lastCalculatedPercentage&&this._triggerCalculation();this._lastCalculatedPercentage=a}},_getViewPortMetrics:function(){win=this.adConfig.displayWin||EBG.adaptor.getDisplayWin();return win.outerWidth&&win.outerWidth?{Width:win.outerWidth,Height:win.outerHeight}:null},_triggerCalculation:function(){this._isStarted&&
this._dispatchCheckVisibility(this._calculateVisibilityResult())},start:function(){EBG.callSuperFunction(EBG.RichModules.GridVisibilityProvider,this,"start");this._isStarted=!0;this._triggerCalculation()}};EBG.declareClass(EBG.RichModules.GridVisibilityProvider,EBG.RichModules.BasicVisibilityProvider);EBG.declareNamespace("RichModules");
EBG.RichModules.VisibilityManager=function(a,c,d){this._adConfig=this.adConfig=a;this._resObjId=c;this._res=EBG.adaptor.getElementById(c);this.actualServingMode=this.adConfig.actualServingMode;this._averageLastCalcTime=(new Date).getTime();this._isPanel=d;this._dpm=EBG.dataPipeMgr.getPipe(this.adConfig.sID);if(this._shouldInitialize())(this._visibilityProvider=this._getVisibilityProvider(this._resObjId,this.adConfig))?(this._dpm.send(EBG.DataProfile.VISIBILITY,{vsr:1,vsbp:this.getVisibilityProviderNum()}),
this._initializeVisibilityData(),this._subscribeToEvents(),this._visRecordable=!0,a=function(){this._reportVisibilityRecordable();this._visibilityProvider.start()},this.adConfig.adStarted?a.apply(this):(a=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,a,this),a.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(a))):this._dpm.send(EBG.DataProfile.VISIBILITY,{uvsr:3,vsbp:0})};EBG.RichModules.VisibilityManager.ThreholdType={IAB:0,Agency:1,Advertiser:2};
EBG.RichModules.VisibilityManager.VisibilityPollingTimer=1E3;EBG.RichModules.VisibilityManager.VisibilityCheckInterval=200;
EBG.RichModules.VisibilityManager.prototype={adConfig:null,_resObjId:null,_visibilityData:null,_visRecordable:!1,_lastVisPercentage:0,_lastVisViewPort:null,_averageVisibility:0,_averageScreenShare:0,_averageAdDuration:0,_averageLastCalcTime:null,_adCoveragePercentage:0,actualServingMode:EBG.Adaptors.ServingMode.SCRIPT,_visibilityProvider:null,_availableVisibilityProviders:[EBG.RichModules.GeometricVisibilityProvider,EBG.RichModules.SafeFrameVisibilityProvider,EBG.RichModules.MouseVisibilityProvider,
EBG.RichModules.GridVisibilityProvider,EBG.RichModules.FlashVisibilityProvider,EBG.RichModules.FFVisibilityProvider,EBG.RichModules.MraidVisibilityProvider],checkVisibility:function(a){EBG.isDefined(a)||(a={});if(!EBG.isDefined(a.percentage)||!EBG.isNumber(a.percentage))a.percentage=this.calculateVisibilityPercentage();if(EBG.isDefinedNotNull(a.percentage)&&0<=a.percentage){if(!("viewPort"in a))a.viewPort=this.getViewPortMetrics();if(this._adCoveragePercentage)a.percentage=Math.max(a.percentage-this._adCoveragePercentage,
0);this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&this._calculateAverages(a);for(var c in EBG.RichModules.VisibilityManager.ThreholdType)EBG.RichModules.VisibilityManager.ThreholdType.hasOwnProperty(c)&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[c]]&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[c]].isActive&&this._execCheckVisibility(a.percentage,EBG.RichModules.VisibilityManager.ThreholdType[c])}},updateResourceObjId:function(a){if(this._visibilityProvider&&
a)this._resObjId=a,this._res=EBG.adaptor.getElementById(a),this._visibilityProvider.updateResourceObjId(a)},_shouldInitialize:function(){var a=EBG.Initializer._getAdClass({tn:this.adConfig.templateName}),c=this.adConfig.visibility.mode==EBG.VisibilityMode.DEFAULT_MODE;return c||this.adConfig.actualServingMode==EBG.Adaptors.ServingMode.IFRAME&&!a.requiresIframeBust&&this.adConfig.UiVz&&(!this.adConfig.ffs.CFF_MRAIDVis||!EBG.adaptor.isInApp())?(c?this._dpm.send(EBG.DataProfile.VISIBILITY,{uvsr:1}):
this._dpm.send(EBG.DataProfile.VISIBILITY,{uvsr:2}),!1):!0},_getVisibilityProvider:function(a,c){for(var d=0;d<this._availableVisibilityProviders.length;d++)if(this._availableVisibilityProviders[d]&&this._availableVisibilityProviders[d]._isAvailable(c))return new this._availableVisibilityProviders[d](a,c);return null},calculateVisibilityPercentage:function(a,c,d,e,f,g,h){var i=0;EBG.adaptor.isPageVisible()?this._visibilityProvider&&(i=this._visibilityProvider._calculateVisibilityPercentage({resourceObjId:a,
width:c,height:d,offsetX:e,offsetY:f,isUIVZ:g,actualServingMode:h})):i=0;return i},isVisibile:function(a,c,d){var e=!1;if(EBG.adaptor.isPageVisible()&&this._visibilityProvider)try{e=!!this._visibilityProvider._isVisible({resourceObjId:a,width:c,height:d})}catch(f){}return e},getViewPortMetrics:function(){var a=null;this._visibilityProvider&&(a=this._visibilityProvider._getViewPortMetrics());return a},_subscribeToEvents:function(){try{var a=new EBG.Events.EventSubscription(EBG.Events.EventNames.VISIBILITY_CHECK,
this._visibilityCheckHandler,this);a.dispatcherFilters={"adConfig.rnd":this.adConfig.rnd};a.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.subscribeToEvent(a);if(this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE)a=new EBG.Events.EventSubscription(EBG.Events.EventNames.COLLECT_TIMERS,this._collectTimersHandler,this),a.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.subscribeToEvent(a);var c=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDDEN,this._stopTimersHandler,
this);c.isDocumentEvent=!0;EBG.eventMgr.subscribeToEvent(c);c=new EBG.Events.EventSubscription(EBG.Events.EventNames.VISIBILITY_HIDDEN,this._stopTimersHandler,this);EBG.eventMgr.subscribeToEvent(c);c=new EBG.Events.EventSubscription(this._isPanel?"P":""+EBG.Events.EventNames.AD_STACKING,this._adStackingHandler,this);c.dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd};EBG.eventMgr.subscribeToEvent(c);c=new EBG.Events.EventSubscription(EBG.Events.EventNames.EXPAND,function(a){(a.eventData==this.adConfig.panelName||
a.eventData.props&&a.eventData.props.asset.id==this._resObjId||a.eventData.props&&a.eventData.props.panel.id==this._resObjId)&&this.checkVisibility()},this);c.timing=EBG.Events.EventTiming.BEFORE;c.dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd};EBG.eventMgr.subscribeToEvent(c);c=new EBG.Events.EventSubscription(EBG.Events.EventNames.COLLAPSE,function(a){(a.eventData==this.adConfig.panelName||a.eventData.props&&a.eventData.props.asset.id==this._resObjId||a.eventData.props&&a.eventData.props.panel.id==
this._resObjId)&&this.stopMeasureVisibility()},this);c.timing=EBG.Events.EventTiming.BEFORE;c.dispatcherFilters={"_adConfig.rnd":this.adConfig.rnd};EBG.eventMgr.subscribeToEvent(c)}catch(d){}},_adStackingHandler:function(a){this._adCoveragePercentage=a.eventData.percentage;this.checkVisibility()},_visibilityCheckHandler:function(a){EBG.isDefined(a)&&EBG.isDefined(a.eventData)&&a.dispatcher===this._visibilityProvider&&this.checkVisibility(a.eventData)},_initializeVisibilityData:function(){this._visibilityData=
[];this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType.IAB]={minSurface:this.adConfig.visibility.iabMinSurface,minDuration:this.adConfig.visibility.iabMinDuration,minLargeSurface:this.adConfig.visibility.iabMinLargeSurface,minLargeDuration:this.adConfig.visibility.iabMinLargeDuration,visibilityInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_IAB),durationInteraction:null,isActive:this.adConfig.visibility.mode!=EBG.VisibilityMode.DEFAULT_MODE,durationNeeded:!1,
timeOutFlag:null,reported:!1};this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType.Agency]={minSurface:this.adConfig.visibility.agencyMinSurface,minDuration:this.adConfig.visibility.agencyMinDuration,visibilityInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AGENCY),durationInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION),isActive:this.adConfig.visibility.mode!=EBG.VisibilityMode.DEFAULT_MODE&&!!this.adConfig.visibility.agencyMinDuration,
durationNeeded:this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&!!this.adConfig.visibility.agencyMinDuration,timeOutFlag:null,reported:!1};this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType.Advertiser]={minSurface:this.adConfig.visibility.advertiserMinSurface,minDuration:this.adConfig.visibility.advertiserMinDuration,visibilityInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER),durationInteraction:this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION),
isActive:this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&!this._isPanel&&!!this.adConfig.visibility.advertiserMinDuration,durationNeeded:this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&!!this.adConfig.visibility.advertiserMinDuration,timeOutFlag:null,reported:!1}},_adjustPanelIntName:function(a){return this._isPanel?"P"+a:a},_isLargeBanner:function(){var a=EBG.adaptor.getBoundingClientRect(this._res,{clip:!0});return 242500<=a.width*a.height},_execCheckVisibility:function(a,
c){try{var d,e,f=this._visibilityData[c];f.minLargeSurface&&this._isLargeBanner()?(d=f.minLargeSurface,e=f.minLargeDuration):(d=f.minSurface,e=f.minDuration);a>=d?!f.reported&&!f.timeOutFlag?f.timeOutFlag=EBG.runTimed(this,function(){f.timeOutFlag=null;this._dpm.send(EBG.DataProfile.VISIBILITY,{vsiab:1});EBG.intMgr.handleCounterInteraction(f.visibilityInteraction,this.adConfig.uid);f.durationNeeded&&f.durationInteraction&&(EBG.intMgr.updateTimer(f.durationInteraction,this.adConfig.uid,e),EBG.intMgr.startTimer(f.durationInteraction,
this.adConfig.uid));f.reported=!0},[],1E3*e):f.reported&&f.durationNeeded&&f.durationInteraction&&EBG.intMgr.startTimer(f.durationInteraction,this.adConfig.uid):(this._dpm.send(EBG.DataProfile.VISIBILITY,{uvsiab:1}),this._stopDurationTimeout(c),f.durationInteraction&&this._stopDurationCounting(c))}catch(g){}},_stopDurationTimeout:function(a){if(this._visibilityData[a].timeOutFlag)clearTimeout(this._visibilityData[a].timeOutFlag),this._visibilityData[a].timeOutFlag=null},_stopDurationCounting:function(a){this._visibilityData[a].durationNeeded&&
this._visibilityData[a].durationInteraction&&EBG.intMgr.stopTimer(this._visibilityData[a].durationInteraction,this.adConfig.uid)},_reportVisibilityRecordable:function(){var a=this.adConfig.visibility.mode==EBG.VisibilityMode.BASIC_MODE||this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE;a&&this.adConfig.visibility.iabMinDuration&&(EBG.intMgr.handleCounterInteraction(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE),this.adConfig.uid),this._dpm.send(EBG.DataProfile.VISIBILITY,
{vsri:1}));a&&this.adConfig.visibility.agencyMinDuration&&EBG.intMgr.handleCounterInteraction(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE),this.adConfig.uid);this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&!this._isPanel&&this.adConfig.visibility.advertiserMinDuration&&EBG.intMgr.handleCounterInteraction(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE),this.adConfig.uid)},_collectTimersHandler:function(){EBG.intMgr.clearTimer(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE),
this.adConfig.uid);EBG.intMgr.clearTimer(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE),this.adConfig.uid);this._calculateAverages({percentage:this._lastVisPercentage,viewPort:this._visibilityProvider._getViewPortMetrics()});EBG.intMgr.updateTimer(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE),this.adConfig.uid,this._averageVisibility);EBG.intMgr.updateTimer(this._adjustPanelIntName(EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE),
this.adConfig.uid,this._averageScreenShare)},_stopTimersHandler:function(){for(var a in EBG.RichModules.VisibilityManager.ThreholdType)EBG.RichModules.VisibilityManager.ThreholdType.hasOwnProperty(a)&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[a]]&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[a]].isActive&&(this._stopDurationTimeout(EBG.RichModules.VisibilityManager.ThreholdType[a]),this._stopDurationCounting(EBG.RichModules.VisibilityManager.ThreholdType[a]))},
stopMeasureVisibility:function(){this._collectTimersHandler();this._stopTimersHandler()},getVisibilityProviderNum:function(){var a={None:0,Geometric:1,SafeFrame:2,Mouse:3,Grid:4,Flash:5,FF:6,Mraid:7,AddingEye:8,Basic:9};return this._visibilityProvider?a[this._visibilityProvider.name]||-1:a.None},_calculateAverages:function(a){var c=(new Date).getTime()-this._averageLastCalcTime;if(1E3<c&&0<this._lastVisPercentage){this._averageVisibility=(this._averageVisibility*this._averageAdDuration+this._lastVisPercentage*
c)/(this._averageAdDuration+c);if(this._lastVisViewPort&&this._lastVisViewPort.Width&&this._lastVisViewPort.Height){var d=this._lastVisViewPort.Width*this._lastVisViewPort.Height,e=this._res?EBG.adaptor.getBoundingClientRect(this._res,{clip:!0}):{width:this.adConfig.width,height:this.adConfig.height};this._averageScreenShare=(this._averageScreenShare*this._averageAdDuration+100*(this._lastVisPercentage*(e?e.width*e.height:0)/100/d)*c)/(this._averageAdDuration+c)}this._averageAdDuration+=c}this._lastVisPercentage=
a.percentage;this._lastVisViewPort=a.viewPort;this._averageLastCalcTime=(new Date).getTime()}};EBG.declareClass(EBG.RichModules.VisibilityManager,null);EBG.declareNamespace("RichModules");EBG.RichModules.Animator=function(a){this._adConfig=a};EBG.RichModules.Animator=function(){};
EBG.RichModules.Animator.prototype={_adaptiveProperties:"top,left,bottom,right,width,height,clip,opacity".split(","),_clipRegex:/rect\((.*?)px(.*?)px(.*?)px(.*?)px\)/g,_animatingElementsList:[],EasingFunctions:{linear:function(a){return a},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return a*(2-a)},easeInOutQuad:function(a){return 0.5>a?2*a*a:-1+(4-2*a)*a},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return--a*a*a+1},easeInOutCubic:function(a){return 0.5>a?4*a*a*a:
(a-1)*(2*a-2)*(2*a-2)+1},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return 1- --a*a*a*a},easeInOutQuart:function(a){return 0.5>a?8*a*a*a*a:1-8*--a*a*a*a},easeInQuint:function(a){return a*a*a*a*a},easeOutQuint:function(a){return 1+--a*a*a*a*a},easeInOutQuint:function(a){return 0.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}},animate:function(a,c,d,e){if(!(!a||!c||a.id&&~EBG.indexOfArray(this._animatingElementsList,a.id))){var f=Date.now(),g=c.duration||1E3,h=c.easing?EBG.isFunc(c.easing)?
c.easing:this.EasingFunctions[c.easing]||this.EasingFunctions.linear:this.EasingFunctions.linear,i=this,j=c.fps||48,k=this._getOriginalValues(a),c=this._adaptProperties(k,c),l=new EBG.Events.Event(EBG.Events.EventNames.ANIMATION);l.dispatcher=this;l.eventData={element:a,elementId:a.id,style:k,finished:!1};l.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(l)||(this._animatingElementsList.push(a.id),function(){var m=(Date.now()-f)/g,o={},m=Math.min(m,1),n;for(n in c)o[n]=i._recalculateProperyValue(n,
c[n],k[n],h(m)),a.style[n]=i._adjustStyle(n,o[n]);EBG.mergeObj(k,o,!1);l.eventData={element:a,elementId:a.id,style:o,finished:1===m};l.timing=EBG.Events.EventTiming.ONTIME;if(!EBG.eventMgr.dispatchEvent(l))1>m?setTimeout(arguments.callee,1E3/j):(l.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.dispatchEvent(l),m=EBG.indexOfArray(i._animatingElementsList,a.id),~m&&i._animatingElementsList.splice(m,1),d&&d.apply(e||i,[a,o]))}())}},_adjustStyle:function(a,c){return-1!=="topleftbottomrightwidthheight".indexOf(a)?
c+"px":c},_isRectCSS:function(a){this._clipRegex.lastIndex=0;return this._clipRegex.test(a)},_getRectCSSValues:function(a){this._clipRegex.lastIndex=0;return this._clipRegex.exec(a)},_getOriginalValues:function(a){var c=EBG.adaptor.getBoundingClientRect(a,{clip:!1}),a=EBG.adaptor.getComputedStyle(a),d=window.scrollY||document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0,e=window.scrollX||document.documentElement&&document.documentElement.scrollLeft||
document.body&&document.body.scrollLeft||0;c.top=d+c.top;c.left=e+c.left;c.bottom=d+c.bottom;c.right=e+c.right;d=a.getPropertyValue("clip");c.clip=this._isRectCSS(d)?d:"rect(0px,"+c.width+"px,"+c.height+"px,0px)";c.opacity=1*(a.getPropertyValue("opacity")||1);return c},_recalculateProperyValue:function(a,c,d,e){switch(a){case "clip":return b=function(a,c,d){return""+(1*a.trim().replace(",","")+1*c.trim().replace(",","")*d)},orignalClip=this._getRectCSSValues(d),clip=this._getRectCSSValues(c),"rect("+
b(orignalClip[1],clip[1],e)+"px,"+b(orignalClip[2],clip[2],e)+"px,"+b(orignalClip[3],clip[3],e)+"px,"+b(orignalClip[4],clip[4],e)+"px)";default:return d+c*e}},_adaptProperties:function(a,c){res={};for(var d=EBG.filterArray(this._adaptiveProperties,function(a){return EBG.isDefined(c[a])}),e=0;e<d.length;e++){var f=d[e],g=c[f];if("clip"===f){var h=function(a){return 1*a.trim().replace(",","")},i=this._getRectCSSValues(a[f]),g=this._isRectCSS(g)?this._getRectCSSValues(g):this._getRectCSSValues("rect(0px,"+
a.width+"px,"+a.height+"px,0px)");res[f]="rect("+(h(g[1])-h(i[1]))+"px,"+(""+(h(g[2])-h(i[2])))+"px,"+(""+(h(g[3])-h(i[3])))+"px,"+(""+(h(g[4])-h(i[4])))+"px)"}else"string"===EBG.typeOf(g)?1<g.length&&"="==g.charAt(1)?res[f]=g.substr(2).replace(/[^\d\.\-]/g,"")*("+"===g.charAt(0)?1:-1):(g=1*g.replace(/[^\d\.\-]/g,""),res[f]=g-a[f]):res[f]=g-a[f]}return res},isAnimating:function(a){return!!~EBG.indexOfArray(this._animatingElementsList,a)}};EBG.declareNamespace("RichModules");
EBG.RichModules.AdStackingDetector=function(a,c){this._adConfig=a;this._isFriendlyIframe=this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME||this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME&&window.frameElement;this._isPanel=c;if(this._shouldInitialize())if(this._validElementParents.push(a.placeHolderId),EBG.Const.OUTER_DIV&&this._validElementParents.push(EBG.Const.OUTER_DIV),this._adConfig.adStarted)this._start();else{var d=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,
function(){this._start()},this);d.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.subscribeToEvent(d)}};
EBG.RichModules.AdStackingDetector.prototype={_interactionThreshold:100,_analyzeInterval:200,_validElementParents:[],_elementsIds:[],_densityFactor:5,_prevPercentage:0,_generatePointsGrid:function(a){for(var c=[],d=(a.height-2)/this._densityFactor,a=(a.width-2)/this._densityFactor,e=0;e<=this._densityFactor;e++)for(var f=0;f<=this._densityFactor;f++)c.push({x:Math.round(a*e),y:Math.round(d*f)});return c},_shouldInitialize:function(){if(this._adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&
this._adConfig.actualServingMode!=EBG.Adaptors.ServingMode.IFRAME)return this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME&&window.parent!==top?!1:!0},_start:function(){EBG.setInterval(this,this._analyze,[],this._analyzeInterval)},_analyze:function(){var a=this._calculateConcealmentPercentage();if(a!=this._prevPercentage){this._prevPercentage=a;var c=new EBG.Events.Event(this._isPanel?"P":""+EBG.Events.EventNames.AD_STACKING);c.eventData={intName:(this._isPanel?"P":"")+EBG.Interactions.SystemInts.AD_STACKING,
percentage:a};c.dispatcher=this;c.timing=EBG.Events.EventTiming.BEFORE;if(!EBG.eventMgr.dispatchEvent(c))a>=this._interactionThreshold&&EBG.intMgr.handleCounterInteraction((this._isPanel?"P":"")+EBG.Interactions.SystemInts.AD_STACKING,this._adConfig.uid),c.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(c)}},_calculateConcealmentPercentage:function(){try{if(!this._elementsIds.length)return 0;var a=EBG.adaptor.serving._getTopFriendlyIframe(this._adConfig.displayWin||EBG.adaptor.getDisplayWin()),
c=this._getBasePosition();if(!c||0==c.width||0==c.height)return 0;this._grid=this._generatePointsGrid(c);for(var d=0,e=0;e<this._grid.length;e++){var f=this._grid[e],g=a.document.elementFromPoint(Math.floor(c.left)+f.x+1,Math.floor(c.top)+f.y+1);if(g&&(!g.id||-1==EBG.indexOfArray(this._elementsIds,g.id)))(!this._isFriendlyIframe||g!=window.frameElement)&&!this._hasValidParent(g)&&!this._isElementTransparent(g)&&d++}return Math.round(100*(d/this._grid.length))}catch(h){return 0}},_getBasePosition:function(){var a=
null;try{var c=EBG.Initializer._getAdClass({tn:this._adConfig.templateName});if(this._isFriendlyIframe&&!c.requiresIframeBust)a=window.frameElement.getBoundingClientRect();else{var d=EBG.adaptor.getElementById(this._assetId);d&&(a=EBG.adaptor.getBoundingClientRect(d,{clip:!0}))}}catch(e){}return a},addElementId:function(a,c){if(-1==EBGInfra.indexOfArray(this._elementsIds,a)&&(this._elementsIds.push(a),c))this._assetId=a},_invisibleProperties:{visibility:"hidden",display:"none",opacity:function(a){return 0==
1*a},"-moz-opacity":function(a){return EBG.adaptor.browser.isFF()&&0==1*a},"-khtml-opacity":function(a){return EBG.adaptor.browser.isSafari()&&0==1*a},filter:function(a){return EBG.adaptor.browser.isIE()&&10>EBG.adaptor.browser.getVersion()&&-1!=EBG.indexOfArray(["alpha(opacity=0)","progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"],a)},"background-color":function(a,c,d){var e=function(a){var c=a.replace(/^\s+|\s+$/g,"").match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);return c&&
0==1*c[4]||"transparent"==a},f=c.innerText||c.textContent,g=EBG.adaptor.browser.isIE()&&9>EBG.adaptor.browser.getVersion(),d=d.getPropertyValue("color");return e(a)&&-1==EBG.indexOfArray("object,canvas,video,source,track,iframe,embed,img".split(","),c.tagName.toLowerCase())&&(!f||!g&&e(d))}},_isElementTransparent:function(a){var c=EBG.adaptor.getComputedStyle(a),d=this._invisibleProperties,e,f;for(f in d){var g=c.getPropertyValue(f);if(g)for(var h=EBG.isArray(d[f])?d[f]:[d[f]],i=0;i<h.length;i++)if(e=
EBG.isFunc(h[i])?h[i](g,a,c):g==h[i])return!0}return!1},_hasValidParent:function(a){if(!a)return!1;for(var c=a.id;a.parentElement;){if(a.parentElement.id&&-1!=EBG.indexOfArray(this._validElementParents,a.parentElement.id))return this.addElementId(c,!1),!0;a=a.parentElement}return!1}};EBG.declareClass(EBG.RichModules.AdStackingDetector,null);EBG.Interactions.DwellTimeManager=function(a){this._adConfig=a;this._defaultPanelName=this._adConfig.panelName};
EBG.Interactions.DwellTimeManager.prototype={_state:{idle:0,start:1,stop:2,panelOpenMouseOver:3,videoPlay:4,videoPlayMouseOut:5,panelOpenMouseOut:6,idlePanelOpen:7,idleVideoPlay:8},_idleTimeLimit:700,_curState:0,_numOfOpenPanels:0,_isMouseOverAd:!1,_wasMouseOverAd:!1,_isUserInteractionOccur:!1,_isVideoPlay:!1,_isVideoAutoReplay:!1,_mouseTimeoutId:0,_autoShownPanels:[],_videosToTrack:[],_defaultMovieNum:1,_dwellUniqueNeedsToBeReported:!0,init:function(){this._subscribeToEvents()},_subscribeToAdEvent:function(a,
c,d){a=new EBG.Events.EventSubscription(a,c,this);if(d)a.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd};EBG.eventMgr.subscribeToEvent(a)},_subscribeToEvents:function(){this._subscribeToAdEvent(EBG.Events.EventNames.MOUSE_OVER,this._handleMouseOverAd,!0);this._subscribeToAdEvent(EBG.Events.EventNames.MOUSE_OUT,this._handleMouseOutOfAd,!0);this._subscribeToAdEvent(EBG.Events.EventNames.DWELL_VIDEO_START,this._handleVideoPlay,!0);this._subscribeToAdEvent(EBG.Events.EventNames.DWELL_VIDEO_STOP,
this._handleVideoStop,!0);this._subscribeToAdEvent(EBG.Events.EventNames.USER_INTERACTION,this._handleUserInteraction,!0);this._subscribeToAdEvent(EBG.Events.EventNames.EXPAND,this._handlePanelOpen,!0);this._subscribeToAdEvent(EBG.Events.EventNames.COLLAPSE,this._handlePanelClose,!0);this._subscribeToAdEvent(EBG.Events.EventNames.FULL_SCREEN_START,this._handlePanelOpen,!0);this._subscribeToAdEvent(EBG.Events.EventNames.FULL_SCREEN_END,this._handlePanelClose,!0)},_handleMouseThreshold:function(){this._mouseTimeoutId=
null;EBG.intMgr.updateTimer(EBG.Interactions.SystemInts.DWELL_TIME,this._adConfig.uid,this._idleTimeLimit/1E3);switch(this._curState){case this._state.idle:this._isMouseOverAd?this._start():this._stop();break;case this._state.idleVideoPlay:this._isMouseOverAd?this._videoPlay():this._videoPlayMouseOut();break;case this._state.idlePanelOpen:this._isMouseOverAd?this._panelOpenMouseOver():this._panelOpenMouseOut()}},_handleUserInteraction:function(){if(this._wasMouseOverAd)switch(this._isUserInteractionOccur=
!0,this._curState){case this._state.idle:this._start();break;case this._state.idleVideoPlay:this._videoPlay();break;case this._state.idlePanelOpen:this._panelOpenMouseOver()}},_handleVideoPlay:function(a){a=a.eventData.assetId||this._defaultMovieNum;if(this._isMouseOverAd)switch(this._videosToTrack.push(a),this._isVideoPlay=!0,this._reportUserInitatedVideo(a),this._curState){case this._state.idle:this._idleVideoPlay();break;case this._state.idlePanelOpen:break;case this._state.idleVideoPlay:break;
case this._state.start:this._videoPlay();this._reportUserInitatedVideo(a);break;case this._state.stop:this._isVideoAutoReplay||(this._videoPlayMouseOut(),this._reportUserInitatedVideo(a));break;case this._state.videoPlayMouseOut:this._stop();this._isVideoAutoReplay=!0;break;default:this._isVideoAutoReplay||this._reportUserInitatedVideo(a)}},_handleVideoStop:function(a){a=EBGInfra.indexOfArray(this._videosToTrack,a.eventData.assetId);if(-1!==a&&(this._videosToTrack.splice(a,1),!(0<this._videosToTrack.length)))switch(this._isVideoPlay=
this._isVideoAutoReplay=!1,this._curState){case this._state.videoPlay:this._isMouseOverAd?0<this._numOfOpenPanels?this._panelOpenMouseOver():this._start():0<this._numOfOpenPanels?this._panelOpenMouseOut():this._stop();break;case this._state.videoPlayMouseOut:0<this._numOfOpenPanels?this._panelOpenMouseOut():this._stop();break;case this._state.idleVideoPlay:this._idle()}},_handleMouseOverAd:function(){this._wasMouseOverAd=this._isMouseOverAd=!0;this._isVideoAutoReplay=!1;this._checkRecentAutoPanelOpen();
switch(this._curState){case this._state.idle:case this._state.idlePanelOpen:case this._state.idleVideoPlay:this._startMouseTimer();break;case this._state.stop:this._isVideoPlay?this._videoPlay():this._start();break;case this._state.panelOpenMouseOut:this._panelOpenMouseOver();break;case this._state.videoPlayMouseOut:this._videoPlay()}},_checkRecentAutoPanelOpen:function(){if(this._curState==this._state.idle)for(var a=(new Date).getTime(),c=this._autoShownPanels.length-1;0<=c;c--){var d=this._autoShownPanels[c];
300>=a-d.showtime&&(this._autoShownPanels.splice(c,1),this.handlePanelOpen(d.name))}},_handleMouseOutOfAd:function(){this._isMouseOverAd=!1;switch(this._curState){case this._state.idle:case this._state.idleVideoPlay:case this._state.idlePanelOpen:this._clearMouseTimer();break;case this._state.start:this._stop();break;case this._state.videoPlay:this._videoPlayMouseOut();break;case this._state.panelOpenMouseOver:this._panelOpenMouseOut()}},_handlePanelOpen:function(a){var c=a.eventData.props&&a.eventData.props.panel.name||
this._defaultPanelName;if(!this._wasMouseOverAd||a.dispatcher.expandedBy==EBG.ActionType.AUTO)this._onAutoShowPanel(c);else switch(this._numOfOpenPanels++,this._curState){case this._state.start:this._panelOpenMouseOver();break;case this._state.stop:this._panelOpenMouseOut();break;case this._state.idle:this._idlePanelOpen();break;case this._state.videoPlay:this._panelOpenMouseOver()}},_onAutoShowPanel:function(a){this._addAutoShownPanel({name:a||this._defaultPanelName,showtime:(new Date).getTime()})},
_addAutoShownPanel:function(a){0<=this._getAutoShownPanelIdx(a.name)||(this._autoShownPanels[this._autoShownPanels.length]=a)},_getAutoShownPanelIdx:function(a){for(var a=a||this._defaultPanelName,c=-1,d=0;d<this._autoShownPanels.length;d++)if(this._autoShownPanels[d].name==a){c=d;break}return c},_handlePanelClose:function(a){var c="",c="FullScreen"==a.eventData?a.eventData:a.eventData.props&&a.eventData.props.panel?a.eventData.props.panel.name:this._defaultPanelName,a=this._getAutoShownPanelIdx(c);
if(0<=a)this._autoShownPanels.splice(a,1);else{this._numOfOpenPanels--;if(0>this._numOfOpenPanels)this._numOfOpenPanels=0;if(0==this._numOfOpenPanels)switch(this._curState){case this._state.panelOpenMouseOver:this._isVideoPlay?this._videoPlay():this._start();break;case this._state.panelOpenMouseOut:this._isVideoPlay?this._videoPlayMouseOut():this._stop();break;case this._state.idlePanelOpen:this._idle()}}},_startMouseTimer:function(){if(!this._mouseTimeoutId){var a=this;this._mouseTimeoutId=setTimeout(function(){a._handleMouseThreshold()},
this._idleTimeLimit)}},_clearMouseTimer:function(){clearTimeout(this._mouseTimeoutId);this._mouseTimeoutId=null},_isIdleMode:function(){return this._curState==this._state.idle||this._curState==this._state.idlePanelOpen||this._curState==this._state.idleVideoPlay},_idle:function(){if(this._isIdleMode())this._curState=this._state.idle},_start:function(){this._curState=this._state.start;this._startTimer()},_stop:function(){this._curState=this._state.stop;this._endTimer()},_idlePanelOpen:function(){if(this._isIdleMode())this._curState=
this._state.idlePanelOpen},_panelOpenMouseOver:function(){this._curState=this._state.panelOpenMouseOver;this._startTimer()},_videoPlay:function(){this._curState=this._state.videoPlay;this._startTimer()},_videoPlayMouseOut:function(){this._curState=this._state.videoPlayMouseOut;this._startTimer()},_panelOpenMouseOut:function(){this._curState=this._state.panelOpenMouseOut;this._startTimer()},_idleVideoPlay:function(){if(this._isIdleMode())this._curState=this._state.idleVideoPlay},_reportUserInitatedVideo:function(a){var c=
new EBG.Events.Event(EBG.Events.EventNames.USER_INITIATED_VIDEO);c.dispatcher=this;c.eventData={assetId:a};EBG.eventMgr.dispatchEvent(c)},_isTimeOverLimit:function(){return this._isTimerStarted()?(this._endTimer(),EBG.intMgr.getTimerValue(EBG.Interactions.SystemInts.DWELL_TIME,this._adConfig.uid)>this._idleTimeLimit/1E3):!1},_isTimerStarted:function(){return EBG.intMgr.isTimerRunning(EBG.Interactions.SystemInts.DWELL_TIME,this._adConfig.uid)},_resetTimer:function(){EBG.intMgr.updateTimer(EBG.Interactions.SystemInts.DWELL_TIME,
this._adConfig.uid,0)},_startTimer:function(){var a=new EBG.Events.Event(EBG.Events.EventNames.DWELL_UNIQUE);a.dispatcher=this;a.eventData={firstTime:this._dwellUniqueNeedsToBeReported,adUId:this._adConfig.uid};EBG.eventMgr.dispatchEvent(a);this._dwellUniqueNeedsToBeReported=!1;EBG.intMgr.startTimer(EBG.Interactions.SystemInts.DWELL_TIME,this._adConfig.uid)},_endTimer:function(){EBG.intMgr.stopTimer(EBG.Interactions.SystemInts.DWELL_TIME,this._adConfig.uid)}};EBG.declareNamespace("AdChoice");
EBG.AdChoice.AdChoiceManager=function(a){this._adConfig=a;this._active=a.adChoice.includeMarker;this._iconAdded=!1};EBG.AdChoice.AdChoiceManager.ImageData=function(){this.iconSrc="";this.id=""};
EBG.AdChoice.AdChoiceManager.IabIconData={en:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/uk/"},"de-at":{icon:"OBA_AUSTRIA.png",url:"http://www.youronlinechoices.com/at/"},"fr-be":{icon:"OBA_BELGIUM_FR.png",url:"http://www.youronlinechoices.com/be-fr/"},"nl-be":{icon:"OBA_BELGIUM_NL.png",url:"http://www.youronlinechoices.com/be-nl/"},bg:{icon:"OBA_BULGARIA.png",url:"http://www.youronlinechoices.com/bg/"},cs:{icon:"OBA_CZECH.png",url:"http://www.youronlinechoices.com/cs/"},da:{icon:"OBA_DENMARK.png",
url:"http://www.youronlinechoices.com/den/"},fi:{icon:"OBA_FINLAND.png",url:"http://www.youronlinechoices.com/fi/"},fr:{icon:"OBA_FRANCE.png",url:"http://www.youronlinechoices.com/fr/"},de:{icon:"OBA_GERMANY.png",url:"http://www.youronlinechoices.com/de/"},el:{icon:"OBA_GREEK.png",url:"http://www.youronlinechoices.com/gr/"},hu:{icon:"OBA_HUNGARY.png",url:"http://www.youronlinechoices.com/hu/"},"en-ie":{icon:"OBA_IRELAND.png",url:"http://www.youronlinechoices.com/ie/"},it:{icon:"OBA_ITALY.png",url:"http://www.youronlinechoices.com/it/"},
nl:{icon:"OBA_NETHERLANDS.png",url:"http://www.youronlinechoices.com/nl/"},no:{icon:"OBA_NORWAY.png",url:"http://www.youronlinechoices.com/nor/"},pl:{icon:"OBA_POLAND.png",url:"http://www.youronlinechoices.com/pl/"},ro:{icon:"OBA_ROMANIA.png",url:"http://www.youronlinechoices.com/ro/"},sl:{icon:"OBA_SLOVAKIA.png",url:"http://www.youronlinechoices.com/sl/"},es:{icon:"OBA_SPAIN.png",url:"http://www.youronlinechoices.com/es/"},sv:{icon:"OBA_SWEDEN.png",url:"http://www.youronlinechoices.com/se/"},"de-ch":{icon:"OBA_SWITZERLAND_DE.png",
url:"http://www.youronlinechoices.com/ch-de/"},"fr-ch":{icon:"OBA_SWITZERLAND_FR.png",url:"http://www.youronlinechoices.com/ch-fr/"},"it-ch":{icon:"OBA_SWITZERLAND_IT.png",url:"http://www.youronlinechoices.com/ch-it/"},"en-gb":{icon:"OBA_UK.png",url:"http://www.youronlinechoices.com/uk/"},hr:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/hr/"},is:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/is/"},lt:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/lt/"},
lv:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/lv/"},pt:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/pt/"},sk:{icon:"OBA_DEFAULT.png",url:"http://www.youronlinechoices.com/sk/"}};EBG.AdChoice.AdChoiceManager.NaiIconData={en:{icon:"OBA_DEFAULT.png",url:"http://www.aboutads.info/consumers"}};EBG.AdChoice.AdChoiceManager.IabClosedIconName="OBA.png";EBG.AdChoice.AdChoiceManager.NaiClosedIconName="OBA.png";
EBG.AdChoice.AdChoiceManager.VisibilityState={HIDDEN:"hidden",VISIBLE:"visible"};EBG.AdChoice.AdChoiceManager.Position={ABSOLUTE:"absolute",RELATIVE:"relative"};EBG.AdChoice.AdChoiceManager.ImageLoadTimeout=100;EBG.AdChoice.AdChoiceManager.DefaultOffset=-1E3;
EBG.AdChoice.AdChoiceManager.prototype={_imgData:null,_imgExpData:null,_iconLocalData:null,_acCloseIconName:null,_spanId:null,_iconsBaseUrl:null,_containerId:null,_assetObjId:null,init:function(){if(this._active){this._iconsBaseUrl=this._getIconsDir(this._adConfig.adChoice.iconPosition);var a=new EBG.Events.EventSubscription(EBG.Events.EventNames.ADD_CREATIVES,this._handleAdChoice,this);a.timing=EBG.Events.EventTiming.AFTER;a.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd};EBG.eventMgr.subscribeToEvent(a);
a=new EBG.Events.EventSubscription(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE,this._handleAdChoice,this);a.timing=EBG.Events.EventTiming.AFTER;a.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd};EBG.eventMgr.subscribeToEvent(a);a=new EBG.Events.EventSubscription(EBG.Events.EventNames.ADD_BANNER_DEFAULT_FLASH_CREATIVE,this._handleAdChoice,this);a.timing=EBG.Events.EventTiming.AFTER;a.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd};EBG.eventMgr.subscribeToEvent(a);EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_RESIZE,
this._pageResizeHandler,this));this._adConfig.adChoice.certificationProgram==EBG.AcCertProgram.NAI_US?(this._iconLocalData=this._getIconDataByLanguage(EBG.AdChoice.AdChoiceManager.NaiIconData),this._acCloseIconName=EBG.AdChoice.AdChoiceManager.NaiClosedIconName):(this._iconLocalData=this._getIconDataByLanguage(EBG.AdChoice.AdChoiceManager.IabIconData),this._acCloseIconName=EBG.AdChoice.AdChoiceManager.IabClosedIconName)}},_handleAdChoice:function(a){if(a.eventData&&!a.eventData.isPanel)this._assetObjId=
a.eventData.assetId;if(this._iconAdded){var a=EBG.adaptor.getElementById(this._containerId),c=EBG.adaptor.getElementById(this._spanId);EBG.adaptor.removeElement(c);EBG.adaptor.appendChildElement(a.id,c)}else this._iconAdded=!0,this._containerId=this._adConfig.placeHolderId,this._imgData=this._getImageData(),this._imgExpData=this._getExpImageData(),this._addAdChoiceIcons(this._imgData,this._imgExpData,this._getAdChoiceUrl()),this._subscribeIconToEvents(this._imgData.id,this._imgExpData.id)},_getImageData:function(){var a=
new EBG.AdChoice.AdChoiceManager.ImageData;a.iconSrc=this._iconsBaseUrl+this._acCloseIconName;a.id="acImage_"+this._adConfig.uid;return a},_getExpImageData:function(){var a=new EBG.AdChoice.AdChoiceManager.ImageData;a.iconSrc=this._iconsBaseUrl+this._iconLocalData.icon;a.id="acExpImage_"+this._adConfig.uid;return a},_getAdChoiceUrl:function(){var a="";return a=this._adConfig.adChoice.customUrl?unescape(this._adConfig.adChoice.customUrl):this._iconLocalData.url},_getIconDataByLanguage:function(a){var c=
EBG.adaptor.getBrowserLanguage().toLowerCase(),d=a[c];d||(c=c.split("-")[0],d=a[c]);d||(d=a.en);return d},_getIconOffsets:function(a,c,d,e,f,g){var h={offsetLeft:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset),offsetTop:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset)};if(this._assetObjId&&(adPos=EBG.adaptor.getPositioningById(this._assetObjId,!0,this._adConfig.actualServingMode))){if(!f||!g)var i=EBG.adaptor.getElementById(this._assetObjId),i=EBG.adaptor.getBoundingClientRect(i),f=f?f:i.width,
g=g?g:i.height;acPos=EBG.adaptor.getPositioningById(a,!0,this._adConfig.actualServingMode);i=EBG.adaptor.getStyleOfElem(EBG.adaptor.getElementById(a));a=parseInt(i.left)+adPos.X-acPos.X;i=parseInt(i.top)+adPos.Y-acPos.Y;switch(c){case EBG.AcIconPosition.BottomLeft:h.offsetLeft=EBG.px(a);h.offsetTop=EBG.px(i+g-e);break;case EBG.AcIconPosition.BottomRight:h.offsetLeft=EBG.px(a+f-d);h.offsetTop=EBG.px(i+g-e);break;case EBG.AcIconPosition.TopLeft:h.offsetLeft=EBG.px(a);h.offsetTop=EBG.px(i);break;case EBG.AcIconPosition.TopRight:h.offsetLeft=
EBG.px(a+f-d),h.offsetTop=EBG.px(i)}}return h},_getIconsDir:function(a){var c=this._adConfig.imagesDir+"/AdChoice/";switch(a){case EBG.AcIconPosition.BottomLeft:c+="BottomLeft/";break;case EBG.AcIconPosition.BottomRight:c+="BottomRight/";break;case EBG.AcIconPosition.TopLeft:c+="TopLeft/";break;case EBG.AcIconPosition.TopRight:c+="TopRight/"}return c},_addAdChoiceIcons:function(a,c,d){var e="acImgLinkWrapper_"+this._adConfig.uid;this._spanId="acSpan_"+this._adConfig.uid;var f=EBG.adaptor.getElementById(this._containerId);
if(f&&(d={tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:this._spanId,style:{position:EBG.AdChoice.AdChoiceManager.Position.ABSOLUTE,zIndex:EBG.adaptor.getMaxZIndex(f)+1}},children:[{tagName:EBG.Adaptors.TagNames.A,attributes:{id:e,target:"_blank",onClick:EBG.format("EBG.adaptor.openPage('{0}');",d),mmskipreplace:1},children:null}]},this._containerId==this._adConfig.placeHolderId?EBG.adaptor.inject(d,EBG.Adaptors.InjectionMethod.APPEND,f):EBG.adaptor.inject(d,EBG.Adaptors.InjectionMethod.INSERT_BEFORE,
f),e=EBG.adaptor.getElementById(e))){f={tagName:EBG.Adaptors.TagNames.IMG,attributes:{id:a.id,style:{position:EBG.AdChoice.AdChoiceManager.Position.ABSOLUTE,visibility:EBG.AdChoice.AdChoiceManager.VisibilityState.VISIBLE,left:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset),top:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset)}},children:null};EBG.adaptor.inject(f,EBG.Adaptors.InjectionMethod.APPEND,e);f={tagName:EBG.Adaptors.TagNames.IMG,attributes:{id:c.id,style:{position:EBG.AdChoice.AdChoiceManager.Position.ABSOLUTE,
visibility:EBG.AdChoice.AdChoiceManager.VisibilityState.HIDDEN,left:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset),top:EBG.px(EBG.AdChoice.AdChoiceManager.DefaultOffset)}},children:null};EBG.adaptor.inject(f,EBG.Adaptors.InjectionMethod.APPEND,e);var e=EBG.adaptor.getElementById(a.id),f=EBG.adaptor.getElementById(c.id),g=this,h=function(){EBG.runTimed(g,g._handleImgOnloadEvent,[a.id,0],EBG.AdChoice.AdChoiceManager.ImageLoadTimeout)},d=function(){EBG.runTimed(g,g._handleImgOnloadEvent,[c.id,0],
EBG.AdChoice.AdChoiceManager.ImageLoadTimeout)};if(e)h=new EBG.Events.EventSubscription("load",h,this),h.isElementEvent=!0,h.elementId=a.id,EBG.eventMgr.subscribeToEvent(h),e.src=a.iconSrc;if(f)h=new EBG.Events.EventSubscription("load",d,this),h.isElementEvent=!0,h.elementId=c.id,EBG.eventMgr.subscribeToEvent(h),f.src=c.iconSrc}},_subscribeIconToEvents:function(a,c){var d=this,e=function(){d._handleMouseOverEvent(a,c)},f=new EBG.Events.EventSubscription("mouseover",e,this);f.isElementEvent=!0;f.elementId=
a;EBG.eventMgr.subscribeToEvent(f);f=new EBG.Events.EventSubscription("mouseout",e,this);f.isElementEvent=!0;f.elementId=c;EBG.eventMgr.subscribeToEvent(f)},_handleMouseOverEvent:function(a,c){var d=EBG.adaptor.getElementById(a),e=EBG.adaptor.getElementById(c),f=EBG.adaptor.getStyleOfElem(d),g=EBG.AdChoice.AdChoiceManager.VisibilityState.VISIBLE,h=EBG.AdChoice.AdChoiceManager.VisibilityState.HIDDEN;if(f.visibility==EBG.AdChoice.AdChoiceManager.VisibilityState.VISIBLE)g=EBG.AdChoice.AdChoiceManager.VisibilityState.HIDDEN,
h=EBG.AdChoice.AdChoiceManager.VisibilityState.VISIBLE;f={visibility:h};EBG.adaptor.setStyleToElem(d,{visibility:g});EBG.adaptor.setStyleToElem(e,f)},_pageResizeHandler:function(){this._handleImgOnloadEvent(this._imgData.id,0);this._handleImgOnloadEvent(this._imgExpData.id,0)},_handleImgOnloadEvent:function(a,c){var d=EBG.adaptor.getElementById(a);imgPos=this._getIconOffsets(a,this._adConfig.adChoice.iconPosition,d.width,d.height,this._adConfig.width,this._adConfig.height);EBGInfra.isDefinedNotNull(c)&&
10>c?EBG.runTimed(this,this._rehandleImgOnloadEvent,[a,c],EBG.AdChoice.AdChoiceManager.ImageLoadTimeout):EBG.adaptor.setStyleToElem(d,{left:imgPos.offsetLeft,top:imgPos.offsetTop})},_rehandleImgOnloadEvent:function(a,c){this._handleImgOnloadEvent(a,c+1)}};EBG.declareNamespace("Ads");
EBG.Ads.Ad=function(a){this._adConfig=a;this._adConfig.isStdAd=this._isStdAd();this.startTime=(new Date).getTime()/1E3;this._fixPage();this._updateURLs();this._subscribeEventTriggeringURLs();EBG.ads[a.uid]=this;this._show();this.placeHolderElement?this._handleMultiBurn():this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,this._handleMultiBurn,EBG.Events.EventTiming.ONTIME);this._dpm=EBG.dataPipeMgr.getPipe(this._adConfig.sID);this._sendInitAdInformation()};
EBG.Ads.Ad.prototype={resizePlaceHolder:!0,checkingThrottle:!1,_throttleState:null,_adChoice:null,_adConfig:null,_cdiReason:0,_showOnlyDefaultImg:!1,_banner:{divId:"",resId:"",width:0,height:0},_hasDefaultImageInteraction:!1,_isStdAd:function(){return!0},_subscribeEventTriggeringURLs:function(){if(this._adConfig.eventTrackingURLs){this._adConfig.eventTrackingURLs=this._eventTrackingURLsAdapter(this._adConfig.eventTrackingURLs);for(var a in this._adConfig.eventTrackingURLs)this._subscribeToAdEvent(a,
this._handleEventTrackingURLs,EBG.Events.EventTiming.ONTIME)}},_eventTrackingURLsAdapter:function(a){function c(c){d.ebVideoInteraction=d.ebVideoInteraction||[];d.ebVideoInteraction.push({filter:{"eventData.intName":c},urls:a[e]})}var d={},e;for(e in a)switch(e){case "vidStart":c(EBG.VideoInteraction.STARTED);break;case "vid25Played":c(EBG.VideoInteraction.PERCENT_25_PLAYED);break;case "vid50Played":c(EBG.VideoInteraction.PERCENT_50_PLAYED);break;case "vid75Played":c(EBG.VideoInteraction.PERCENT_75_PLAYED);
break;case "vidFullyPlayed":c(EBG.VideoInteraction.FULLPLAY)}return d},_handleEventTrackingURLs:function(a){for(var c=this._adConfig.eventTrackingURLs[a.name],d=0;d<c.length;d++){var e=c[d];if(e.filter)for(var f in e.filter)EBG.valueFromPath(a,f)==e.filter[f]&&this._reportImpressionTrackingURLs(e.urls);else this._reportImpressionTrackingURLs(e.urls)}},_counterInteractionHandler:function(a){try{var c=a.eventData.intName;if(!c)c=EBG.Interactions.SystemInts.CLICK;a.eventData.clickUrl=this._replaceURLTokens(a.eventData.clickUrl);
a.eventData.clickedVerUrl=this._replaceURLTokens(a.eventData.clickedVerUrl);EBG.intMgr.handleCounterInteraction(c,this._adConfig.uid,0,null,a.eventData,"undefined"!=typeof a.eventData.handleClickInt?a.eventData.handleClickInt:!0)}catch(d){}},_versionTrackingImpressionHandler:function(a){try{a.eventData.impTrackingUrls&&this._reportImpressionTrackingURLs(a.eventData.impTrackingUrls)}catch(c){}},_reportImpressionTrackingURLs:function(a){if(!EBG.isPreview)for(var c=0;c<a.length;c++){var d=a[c];d&&(d=
this._replaceURLTokens(d),EBG.adaptor.reportToRemoteServerUsingImage(d))}},_show:function(){this._cdiReason=this._adConfig.showAieDefaultImage?4:this._cdiReason;var a=!this._canShow()||this._adConfig.showOnlyImage||this._adConfig.showAieDefaultImage;this._adConfig.defaultImageDisplayed=!(!a||!this._adConfig.defaultImagePath);var c=this._adConfig.showOnlyImage,d=new EBG.Events.Event(EBG.Events.EventNames.SHOW_AD);d.dispatcher=this;d.timing=EBG.Events.EventTiming.BEFORE;d.eventData={isDefaultImage:this._adConfig.defaultImageDisplayed};
EBG.eventMgr.dispatchEvent(d);c!==this._adConfig.showOnlyImage&&(a=!this._canShow()||this._adConfig.showOnlyImage||this._adConfig.showAieDefaultImage);this._subscribeToEvents();EBG.intMgr.initAdData(this._adConfig,this._adConfig.reportDelayedImpression?!0:!1);this._addSystemInteractions();this._verifyPlaceHolder();if(EBG.AdChoice&&EBG.AdChoice.AdChoiceManager)this._adChoice=new EBG.AdChoice.AdChoiceManager(this._adConfig),this._adChoice.init();(c=EBG.adaptor.getElementById(this._adConfig.placeHolderId))&&
this.resizePlaceHolder&&"undefined"!=typeof this._adConfig.display&&EBG.adaptor.setElemStyle(c,"display",this._adConfig.display);if(a)if(this._adConfig.defaultImagePath){if(!this._adConfig.imageOnly)a=new EBG.Events.Event(EBG.Events.EventNames.DEFAULT_IMPRESSION),a.eventData={impTrackingUrls:this._adConfig.defaultImpTrackingUrls},a.dispatcher=this,a.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(a);this._subscribeToAdEvent(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE,this._terminateShow,
EBG.Events.EventTiming.AFTER);this._showOnlyDefaultImg=!0;this.checkAndShowDefaultImage(this.showDefaultImage)}else this._reportImpression(!0);else this._showOnlyDefaultImg=!1,this._addVideoInteractions(),this._addCustomInteractions(),this._adConfig.useHtmlConvertor&&this._subscribeToAdEvent(EBG.Events.EventNames.ADD_CREATIVES,this._terminateShow,EBG.Events.EventTiming.AFTER),this._addCreatives(),this._adConfig.useHtmlConvertor||this._terminateShow()},_terminateShow:function(a){var c=this.placeHolderElement=
EBG.adaptor.getElementById(this._adConfig.placeHolderId);c&&this.resizePlaceHolder&&(EBG.adaptor.setElemStyle(c,"width",EBG.px(this._adConfig.width)),EBG.adaptor.setElemStyle(c,"height",EBG.px(this._adConfig.height)),EBG.adaptor.setElemStyle(c,"margin","0px auto"));c=new EBG.Events.Event(EBG.Events.EventNames.SHOW_AD);c.dispatcher=this;c.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;c.eventData={isDefaultImage:a?!0:!1};EBG.eventMgr.dispatchEvent(c)},_verifyPlaceHolder:function(){!EBG.adaptor.getElementById(this._adConfig.placeHolderId)&&
!document.body&&document.write('<img style="width:0;height:0"></img>');return EBG.adaptor.getElementById(this._adConfig.placeHolderId)},_canShow:function(){return!0},_onPlayHandler:function(){this._adConfig.arrOnPlayEvents&&this._executeEvents(this._adConfig.arrOnPlayEvents)},_onDownloadHandler:function(){this._adConfig.arrOnStartDnlEvents&&this._executeEvents(this._adConfig.arrOnStartDnlEvents)},_collectUrl:function(){if(!EBG.isPreview&&this._adConfig.shouldCollectUrl)try{EBG.adaptor.reportToRemoteServer(EBG.format("{0}{1}/BurstingPipe/adServer.bs?cn=curl&ai={2}&url=$${3}$$",
EBG.protocol,EBG.bs,this._adConfig.adId,top.document.URL))}catch(a){}},_executeEvents:function(a){for(var c,d,e=0;e<a.length;e++)switch(d=this._replaceURLTokens(a[e].url),a[e].typeId){case 3:c="ebPlayScript"+e;EBG.adaptor.writeScript(EBG.adaptor.generateElementId(c,this._adConfig.uid),d,this._adConfig.placeHolderId);break;case 5:c="ebDnlScript"+e;EBG.adaptor.writeScript(EBG.adaptor.generateElementId(c,this._adConfig.uid),d,this._adConfig.placeHolderId);break;case 4:c="ebPlayIFR"+e;EBG.adaptor.writeReportingIFrame(EBG.adaptor.generateElementId(c,
this._adConfig.uid),d,this._adConfig.placeHolderId);break;case 6:c="ebDnlIFR"+e,EBG.adaptor.writeReportingIFrame(EBG.adaptor.generateElementId(c,this._adConfig.uid),d,this._adConfig.placeHolderId)}},_addSystemInteractions:function(){try{var a=this._adConfig.interactions[EBG.Interactions.SystemInts.CLICK];if(a){var c=EBG.Interactions.Categories.SYSTEM;this._adConfig.interactions[EBG.Interactions.SystemInts.DEFAULT_CLICK]?this._hasDefaultImageInteraction=!0:this._adConfig.interactions[EBG.Interactions.SystemInts.DEFAULT_CLICK]=
EBG.cloneObj(a);this._addCounterInteraction(EBG.Interactions.SystemInts.CLICK,c);this._addCounterInteraction(EBG.Interactions.SystemInts.DEFAULT_CLICK,c)}if((!EBG.Ads.StdBanner||!(this instanceof EBG.Ads.StdBanner))&&(!EBG.Ads.WallpaperAd||!(this instanceof EBG.Ads.WallpaperAd)))this._addCounterInteraction(EBG.Interactions.SystemInts.AD_START,c,!0,1),this._addCounterInteraction(EBG.Interactions.SystemInts.AD_STACKING,c,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.MULTI_BURN,c,!1,
1),this._addCounterInteraction(EBG.Interactions.SystemInts.AD_COLLISION,c,!1,1),this._addCounterInteraction(EBG.Interactions.SystemInts.AD_CAROUSEL,c,!1,1),this._adConfig.adParamsEnabled&&this._addCounterInteraction(EBG.Interactions.SystemInts.AD_PARAMS,c,!1,5),this._adConfig.playerParamsEnabled&&this._addCounterInteraction(EBG.Interactions.SystemInts.PLAYER_PARAMS,c,!1,5)}catch(d){}},_addCounterInteraction:function(a,c,d){var e=this._adConfig.interactions[a],c=new EBG.Interactions.CounterInteractionData(a,
c,this._adConfig.uid);c.initiationType=e.nInitiated?EBG.Interactions.InitiationTypes.USER:EBG.Interactions.InitiationTypes.AUTO;c.countAsClick=e.fClick;if(e.agencyURL)c.remoteServers.agencyUrl=e.agencyURL;if(e.networkURL)c.remoteServers.networkUrl=e.networkURL;this._adjustClickTarget(a);c.counterJumpUrlData=e;c.reportImmediately=d?!0:!1;a=new EBG.Interactions.CounterInteraction(c);EBG.intMgr.addInteraction(a)},_addVideoInteractions:function(){},_addCustomInteractions:function(){},_adjustClickTarget:function(a){var a=
this._adConfig.interactions[a],c;switch(a.target){case 0:c=EBG.WindowTarget.SELF;break;case 2:c=EBG.WindowTarget.TOP;break;default:c=EBG.WindowTarget.BLANK}a.target=c},_subscribeToEvents:function(){this._adConfig.interactionsToReport&&this._subscribeToAdEvent(EBG.Events.EventNames.ADD_INTERACTION,this._handleInteractionsSubscription,EBG.Events.EventTiming.BEFORE);this._subscribeToAdEvent(EBG.EBMessage.CLICKTHROUGH,this._counterInteractionHandler);this._subscribeToAdEvent(EBG.EBMessage.VERSION_TRACKING_IMPRESSION,
this._versionTrackingImpressionHandler);this._subscribeToAdEvent(EBG.Events.EventNames.DEFAULT_IMPRESSION,this._versionTrackingImpressionHandler,EBG.Events.EventTiming.ONTIME);this._subscribeToAdEvent(EBG.Events.EventNames.DEFAULT_CLICK,this._counterInteractionHandler);this._subscribeToAdEvent(EBG.Events.EventNames.ADD_CREATIVES,this._onAddCreativesHandler,EBG.Events.EventTiming.ONTIME);this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,this._onDownloadHandler,EBG.Events.EventTiming.ONTIME);this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,
this._onPlayHandler,EBG.Events.EventTiming.AFTER);this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,this._collectUrl,EBG.Events.EventTiming.AFTER);this._adConfig.adParamsEnabled&&this._subscribeToAdEvent(EBG.Events.EventNames.AD_START,this._reportAdParams,EBG.Events.EventTiming.AFTER);this._subscribeToAdEvent(EBG.EBMessage.NOTIFY_INTERACTION_MONITOR,this._notifyInteractionManager);var a=new EBG.Events.EventSubscription(EBG.Events.EventNames.ELEMENT_LOADED,function(a){a.eventData.adUId==this._adConfig.uid&&
this._triggerAdStart()},this);a.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.subscribeToEvent(a);this._subscribeToAdEvent(EBG.Events.EventNames.THROTTLED,this._handleCreativeThrottled)},_handleInteractionsSubscription:function(a){try{var c=a.eventData.interactionData.reportingName;return this._adConfig.interactionsToReport&&this._adConfig.interactionsToReport[c]?!0:!1}catch(d){}},_onAddCreativesHandler:function(a){this._adConfig.ffs.CFF_FlashThrottle&&(!a||!a.eventData||!(a.eventData.creativeType&&
a.eventData.creativeType==EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE))&&this._checkForCreativeThrottling();try{if(!EBG.Initializer._getAdClass({tn:this._adConfig.templateName}).requiresIframeBust||this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.SCRIPT){var c=a.dispatcher._adConfig.placeHolderId;if(c){var d=(this._adConfig.displayWin||EBG.adaptor.getDisplayWin()).document.getElementById(c);if(d)d.style.backgroundImage="",d.onclick=function(){}}}}catch(e){}},_checkForCreativeThrottling:function(){for(cc in this._CCs)this._CCs.hasOwnProperty(cc)&&
this._CCs[cc].detectThrottling&&(this._CCs[cc].detectThrottling(),this._subscribeToAdEvent(EBG.Events.EventNames.MOUSE_OVER,this._stopPollingForThrottle,EBG.Events.EventTiming.ONTIME))},_stopPollingForThrottle:function(a){var c=!0;if(a&&a.eventData&&a.eventData.target&&a.eventData.target.children){for(var d in this._CCs)this._CCs.hasOwnProperty(d)&&(a.eventData.target.children[d]&&this._CCs[d].stopPollingForThrottle&&this._CCs[d].stopPollingForThrottle(),this._CCs[d].isPollingForThrottle&&!0==this._CCs[d].isPollingForThrottle&&
(c=!1));if(c)a=new EBG.Events.EventSubscription(EBG.Events.EventNames.MOUSE_OVER,this._stopPollingForThrottle,this),a.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},a.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.unsubscribeFromEvent(a)}},_onAdCreativesAdded:function(){var a=new EBG.Events.Event(EBG.Events.EventNames.AD_CREATIVES_ADDED);a.dispatcher=this;EBG.eventMgr.dispatchEvent(a)},_fixPage:function(){var a=this._adConfig.page,a=a.replace(/\~/ig,"_"),a=a.replace(/\^/ig,"_"),a=a.replace(/\|/ig,
"_"),a=escape(a);this._adConfig.page=a},_updateURLs:function(){for(var a=this._adConfig.clickTrackingUrls,c=0;c<a.length;c++)a[c]=this._replaceURLTokens(a[c]);var a=this._adConfig.interactions,d;for(d in a)if(a.hasOwnProperty(d))a[d].agencyURL=this._replaceURLTokens(a[d].agencyURL),a[d].networkURL=this._replaceURLTokens(a[d].networkURL),a[d].jumpUrl=this._replaceURLTokens(a[d].jumpUrl)},_handleMultiBurn:function(){this._reportMultiBurn(this._checkMultiBurn())},_checkMultiBurn:function(){var a={isAdCarousel:!1,
isAdCollision:!1,isMultiBurn:!1},c=this._adConfig.advertiserId,d=this._adConfig.placementId,e=this._adConfig.uid;try{var f=EBG.getTopAccessibleWindow();f.ebAds=f.ebAds||{};for(var g in f.ebAds){var h=f.ebAds[g];if(e!=h._adConfig.uid&&h.placeHolderElement){if(!h.removed)try{if(0==h.placeHolderElement.getClientRects().length)h.removed=!0}catch(i){h.removed=!0}if(h.removed){var j=(new Date).getTime()/1E3-h.startTime;if(!a.isAdCarousel&&10<j&&150>j)a.isAdCarousel=!0}else if(!a.isMultiBurn&&d===h._adConfig.placementId)a.isMultiBurn=
!0;else if(!a.isMultiBurn&&!a.isAdCollision&&c&&c===h._adConfig.advertiserId)a.isAdCollision=!0}}}catch(k){}return a},_reportMultiBurn:function(a){a.isMultiBurn?EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.MULTI_BURN,this._adConfig.uid):a.isAdCollision&&EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.AD_COLLISION,this._adConfig.uid);a.isAdCarousel&&EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.AD_CAROUSEL,this._adConfig.uid)},_reportAdParams:function(){if(EBG.intMgr.isInteractionExist(EBG.Interactions.SystemInts.AD_PARAMS.toLowerCase(),
EBG.Interactions.InteractionTypes.COUNTER,this._adConfig.uid))if(EBG.adaptor.isPageLoaded()){if(this._adConfig.adParamsEnabled){var a=this._getServingModeNum(),c=this._getBannerLocation(),c=c&&c.X+"x"+c.Y,d=!this.visibilityMgr?0:this.visibilityMgr.getVisibilityProviderNum(),e=this._adConfig.width+"x"+this._adConfig.height,f=this._getAdCodeBase();EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.AD_PARAMS,this._adConfig.uid,0,!1,{value:{ifr:a,loc:c,vsbp:d,size:e,cb:f}})}}else this._subscribeToAdEvent(EBG.Events.EventNames.PAGE_LOAD,
this._reportAdParams)},_getBannerLocation:function(a){if(a&&EBG.isNumber(a.X)&&EBG.isNumber(a.Y)&&this._adConfig.actualServingMode&&this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME)for(var c=EBG.adaptor.getDisplayWin();c.self!==c.parent;){var d=EBG.adaptor.getPositioningByElement(c.frameElement);a.X+=d.X;a.Y+=d.Y;c=c.parent}return a},_getAdCodeBase:function(a){a=EBG.isDefined(a)?a:0;this._showOnlyDefaultImg&&(a=0);1==a&&this._adConfig.hasConverter&&this._adConfig.useHtmlConvertor&&
(a=3);return a},_getServingModeNum:function(){var a={SCRIPT:0,FRIENDLY_IFRAME:1,IFRAME:2,INNER_IFRAME:3,TOPMOST_FRIENDLY_IFRAME:4},c;if(this._adConfig.ffs.CFF_ServingEnv)c=EBG.adaptor.serving.detectServingEnvironment(this._adConfig.actualServingMode),c=EBG.isDefined(a[c])?a[c]:-1;else{c=EBG.isDefined(a[EBG.adaptor.serving.servingMode])?a[EBG.adaptor.serving.servingMode]:-1;var d=EBG.Initializer._getAdClass({tn:this._adConfig.templateName});0==c&&!d.requiresIframeBust&&(c=EBG.isDefined(a[this._adConfig.actualServingMode])?
a[this._adConfig.actualServingMode]:c)}return c},_getTemplateNameNum:function(){return{Html5StdBanner:0,Html5Banner:1,Html5SEBanner:2,Html5ExpBanner:3,Html5PoliteBanner:4,StdBanner:5,Banner:6,SingleExpBanner:7,ExpBanner:8,Visibility:9,FloatingAd:10,FloatingAdWithReminder:11,Tracking:12}[this._adConfig.templateName]||-1},getAdId:function(){return this._adConfig.adId},_replaceURLTokens:function(a){var c=this._adConfig;try{a&&(a=a.replace(/\[%random%\]/ig,c.rnd),a=a.replace(/\[ebRandom\]/ig,c.rnd),a=
a.replace(/\[timestamp\]/ig,c.rnd),a=a.replace(/\[%tp_adid%\]/ig,c.adId),a=a.replace(/\[%tp_flightid%\]/ig,c.placementId),a=a.replace(/\[%tp_campaignid%\]/ig,c.campaignId));if(!a||!c.sUrlTokens)return a;if(!EBG.isObj(c.objURLTokens))c.oURLTokens=this._pairsToObj(c.sUrlTokens,"$$");for(var d in c.oURLTokens)c.oURLTokens.hasOwnProperty(d)&&(a=a.replace(RegExp("\\[%"+d+"%\\]","ig"),c.oURLTokens[d]))}catch(e){}return a},_pairsToObj:function(a,c){for(var d={},e=unescape(a).split(c),f=0;f<e.length;f++)try{if(e[f]){var g=
e[f].indexOf("="),h=e[f].substr(0,g),i=e[f].substr(g+1);d[h]=escape(i)}}catch(j){}return d},_subscribeToAdEvent:function(a,c,d){a=new EBG.Events.EventSubscription(a,c,this);a.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd};if(d)a.timing=d;EBG.eventMgr.subscribeToEvent(a)},_getCDIUrl:function(a){var c=a&&a.defaultImagePath?a.defaultImagePath:null,c=EBG.format("{0}{1}/{2}/adServer.bs?cn=cdi&ai={3}&p={4}&pluid={5}&ru={6}&pc={7}&brt={8}&pltype={9}&sessionid={10}&dir={11}&ord={12}",EBG.protocol,
EBG.bs,this._adConfig.interactionServer,this._adConfig.adId,this._adConfig.page,this._adConfig.pluId,EBG.isDefinedNotNull(c)&&""!=c?c:EBG.combinePaths(this._adConfig.resourcePath,this._adConfig.defaultImagePath),this._adConfig.sPublisherPlacementId,EBG.adaptor.browser._browserCode,EBG.adaptor.browser._platform,this._adConfig.sID,this._cdiReason,this._adConfig.rnd),d=this._adConfig.massVersioning.targetAudienceId;d&&(c+=EBG.format("&ta={0}",d));(d=this._adConfig.massVersioning.deliveryGroupId)&&(c+=
EBG.format("&dg={0}",d));a&&a.versionId?c+=EBG.format("&vid={0}",a.versionId):this._adConfig.massVersioning.adVersions&&(a=this._removePrefixFromVersions(),c+=EBG.format("&vid={0}",a));EBGInfra.isDefinedNotNull(this._adConfig.diAppId)&&(c+="&diappid="+this._adConfig.diAppId);return c},_removePrefixFromVersions:function(){var a="",c=this._adConfig.massVersioning.adVersions;if(c){for(var a=[],c=c.split(","),d=0;d<c.length;d++){var e=c[d].indexOf("_");a.push(-1==e?c[d]:c[d].substring(0,e))}a=a.join()}return a},
buildJSONImgObj:function(a,c){var d=EBG.format(a+"_{0}",this._adConfig.uid);return{tagName:EBG.Adaptors.TagNames.IMG,attributes:{id:d,src:c,width:this._adConfig.width,height:this._adConfig.height,style:{width:this._adConfig.width,height:this._adConfig.height},title:this._adConfig.title?this._adConfig.title:"",onload:EBG.format('(function(e) { var event = new EBG.Events.Event(EBG.Events.EventNames.ELEMENT_LOADED);event.dispatcher = this;event.eventData = { DOMEvent: e, elementId: "{0}", adUId:"{1}" };event.timing = EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(event);} )(typeof arguments != "undefined" ? arguments[0] : null);',
d,this._adConfig.uid)}}},setImageClick:function(a,c,d,e,f){a.attributes.onclick=EBG.format('EBG.ads["'+this._adConfig.uid+'"].onImageClick("{0}", {1},"{2}", "{3}", "{4}", "{5}")',this._adConfig.uid,c,a.attributes.id,d,e,f);EBG.mergeObj({cursor:"pointer; cursor: hand"},a.attributes.style)},_addDefaultImgRequest:function(){this.checkAndShowDefaultImage(this.showDefaultImage)},checkAndShowDefaultImage:function(a){var c="",d=".xml",e=!0;if(EBG.isDefinedNotNull(this._adConfig.svJSON)||EBG.isDefinedNotNull(this._adConfig.sv3CatalogMap)||
this._adConfig.massVersioning.versionFullPath)d=".json",e=!1;if(EBG.isDefinedNotNull(this._adConfig.massVersioning)&&""!=this._adConfig.massVersioning.defaultAdVersion&&""!=this._adConfig.massVersioning.adBasePath){c=this._adConfig.massVersioning.defaultAdVersion;c=0<this._adConfig.massVersioning.massVersionFolderDivider?EBG.Ads.Ad.Fn.fixMVPathString(c,this._adConfig.massVersioning.massVersionFolderDivider):c;if(this._adConfig.massVersioning.versionFullPath)c=c.p;c=EBG.combinePaths(this._adConfig.massVersioning.adBasePath,
c+d);c=EBG.combinePaths(this._adConfig.resourcePath,c)}d=e?this._readMassVersionInfo:this._readJsonVersionInfo;(!c||!EBG.adaptor.getDataFromRemoteServer(c,d,this,!0,e))&&a.apply(this)},subscribeToStandardElementEvents:function(){},showDefaultImage:function(a){var c=!this._adConfig.imageOnly||this._hasDefaultImageInteraction,d="";this._adConfig.showOnlyImage||this._adConfig.imageOnly||this._adConfig.reportDelayedImpression?d=a&&a.isValid?a.defaultImagePath:EBG.combinePaths(this._adConfig.resourcePath,
this._adConfig.defaultImagePath):(d=a&&a.isValid?this._getCDIUrl(a):this._getCDIUrl(),this._adConfig.massVersioning.adVersions="");var d=this.buildJSONImgObj("ebDefaultImg",d),e=a&&a.isValid&&a.jumpUrl?a.jumpUrl:c?this._adConfig.interactions[EBG.Interactions.SystemInts.DEFAULT_CLICK].jumpUrl:this._adConfig.interactions[EBG.Interactions.SystemInts.CLICK].jumpUrl;e&&this.setImageClick(d,c,e,a&&a.isValid?a.selectedVersion:"",a&&a.isValid?a.thirdPartyClks:"");a&&a.thirdPartyImps&&a.thirdPartyImps.length&&
this._reportImpressionTrackingURLs(a.thirdPartyImps);a=new EBG.Events.Event(EBG.Events.EventNames.ADD_CREATIVES);a.dispatcher=this;a.eventData={tagsObj:d,assetId:d.attributes.id,isPanel:!1,creativeType:EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE};a.timing=EBG.Events.EventTiming.BEFORE;e=EBG.eventMgr.dispatchEvent(a);if(!e&&(c=new EBG.Events.Event(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE),c.eventData={assetId:d.attributes.id},c.dispatcher=this,c.timing=EBG.Events.EventTiming.BEFORE,
e=EBG.eventMgr.dispatchEvent(c),!e)){var e=EBG.adaptor._getTags(d),f=EBG.adaptor.getElementById(this._adConfig.placeHolderId);EBG.adaptor.setInnerHtml(f,e);this._defaultImgResId=d.attributes.id;this.subscribeToStandardElementEvents(this._defaultImgResId);c.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(c);a.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(a)}},_triggerAdStart:function(a){if(!(this._shouldWaitForTriggerAdStart()&&!(EBGInfra.isDefined(a)&&
a.name===EBG.EBMessage.TRIGGER_AD_START)||this._adConfig.adStarted))if(this._adConfig.adStarted=!0,a=new EBG.Events.Event(EBG.Events.EventNames.AD_START),a.eventData={intName:EBG.Interactions.SystemInts.Ad_START},a.dispatcher=this,a.timing=EBG.Events.EventTiming.BEFORE,!EBG.eventMgr.dispatchEvent(a))this._shouldFireAdStart()&&EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.AD_START,this._adConfig.uid),a.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(a)},
_shouldFireAdStart:function(){var a=!1;if(this._adConfig.isInstream){if(this._adConfig.isInstreamVisibility||this._adConfig.isInstreamVerification)a=!0}else if(this._adConfig.displayVerification||this._adConfig.visibility.mode==EBG.VisibilityMode.BASIC_MODE||this._adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE)a=!0;return a},_shouldWaitForTriggerAdStart:function(){return!1},_readJsonVersionInfo:function(a){var c=JSON.parse(a),a=this._adConfig.massVersioning.defaultAdVersion.indexOf("_"),
a={isValid:!!c.DefaultImage,jumpUrl:c.ClickthroughURL?c.ClickthroughURL:"",defaultImagePath:c.DefaultImage?c.DefaultImage:"",selectedVersion:-1==a?this._adConfig.massVersioning.defaultAdVersion:this._adConfig.massVersioning.defaultAdVersion.substring(0,a),thirdPartyImps:c.ThirdPartyImpressionURL?this._parseUrlValue(c.ThirdPartyImpressionURL):[],thirdPartyClks:c.ThirdPartyClickthroughURL?this._parseUrlValue(c.ThirdPartyClickthroughURL):[],versionId:c.versionId?c.versionId:0};if(a.isValid&&EBG.isNumber(c.DefaultImage)){a.isValid=
!1;var c=this._adConfig.assets,d="ebMovie"+a.defaultImagePath;if(EBG.isDefinedNotNull(c[d].dsPath))a.defaultImagePath=EBG.isInWorkshop?c[d].dsPath:EBG.combinePaths(this._adConfig.resourcePath,c[d].dsPath),a.isValid=!0}(this._showOnlyDefaultImg?this.showDefaultImage:this._showImgAsCreative).apply(this,[a])},_readMassVersionInfo:function(a){var c={isValid:!1,jumpUrl:"",defaultImagePath:"",selectedVersion:"",thirdPartyImps:[],thirdPartyClks:[]};try{if(EBG.isDefined(a)&&null!=a){var d=a.documentElement.attributes.getNamedItem("productClickThrough"),
e=a.documentElement.attributes.getNamedItem("DefaultImage"),f=a.documentElement.attributes.getNamedItem("ThirdPartyImps"),g=a.documentElement.attributes.getNamedItem("ThirdPartyClickThrough"),h=this._adConfig.massVersioning.defaultAdVersion.indexOf("_"),c={isValid:null!=e&&""!=e.value,jumpUrl:null!=d?d.value:"",defaultImagePath:null!=e?e.value:"",selectedVersion:-1==h?this._adConfig.massVersioning.defaultAdVersion:this._adConfig.massVersioning.defaultAdVersion.substring(0,h),thirdPartyImps:f&&f.value?
this._parseUrlValue(f.value):[],thirdPartyClks:g&&g.value?this._parseUrlValue(g.value):[]};if(c.isValid&&EBG.isNumber(c.defaultImagePath)){c.isValid=!1;var i=this._adConfig.assets,j="ebMovie"+c.defaultImagePath;if(EBG.isDefinedNotNull(i[j].dsPath))c.defaultImagePath=EBG.isInWorkshop?i[j].dsPath:EBG.combinePaths(this._adConfig.resourcePath,i[j].dsPath),c.isValid=!0}}(this._showOnlyDefaultImg?this.showDefaultImage:this._showImgAsCreative).apply(this,[c])}catch(k){this.showDefaultImage(c)}},_parseUrlValue:function(a){for(var c=
[],a=a.split("\u007f"),d=0;d<a.length;d++)for(var e=a[d].split("|"),f=0;f<e.length;f++)c.push(e[f]);return c},_sendInitAdInformation:function(){this._dpm.send(EBG.DataProfile.GENERAL,{adid:this._adConfig.adId,frmt:this._getTemplateNameNum()});this._dpm.send(EBG.DataProfile.PLATFORM,{os:EBG.adaptor.browser._platform,brsrc:EBG.adaptor.browser._browserCode,brsrv:EBG.adaptor.browser._browserVer,brsrt:EBG.adaptor.browser._browserType,env:EBG.adaptor.browser.getEnvironment(this._adConfig)});var a=this._getServingModeNum(),
c=window&&window.location&&window.location.href?window.location.href.substr(0,50):"";this._dpm.send(EBG.DataProfile.SERVING,{srvmd:a,url:c});this._adConfig.MRAID&&this._dpm.send(EBG.DataProfile.PLATFORM,{mraid:1});"undefined"!=typeof mraid&&this._dpm.send(EBG.DataProfile.PLATFORM,{mraidw:1})},_switchAssetsAfterThrottle:function(){},_handleCreativeThrottled:function(a){if(this._adConfig.ffs.CFF_FlashThrottle&&a.eventData)if(a.eventData.state&&a.eventData.state==EBG.ThrottleStates.RESUME)clearTimeout(this._throttleTimeout),
this._throttleState=EBG.ThrottleStates.RESUME;else if(a.eventData.state&&a.eventData.state==EBG.ThrottleStates.POLLED&&a.dispatcher._adConfig.uid==this._adConfig.uid)this._switchAssetsAfterThrottle(),EBG.adaptor.flash.removeThrottleDetectionSwf(this._adConfig.uid);else if(this.visibilityMgr)this.visibilityMgr.isVisibile()?this._throttleState==EBG.ThrottleStates.THROTTLE?(this._switchAssetsAfterThrottle(),EBG.adaptor.flash.removeThrottleDetectionSwf(this._adConfig.uid)):this._throttleTimeout=EBG.runTimed(this,
this._handleCreativeThrottled,[a],1E3):this._subscribeToAdEvent(EBG.Events.EventNames.PAGE_SCROLL,this._checkIfStillThrottled),this._throttleState=EBG.ThrottleStates.THROTTLE},_checkIfStillThrottled:function(a){if(a){if(this.visibilityMgr&&!this._throttleTimeout&&this._throttleState==EBG.ThrottleStates.THROTTLE&&this.visibilityMgr.isVisibile())this._throttleTimeout=EBG.runTimed(this,this._checkIfStillThrottled,[],1E3)}else{if(this._throttleState==EBG.ThrottleStates.THROTTLE&&this.visibilityMgr&&this.visibilityMgr.isVisibile())this._switchAssetsAfterThrottle(),
EBG.adaptor.flash.removeThrottleDetectionSwf(this._adConfig.uid),a=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_SCROLL,this._checkIfStillThrottled,this),a.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},a.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.unsubscribeFromEvent(a);clearTimeout(this._throttleTimeout);this._throttleTimeout=null;if(this._throttleState==EBG.ThrottleStates.RESUME)a=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_SCROLL,this._checkIfStillThrottled,
this),a.dispatcherFilters={"_adConfig.rnd":this._adConfig.rnd},a.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.unsubscribeFromEvent(a)}},dispatchCustomEvent:function(a,c,d,e){a=new EBG.Events.Event(a);a.dispatcher=e;a.eventData={assetId:c};a.timing=d;return EBG.eventMgr.dispatchEvent(a)},_notifyInteractionManager:function(a){var c={};if(a&&a.eventData)c=a.eventData;c.elapsedTime="";if(EBG.intMgr.getAdDuration)c.elapsedTime=EBG.intMgr.getAdDuration(this._adConfig.uid);EBG.adaptor.notifyIntMonitor(a.eventData)},
onImageClick:function(a,c,d,e,f,g){try{var h=c?new EBG.Events.Event(EBG.Events.EventNames.DEFAULT_CLICK):new EBG.Events.Event(EBG.EBMessage.CLICKTHROUGH);h.eventData=c?{intName:EBG.Interactions.SystemInts.DEFAULT_CLICK}:{intName:EBG.Interactions.SystemInts.CLICK};if(EBG.isDefined(e))h.eventData.clickUrl=e;if(EBG.isDefined(f))h.eventData.clickedVersion=f;if(EBG.isDefined(g))h.eventData.clickedVerUrl=g;h.dispatcher=EBG.ads[a];EBG.eventMgr.dispatchEvent(h);if(EBG.adaptor.intMonitorExist()){var i=new EBG.Events.Event(EBG.EBMessage.NOTIFY_INTERACTION_MONITOR);
i.eventData={command:EBG.EBMessage.CLICKTHROUGH,args:"",objName:d,adId:EBG.Ads.Ad.Fn.getAdIdFromAdUId(a)};EBG.eventMgr.dispatchEvent(i)}}catch(j){}}};EBG.declareClass(EBG.Ads.Ad,null);
EBG.Ads.Ad.Fn={getAdIdFromAdUId:function(a){return a.split("_")[0]},getRandFromAdUId:function(a){return a.split("_")[1]},getVersionToReport:function(a){return-1<a.indexOf(",")?"m":-1<a.indexOf("_")?a.substr(0,a.indexOf("_")):a},getAdVersions:function(a){for(var c="",a=a.adVersions.split(","),d=0;d<a.length;d++)c&&(c+=","),c+=a[d];return c},fixMVPathString:function(a,c){if(0<c)for(var d=a.split(","),e="",f="",g,h,i,j=0;j<d.length;j++)i=d[j],g="",EBG.isDefinedNotNull(i.match("_"))&&(g=i.substr(i.indexOf("_"))),
i=parseInt(i),h=parseInt(i/c),i=h+g+"/"+i,e+=f+i,""==f&&(f=",");return e},_handlePageResizeOrScroll:function(){}};EBG.Ads.RichAd=function(a){this._downloadMode=a.dlm;EBG.callSuperConstructor(EBG.Ads.RichAd,this,[a])};
EBG.Ads.RichAd.prototype={isInFullScreenMode:!1,visibilityMgr:null,videoLoaderDrivers:[],_wallpaper:null,_registeredToMouseMove:!1,_mouseMoveTimeOut:null,_creativeContainerReadyHandled:!1,_isStdAd:function(){return!1},_subscribeToEvents:function(){try{EBG.callSuperFunction(EBG.Ads.RichAd,this,"_subscribeToEvents"),EBG.adaptor.isPageLoaded()?EBG.runTimed(this,this._handlePageLoaded,[],0):this._subscribeToAdEvent(EBG.Events.EventNames.PAGE_LOAD,this._handlePageLoaded),this._subscribeToAdEvent(EBG.EBMessage.NOTIFIED_INTERACTION,
this._notifiedInteractionHandler),this._subscribeToAdEvent(EBG.EBMessage.VIDEO_INTERACTION,this._videoInteractionHandler),this._subscribeToAdEvent(EBG.EBMessage.USER_ACTION_COUNTER,this._counterInteractionHandler),this._subscribeToAdEvent(EBG.EBMessage.AUTOMATIC_EVENT_COUNTER,this._counterInteractionHandler),this._subscribeToAdEvent(EBG.EBMessage.START_TIMER,this._startTimerHandler),this._subscribeToAdEvent(EBG.EBMessage.STOP_TIMER,this._stopTimerHandler),this._subscribeToAdEvent(EBG.EBMessage.START_VIDEO_TIMER,
this._startTimerVideoHandler),this._subscribeToAdEvent(EBG.EBMessage.STOP_VIDEO_TIMER,this._stopTimerHandler),this._subscribeToAdEvent(EBG.EBMessage.UPDATE_TIMER,this._updateTimerHandler),this._subscribeToAdEvent(EBG.EBMessage.START_VIDEO,this._startAggregateHandler),this._subscribeToAdEvent(EBG.EBMessage.STOP_VIDEO,this._stopAggregateHandler),this._subscribeToAdEvent(EBG.EBMessage.UPDATE_VIDEO_DURATION,this._updateAggregationTimeHandler),this._subscribeToAdEvent(EBG.EBMessage.INIT_VIDEO_LOADER,this._initVideoLoaderHandler),
this._subscribeToAdEvent(EBG.EBMessage.VIDEO_LOAD,this._videoLoadHandler),this._subscribeToAdEvent(EBG.EBMessage.VIDEO_FS_OPEN,this._videoFSOpenHandler),this._subscribeToAdEvent(EBG.EBMessage.VIDEO_FS_CLOSE,this._videoFSCloseHandler),this._subscribeToAdEvent(EBG.EBMessage.VIDEO_FS_AUTO_CLOSE,this._videoFSAutocloseHandler),this._subscribeToAdEvent(EBG.EBMessage.SET_STATE,this._setStateInCreativeState),this._subscribeToAdEvent(EBG.EBMessage.RESET_STATE,this._setStateInCreativeState),this._subscribeToAdEvent(EBG.Events.EventNames.MOUSE_MOVE_NEEDED,
this._mouseMoveNeededHandler,EBG.Events.EventTiming.BEFORE),this._subscribeToAdEvent(EBG.Events.EventNames.SHOW_AD,this.adCreativesAddedHandler,EBG.Events.EventTiming.AFTER),this._subscribeToAdEvent(EBG.Events.EventNames.ADD_CREATIVES,this.addCreativesHandler,EBG.Events.EventTiming.ONTIME),this._subscribeToAdEvent(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE,this.addCreativesHandler,EBG.Events.EventTiming.ONTIME),this._subscribeToAdEvent(EBG.Events.EventNames.DWELL_UNIQUE,this._dwellUniqueEventHandler,
EBG.Events.EventTiming.ONTIME),this._subscribeToAdEvent(EBG.Events.EventNames.RICH_FLASH_PLAYED,this._richFlashPlayedEventHandler,EBG.Events.EventTiming.ONTIME),this._subscribeToAdEvent(EBG.EBMessage.SHOW_DEFAULT_IMAGE,this._addDefaultImgRequest),this._subscribeToAdEvent(EBG.Events.EventNames.CREATIVE_CONTAINER_READY,this._handleDelayedImpressionReport,EBG.Events.EventTiming.AFTER),this._subscribeToAdEvent(EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE,this._handleDelayedImpressionReport,
EBG.Events.EventTiming.AFTER),this._dwellTimeManager=new EBG.Interactions.DwellTimeManager(this._adConfig),this._dwellTimeManager.init(),this._adConfig.bgImgSrc&&(this._subscribeToAdEvent(EBG.Events.EventNames.CLOSE_AD,this._removeBackgroundImage),this._subscribeToAdEvent(EBG.Events.EventNames.PAGE_UNLOAD,this._removeBackgroundImage))}catch(a){}},_handlePageLoaded:function(){},_handleDelayedImpressionReport:function(){if(!this._creativeContainerReadyHandled&&this._adConfig.reportDelayedImpression)this._creativeContainerReadyHandled=
!0,this._adConfig.delayedImpParams&&(this._reportImpression(),this._clearDelayedImpData()),(this._adConfig.impressionTrackingURLs||0<this._adConfig.impressionTrackingURLs)&&this._reportImpressionTrackingURLs(this._adConfig.impressionTrackingURLs),EBG.intMgr.allowInteractionReport(this._adConfig.uid)},_clearDelayedImpData:function(){this._adConfig.delayedImpParams=null},_reportImpression:function(a){var c=EBGInfra.isDefined(this._adConfig.page)&&""!=this._adConfig.page?1:0,c=EBG.format("{0}{1}/{2}/adServer.bs?cn=display&code=10&PluID={3}&EyeblasterID={4}&Page={5}&WebPageSource={6}&ForceDisplay={7}&Resolution={8}&sessionid={9}&Optout={10}&usercookie={11}",
EBG.protocol,EBG.bs,this._adConfig.appPool,this._adConfig.pluId,this._adConfig.adId,this._adConfig.page,c,EBG.isPreview?1:0,EBG.adaptor.getResolution(),this._adConfig.sID,this._adConfig.optOut,this._adConfig.usercookie);this._adConfig.delayedImpParams&&(c+=this._adConfig.delayedImpParams);a&&(c+="&isBlank=1");EBG.adaptor.flash&&(c+="&FlashVersion="+EBG.adaptor.flash.version);this._adConfig.massVersioning.targetAudienceId&&(c+="&ta="+this._adConfig.massVersioning.targetAudienceId);this._adConfig.massVersioning.deliveryGroupId&&
(c+="&dg="+this._adConfig.massVersioning.deliveryGroupId);this._adConfig.massVersioning.subDeliveryGroupId&&(c+="&sdg="+this._adConfig.massVersioning.subDeliveryGroupId);this._adConfig.defaultImageDisplayed&&(c+="&di=1");this._adConfig.defaultImageReason&&(c+="&dir="+this._adConfig.defaultImageReason);this._adConfig.massVersioning.adVersions&&(c+="&vid="+this._removePrefixFromVersions());EBGInfra.isDefinedNotNull(this._adConfig.diAppId)&&(c+="&diappid="+this._adConfig.diAppId);c+="&ord="+Math.random();
EBG.adaptor.reportToRemoteServer(c)},_mouseMoveNeededHandler:function(){if(!this._registeredToMouseMove){var a=new EBG.Events.EventSubscription(EBG.Events.EventNames.MOUSE_MOVE,this._mouseMoveHandler,this);a.isDocumentEvent=!0;EBG.eventMgr.subscribeToEvent(a);this._registeredToMouseMove=!0}},_mouseMoveHandler:function(a){try{if(!this._mouseMoveTimeOut){var c=this;c._mouseMoveTimeOut=setTimeout(function(){c._mouseMoveTimeOut=null;for(var d in c._CCs)if(c._CCs.hasOwnProperty(d)&&c._CCs[d]._registeredToMouseMove){var f=
{},f=EBG.adaptor.getMouseCoordinates(a.eventData);c._CCs[d]._handleMouseMove(f)}},100)}}catch(d){}},_dwellUniqueEventHandler:function(a){EBG.intMgr.reportDwellUnique(this._adConfig.uid,a.eventData.firstTime)},_richFlashPlayedEventHandler:function(){EBG.intMgr.reportRichFlashPlayed(this._adConfig.uid)},addCreativesHandler:function(a){try{this._adConfig.bgImgSrc&&this._changeBackgroundImage(),this._updateVisibilityManagerData(a.eventData),this._updateAdStackingData(a.eventData)}catch(c){}},_updateVisibilityManagerData:function(a){if(a.isPanel){if(this._panels&&
1==EBG.adaptor.getObjKeys(this._adConfig.panels).length)this.visibilityMgrPanel?this.visibilityMgrPanel.updateResourceObjId(a.assetId):this.visibilityMgrPanel=new EBG.RichModules.VisibilityManager(this._adConfig,a.assetId,!0)}else this.visibilityMgr?this.visibilityMgr.updateResourceObjId(a.assetId):this.visibilityMgr=new EBG.RichModules.VisibilityManager(this._adConfig,a.assetId)},_updateAdStackingData:function(a){if(a.isPanel){if(this._panels&&1==EBG.adaptor.getObjKeys(this._adConfig.panels).length){if(!this._adStackingDetectorPanel)this._adStackingDetectorPanel=
new EBG.RichModules.AdStackingDetector(this._adConfig,!0);this._adStackingDetectorPanel.addElementId(a.assetId,!0)}}else{if(!this._adStackingDetector)this._adStackingDetector=new EBG.RichModules.AdStackingDetector(this._adConfig,!1);this._adStackingDetector.addElementId(a.assetId,!0)}},_addPreloadImg:function(){this._preloadImgResId=this._addImgAsCreative("ebPreloadImg",EBG.isInWorkshop?this._adConfig.preloadImagePath:EBG.combinePaths(this._adConfig.resourcePath,this._adConfig.preloadImagePath),EBG.Events.EventNames.ADD_BANNER_PRELOAD_IMAGE_CREATIVE)},
_addImgAsCreative:function(a,c,d,e){a=this.buildJSONImgObj(a,e&&e.isValid?e.defaultImagePath:c);(c=e&&e.isValid?e.jumpUrl:this._adConfig.interactions[EBG.Interactions.SystemInts.CLICK].jumpUrl)&&this.setImageClick(a,!1,c,e&&e.isValid?e.selectedVersion:"",e&&e.isValid?e.thirdPartyClks:"");c=new EBG.Events.Event(EBG.Events.EventNames.ADD_CREATIVES);c.dispatcher=this;c.eventData={tagsObj:a,assetId:a.attributes.id,isPanel:!1,creativeType:d};c.timing=EBG.Events.EventTiming.BEFORE;var f=EBG.eventMgr.dispatchEvent(c);
if(f||(f=this.dispatchCustomEvent(d,a.attributes.id,EBG.Events.EventTiming.BEFORE,this)))return a.attributes.id;var f=EBG.adaptor._getTags(a),g=EBG.adaptor.getElementById(this._adConfig.placeHolderId);if(this._richShown)return null;var h=EBG.adaptor.getElementById("emptyDiv"+this._banner.divId);e&&h?EBG.adaptor.setInnerHtml(h,f):EBG.adaptor.setInnerHtml(g,f);this.subscribeToStandardElementEvents(a.attributes.id);c.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(c);this.dispatchCustomEvent(d,
a.attributes.id,EBG.Events.EventTiming.ONTIME_AND_AFTER,this);return a.attributes.id},_showImgAsCreative:function(a){if(!this._richShown)this._defaultImgResId=this._addImgAsCreative("ebDefaultImg",EBG.isInWorkshop?this._adConfig.defaultImagePath:EBG.combinePaths(this._adConfig.resourcePath,this._adConfig.defaultImagePath),EBG.Events.EventNames.ADD_BANNER_DEFAULT_IMAGE_CREATIVE,a)},adCreativesAddedHandler:function(){try{this._startTimer(EBG.Interactions.SystemInts.AD_DURATION)}catch(a){}},getAdLocationOnPage:function(){var a=
this.getAdOffset();if(null==a)return a;var c=EBG.adaptor.getWindowViewPortMetrics(this._adConfig.displayWin||EBG.adaptor.getDisplayWin());return{isAdOnLeft:a.X+this._adConfig.width/2<c.Width/2,isAdOnTop:a.Y+this._adConfig.height/2<c.Height/2}},getAdOffset:function(){return null},getVideoLoaderDriver:function(a,c){for(var c=c.replace(/\./ig,"/"),d=0;d<this.videoLoaderDrivers.length;d++){var e=this.videoLoaderDrivers[d];if(e.data.res.id==a&&e.data.apiPath==c)return this.videoLoaderDrivers[d]}return null},
_initVideoLoaderHandler:function(a){a.eventData.apiPath=a.eventData.apiPath.replace(/\./ig,"/");a.eventData.res=EBG.adaptor.getElementById(a.flashResId);a.eventData.ad=this;this.videoLoaderDrivers.push(new EBG.Video.VideoLoaderDriver(a.eventData))},_videoLoadHandler:function(a){a.eventData.apiPath=a.eventData.apiPath.replace(/\./ig,"/");this.getVideoLoaderDriver(a.flashResId,a.eventData.apiPath).load(a.eventData)},_startAggregateHandler:function(a){try{EBG.intMgr.isInteractionExist(EBG.VideoInteraction.FULLSCREEN_DURATION.toLowerCase(),
EBG.Interactions.InteractionTypes.TIMER,this._adConfig.uid)||(this._addAggregateInteraction(EBG.VideoInteraction.FULLSCREEN_DURATION,EBG.Interactions.Categories.VIDEO),this._addAggregateInteraction(EBG.VideoInteraction.VIDEO_PLAY_DURATION,EBG.Interactions.Categories.VIDEO));var c=a.eventData.intName,d=this._getAssetIdFromEvent(a);EBG.intMgr.startAggregate(c,this._adConfig.uid,d)}catch(e){}},_updateAggregationTimeHandler:function(a){try{var c=a.eventData.intName,d=parseInt(a.eventData.deltalDuration),
e=this._getAssetIdFromEvent(a);EBG.intMgr.updateAggregation(c,this._adConfig.uid,d,e)}catch(f){}},_stopAggregateHandler:function(a){try{var c=a.eventData.intName,d=this._getAssetIdFromEvent(a);EBG.intMgr.stopAggregate(c,this._adConfig.uid,d)}catch(e){}},_startTimerVideoHandler:function(a){try{EBG.intMgr.isInteractionExist(EBG.VideoInteraction.FULLSCREEN_DURATION.toLowerCase(),EBG.Interactions.InteractionTypes.TIMER,this._adConfig.uid)||(this._addTimerInteraction(EBG.VideoInteraction.FULLSCREEN_DURATION,
EBG.Interactions.Categories.VIDEO),this._addTimerInteraction(EBG.VideoInteraction.VIDEO_PLAY_DURATION,EBG.Interactions.Categories.VIDEO))}catch(c){}this._startTimerHandler(a)},_startTimerHandler:function(a){try{var c=a.eventData.intName,d=this._getAssetIdFromEvent(a);this._startTimer(c,d)}catch(e){}},_stopTimerHandler:function(a){try{var c=a.eventData.intName,d=this._getAssetIdFromEvent(a);this._stopTimer(c,d)}catch(e){}},_getAssetIdFromEvent:function(a){var c=EBGInfra.isDefined(a.eventData.assetId)?
a.eventData.assetId:null;if((!EBGInfra.isDefined(c)||!EBGInfra.notNull(c))&&a.eventData.ebmovie)if(c=0,"0"!=a.eventData.ebmovie){a=EBG.format("ebMovie{0}",a.eventData.ebmovie);if(this._adConfig.assets&&this._adConfig.assets[a])c=this._adConfig.assets[a].assetID;if(this._adConfig.bestAsset&&this._adConfig.bestAsset[a])c=this._adConfig.bestAsset[a].assetID}return c},_updateTimerHandler:function(a){try{var c=a.eventData.intName,d=a.eventData.timerValue;if("ebintduration"==c)c=EBG.Interactions.SystemInts.INT_DURATION,
d/=1E3;this._updateTimer(c,d)}catch(e){}},_startTimer:function(a,c){EBG.intMgr.startTimer(a,this._adConfig.uid,c)},_stopTimer:function(a,c){EBG.intMgr.stopTimer(a,this._adConfig.uid,c)},_updateTimer:function(a,c){EBG.intMgr.updateTimer(a,this._adConfig.uid,c)},_notifiedInteractionHandler:function(a){try{EBG.intMgr.handleCounterInteraction(a.eventData.name,this._adConfig.uid,0,!1,a.eventData)}catch(c){}},_videoInteractionHandler:function(a){try{var c=a.eventData,d=this._getAssetIdFromEvent(a);EBG.intMgr.handleVideoInteraction(c.intName,
this._adConfig.uid,d,c.userInitiated?c.userInitiated:!1)}catch(e){}},_videoFSOpenHandler:function(a){this.isInFullScreenMode=!0;a={eventData:{assetId:this._adConfig.FSMovie.assetID,userInitiated:!0,intName:"ebFSStart"}};this._videoInteractionHandler(a);a=new EBG.Events.Event(EBG.Events.EventNames.FULL_SCREEN_START);a.dispatcher=this;a.eventData="FullScreen";EBG.eventMgr.dispatchEvent(a)},_videoFSCloseHandler:function(){this.isInFullScreenMode=!1;var a={eventData:{assetId:this._adConfig.FSMovie.assetID,
userInitiated:!0,intName:"ebFSEnd"}};a.eventData.assetId=this._adConfig.FSMovie.assetID;this._videoInteractionHandler(a);a=new EBG.Events.Event(EBG.Events.EventNames.FULL_SCREEN_END);a.dispatcher=this;a.eventData="FullScreen";EBG.eventMgr.dispatchEvent(a)},_videoFSAutocloseHandler:function(){},_addSystemInteractions:function(){EBG.callSuperFunction(EBG.Ads.RichAd,this,"_addSystemInteractions");try{var a=EBG.Interactions.Categories.SYSTEM;this._addTimerInteraction(EBG.Interactions.SystemInts.INT_DURATION,
a);this._addTimerInteraction(EBG.Interactions.SystemInts.AD_DURATION,a);this._addTimerInteraction(EBG.Interactions.SystemInts.DWELL_TIME,a);this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE,a,!1,1);this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE,a,!1,1);this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE,a,!1,1);this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER,a,!1,1);
this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_AGENCY,a,!1,1);this._addCounterInteraction(EBG.Interactions.SystemInts.VISIBILITY_IAB,a,!1,1);this._addTimerInteraction(EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION,a);this._addTimerInteraction(EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION,a);this._addTimerInteraction(EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE,a);EBG.adaptor.isInApp()||this._addTimerInteraction(EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE,
a)}catch(c){}},_addCounterInteraction:function(a,c,d,e,f,g){var h=this._adConfig.interactions[EBG.isDefinedNotNull(g)?g:a],i=new EBG.Interactions.CounterInteractionData(a,c,this._adConfig.uid);if(f)i.isPanel=!0;h?EBG.callSuperFunction(EBG.Ads.RichAd,this,"_addCounterInteraction",[a,c,d]):(i.initiationType=EBG.Interactions.InitiationTypes.AUTO,i.numLeftToReport=i.numToReport=e?e:i.numLeftToReport,i.reportImmediately=d?!0:!1,a=new EBG.Interactions.CounterInteraction(i),EBG.intMgr.addInteraction(a,g))},
_addTimerInteraction:function(a,c,d){a=new EBG.Interactions.TimerInteractionData(a,c,this._adConfig.uid);if(d)a.isPanel=d;d=new EBG.Interactions.TimerInteraction(a);EBG.intMgr.addInteraction(d)},_addAggregateInteraction:function(a,c,d){a=new EBG.Interactions.AggregationInteractionData(a,c,this._adConfig.uid);if(d)a.isPanel=d;d=new EBG.Interactions.AggregateInteraction(a);EBG.intMgr.addInteraction(d)},_addVideoInteractions:function(){try{this._addVideoInteraction(EBG.VideoInteraction.STARTED),this._addVideoInteraction(EBG.VideoInteraction.PERCENT_25_PLAYED),
this._addVideoInteraction(EBG.VideoInteraction.PERCENT_50_PLAYED),this._addVideoInteraction(EBG.VideoInteraction.PERCENT_75_PLAYED),this._addVideoInteraction(EBG.VideoInteraction.FULLPLAY),this._addVideoInteraction(EBG.VideoInteraction.MUTE,!0),this._addVideoInteraction(EBG.VideoInteraction.UNMUTE,!0),this._addVideoInteraction(EBG.VideoInteraction.UNMUTED),this._addVideoInteraction(EBG.VideoInteraction.PAUSE,!0),this._addVideoInteraction(EBG.VideoInteraction.REPLAY,!0),this._addVideoInteraction(EBG.VideoInteraction.SLIDER_DRAGGED,
!0),this._addVideoInteraction(EBG.VideoInteraction.FULLSCREEN_START,!0),this._addVideoInteraction(EBG.VideoInteraction.FULLSCREEN_END,!0),this._addVideoInteraction(EBG.VideoInteraction.FULLSCREEN_MUTE,!0),this._addVideoInteraction(EBG.VideoInteraction.FULLSCREEN_PAUSE,!0),this._addVideoInteraction(EBG.VideoInteraction.USER_INITIATED_VIDEO,!1,1)}catch(a){}},_addVideoInteraction:function(a,c,d){a=new EBG.Interactions.CounterInteractionData(a,EBG.Interactions.Categories.VIDEO,this._adConfig.uid);a.initiationType=
c?EBG.Interactions.InitiationTypes.USER:EBG.Interactions.InitiationTypes.AUTO;if(d)a.numLeftToReport=d;c=new EBG.Interactions.CounterInteraction(a);EBG.intMgr.addInteraction(c)},_addCustomInteractions:function(){try{var a=this._adConfig.interactions,c;for(c in a)if(a.hasOwnProperty(c)){var d=EBG.intMgr.adsData[this._adConfig.uid];switch(a[c].type){case 0:d.Counter.hasOwnProperty(c)||c!==EBG.Interactions.SystemInts.CLICK&&c!==EBG.Interactions.SystemInts.DEFAULT_CLICK&&this._addCounterInteraction(c,
EBG.Interactions.Categories.CUSTOM);break;case 1:d.Timer.hasOwnProperty(c)||this._addTimerInteraction(c,EBG.Interactions.Categories.CUSTOM)}}}catch(e){}},subscribeToStandardElementEvents:function(a){var c=new EBG.Events.EventSubscription("mouseover",this._handleMouseEvent,this);c.isElementEvent=!0;c.elementId=a;EBG.eventMgr.subscribeToEvent(c);c=new EBG.Events.EventSubscription("mouseout",this._handleMouseEvent,this);c.isElementEvent=!0;c.elementId=a;EBG.eventMgr.subscribeToEvent(c)},_handleMouseEvent:function(a){var c=
a.currentTarget?a.currentTarget:a.srcElement,d=a.relatedTarget?a.relatedTarget:null,e="",f=c.id,g=f.lastIndexOf("_")+1,h="",h=c.id.split("_"),i=h.length,h=h[i-2]+"_"+h[i-1],h=EBGInfra.isDefined(h)?h:"";g&&(e=f.substring(g));f="mouseover"==a.type?new EBG.Events.Event(EBG.Events.EventNames.MOUSE_OVER):new EBG.Events.Event(EBG.Events.EventNames.MOUSE_OUT);if(!("mouseout"==a.type&&EBGInfra.isDefined(EBG.ads[h])&&EBG.ads[h].isInFullScreenMode))f.dispatcher={_adConfig:{rnd:e}},f.eventData={target:c,relatedTarget:d},
EBG.eventMgr.dispatchEvent(f)},_verifyPlaceHolder:function(){EBG.callSuperFunction(EBG.Ads.RichAd,this,"_verifyPlaceHolder")||EBG.adaptor.addPlaceHolder({tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:this._adConfig.placeHolderId,dir:"ltr"},children:null})},_changeBackgroundImage:function(){this._wallpaper=new EBG.Adaptors.Wallpaper;var a=new EBG.Adaptors.Wallpaper.BgData;a.imgSrc=EBG.combinePaths(this._adConfig.resourcePath,this._adConfig.bgImgSrc);a.tiling=this._adConfig.bgRepeat;a.scrolling=
this._adConfig.bgIgnoreScrolling;a.positionX=this._adConfig.bgPosX;a.positionY=this._adConfig.bgPosY;this._wallpaper.SetBackgroundImage(a)},_removeBackgroundImage:function(){this._wallpaper&&this._wallpaper.RemoveBackgroundImage()},_setStateInCreativeState:function(a){this._adConfig.optOut||(a=EBG.format("{0}{1}/{2}/adServer.bs?cn=SetState&CampaignID={3}&StateValue={4}&ord={5}",EBG.protocol,EBG.bs,"BurstingPipe",this._adConfig.campaignId,a.eventData.stateValue?a.eventData.stateValue:"",EBG.getRandomNumber()),
EBG.adaptor.reportToRemoteServer(a,!0,!0))}};EBG.declareClass(EBG.Ads.RichAd,EBG.Ads.Ad);
EBG.Ads.RichBannerHtml5=function(a){this._updateAdConfig(a);if(EBG.AdaptiveUtils&&a.adaptiveAd){this._adConfig=a;this._verifyPlaceHolder();var c=EBG.adaptor.getElementById(a.placeHolderId),d=a.width&&EBG.isNumber(a.width)?a.width+"px":"100%",e=a.height&&EBG.isNumber(a.height)?a.height+"px":"100%";this.resizePlaceHolder=!1;EBG.adaptor.setElemStyle(c,"width",d);EBG.adaptor.setElemStyle(c,"height",e);this._adaptiveUtils=new EBG.AdaptiveUtils(a);this._adaptiveUtils.updateAdConfig();this._adaptiveUtils.subscribeToEvents()}EBG.callSuperConstructor(EBG.Ads.RichBannerHtml5,
this,[a])};EBG.Ads.RichBannerHtml5.requiresIframeBust=!1;
EBG.Ads.RichBannerHtml5.prototype={_isClickOccur:!1,_CCs:{},_banner:{divId:"",resId:"",width:0,height:0},_canShow:function(){var a=!1;this._adConfig.adHtmlPath?EBG.adaptor.browser.isIE()&&!this._adConfig.isPreview?(a=(this._adConfig.displayWin||EBG.adaptor.getDisplayWin()).document.documentMode,a=9==a&&this._adConfig.isSafeFrame?!1:8<a):a=!0:this._adConfig.imageOnly=!0;return a},_updateAdConfig:function(a){this._updateSVJSON(a)},_updateSVJSON:function(a){var c=EBG.isGlobalDef("ebAdXmlPath")?ebAdXmlPath:
"";if(c&&a.svJSON)a.svPreview=c;if(a.sv3CatalogMap&&a.massVersioning&&a.massVersioning.adVersions&&""!=a.massVersioning.adVersions)versions=0<a.massVersioning.massVersionFolderDivider?EBG.Ads.Ad.Fn.fixMVPathString(a.massVersioning.adVersions,a.massVersioning.massVersionFolderDivider):a.massVersioning.adVersions,a.versions=versions;if(a.massVersioning&&a.massVersioning.versionFullPath&&(a.versions=a.massVersioning.adVersions,c=EBG.isGlobalDef("ebAdJson")?ebAdJson:null))a.versionPreviewJson=c},_subscribeToEvents:function(){EBG.callSuperFunction(EBG.Ads.RichBannerHtml5,
this,"_subscribeToEvents");this._subscribeToAdEvent(EBG.EBMessage.CLICKTHROUGH,this._updateAssetsWithClick);this._subscribeToAdEvent(EBG.EBMessage.SWIPE,function(){EBG.intMgr.handleCounterInteraction(EBG.Interactions.SystemInts.SWIPE,this._adConfig.uid)});this._subscribeToAdEvent(EBG.EBMessage.DISPOSE,function(){var a=new EBG.Events.Event(EBG.Events.EventNames.PAGE_UNLOAD);EBG.eventMgr.dispatchEvent(a)});this._shouldWaitForTriggerAdStart()&&this._subscribeToAdEvent(EBG.EBMessage.TRIGGER_AD_START,
this._triggerAdStart)},_updateAssetsWithClick:function(a){this._isClickOccur=!0;clickedProductId=a&&a.eventData&&a.eventData.isProductClick&&a.eventData.clickedVersion?a.eventData.clickedVersion:null;var a={clickOccur:!0,clickedProductId:clickedProductId},c;for(c in this._CCs)this._CCs.hasOwnProperty(c)&&this._CCs[c].updateClick(a)},_writeCreativeElements:function(){var a=EBG.adaptor.generateElementId("BannerDiv",this._adConfig.uid),c={tagName:EBG.Adaptors.TagNames.DIV,attributes:{id:a,dir:"ltr",
style:{}},children:this._bannerCC.buildCreativeContainerJson()};if("undefined"!=typeof this._adConfig.display)c.attributes.style.display=this._adConfig.display;var d=new EBG.Events.Event(EBG.Events.EventNames.ADD_CREATIVES);d.dispatcher=this;d.eventData={tagsObj:c,assetId:c.children[0]?c.children[0].attributes.id:this._bannerCC.iframeId,isPanel:!1,creativeType:EBG.Events.EventNames.ADD_HTML5_MAIN_CREATIVE};d.timing=EBG.Events.EventTiming.BEFORE;if(!EBG.eventMgr.dispatchEvent(d))EBG.adaptor.addInlineDOM(c,
this._adConfig.placeHolderId),this.bannerDivId=a,this._banner.divId=a,this._banner.width=this._adConfig.width,this._banner.height=this._adConfig.height,d.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.dispatchEvent(d),this.subscribeToStandardElementEvents(a),d.timing=EBG.Events.EventTiming.AFTER,EBG.eventMgr.dispatchEvent(d)},_addCreatives:function(){this._loadBanner()},_loadBanner:function(){this._bannerCC=new EBG.IFrameCC(this._adConfig,{clickOccur:this._isClickOccur});this._bannerCC.iframeId=
EBG.adaptor.generateElementId("BannerIFrame",this._adConfig.uid);this._CCs[this._bannerCC.iframeId]=this._bannerCC;this._bannerCC.setAssetCreativeParams();this._writeCreativeElements()},_shouldWaitForTriggerAdStart:function(){if(!0===this._adConfig.isInstream)return!0},_addSystemInteractions:function(){EBG.callSuperFunction(EBG.Ads.RichBannerHtml5,this,"_addSystemInteractions");if(EBG.adaptor.browser.isMobile())try{var a=new EBG.Interactions.CounterInteractionData(EBG.Interactions.SystemInts.SWIPE,
EBG.Interactions.Categories.SYSTEM,this._adConfig.uid);a.initiationType=EBG.Interactions.InitiationTypes.USER;var c=new EBG.Interactions.CounterInteraction(a);EBG.intMgr.addInteraction(c,EBG.Interactions.SystemInts.SWIPE)}catch(d){}},_getBannerLocation:function(){var a;if(this._bannerCC&&this._bannerCC.iframeId)a=EBG.adaptor.getPositioningById(this._bannerCC.iframeId,!0,this._adConfig.actualServingMode);else if(this._preloadImgResId)a=EBG.adaptor.getPositioningById(this._preloadImgResId);else return null;
return EBG.callSuperFunction(EBG.Ads.RichBannerHtml5,this,"_getBannerLocation",[a])},_getAdCodeBase:function(){return EBG.callSuperFunction(EBG.Ads.RichBannerHtml5,this,"_getAdCodeBase",[2])},_switchAssetsAfterThrottle:function(){},_shouldCheckIfFlashBlocked:function(){return!1}};EBG.declareClass(EBG.Ads.RichBannerHtml5,EBG.Ads.RichAd);EBG.declareNamespace("CreativeContainer");EBG.CreativeContainer=function(a){this._adConfig=a};EBG.declareClass(EBG.CreativeContainer,null);EBG.declareNamespace("IFrameCC");
EBG.IFrameCC=function(a,c){EBG.callSuperConstructor(EBG.IFrameCC,this,[a]);this._isClickOccur=c.clickOccur;this._isEBInitialized=!1;this._isDocLoaded=!1;this._iframe=null;this.iframeId=null;this._isReqInitReceived=!1;this._assetCreativeParams=null;if(!EBG.adaptor.isReady()){var d=new EBG.Events.EventSubscription(EBG.EBMessage.ADAPTOR_READY,this._checkSendInit,this);d.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.subscribeToEvent(d)}this.pm=EBG.pm;this.useFriendlyIframe=this._adConfig.isSafeFrame||
this._adConfig.isSkype;this._registerToEvents();this._listenToMessages();this._videoAssetsActive=[]};
EBG.IFrameCC.prototype={_isContentLoading:!1,_videoAssetsActive:null,isAssetFullyLoaded:function(){return this._isEBInitialized&&this._isDocLoaded},isEBInitialized:function(){return this._isEBInitialized},isDocLoaded:function(){return this._isDocLoaded},updateClick:function(a){this._isClickOccur=a.clickOccur;this._sendMessage(EBG.EBMessage.UPDATE_CLICK,a)},setAssetCreativeParams:function(){if(this._adConfig.AdCreativeParams)this._assetCreativeParams=this._adConfig.AdCreativeParams},_handleMessage:function(a,
c){if(this._iframe)if(this._iframe.contentWindow){if(c.source===this._iframe.contentWindow){var d=JSON.parse(c.data);if(d)switch(d.type){case EBG.EBMessage.REQ_INIT:this._isReqInitReceived=!0;(EBG.adaptor.isReady()||!EBG.adaptor.isSDKDefined())&&this._sendInitToCreative();break;case EBG.EBMessage.INITDONE:this._handleInitDone();break;case EBG.EBMessage.GET_ENVIROMENT:this._sendAdKitData(d.type);break;case EBG.EBMessage.CLOSE_AD:this._dispatchCloseAdEvent();break;default:this._handleGeneralMessage(d)}}}else EBG.runTimed(this,
this._handleMessage,[a,c],20);else this._getIframeElement(),EBG.runTimed(this,this._handleMessage,[a,c],20)},_handleGeneralMessage:function(a){var c=new EBG.Events.Event(a.type);c.dispatcher=this;if(a.data&&(c.eventData=a.data,c.eventData&&c.eventData.command))this[c.eventData.command](c.eventData);EBG.eventMgr.dispatchEvent(c);this.handleIntMonitor(a)},handleIntMonitor:function(a){if(EBG.adaptor.intMonitorExist()){var c=new EBG.Events.Event(EBG.EBMessage.NOTIFY_INTERACTION_MONITOR);c.eventData=this._createIntMonitorObj(a);
EBG.eventMgr.dispatchEvent(c)}},_handleInitDone:function(){this._isContentLoading=!1;this._isEBInitialized=!0;var a=new EBG.Events.Event(EBG.Events.EventNames.CREATIVE_CONTAINER_READY);a.dispatcher=this;a.eventData=this.iframeId;EBG.eventMgr.dispatchEvent(a);if(EBG.adaptor.isPageLoaded())a=new EBG.Events.Event(EBG.Events.EbEventNames.PAGE_LOAD),a.dispatcher=this,this._handleEvents(a)},_saveAssetSrc:function(a){a.src=this.iframeId},_registerVideo:function(a){-1==EBGInfra.indexOfArray(this._videoAssetsActive,
a.assetId)&&this._videoAssetsActive.push(a.assetId)},_unregisterVideo:function(a){if(0<this._videoAssetsActive.length)var c=EBGInfra.indexOfArray(this._videoAssetsActive,a.assetId);this._videoAssetsActive.splice(c,1)},notifyDocLoaded:function(a){this._isDocLoaded=!0;this._saveAssetSrc(a)},getWidth:function(){return EBG.isDefinedNotNull(this._adConfig.width)?this._adConfig.width:this.getActualSize().width},getHeight:function(){return EBG.isDefinedNotNull(this._adConfig.height)?this._adConfig.height:
this.getActualSize().height},getActualSize:function(){var a=EBG.adaptor.getElementById(this.iframeId);return a?EBG.adaptor.getBoundingClientRect(a):{width:0,height:0}},getAdPartsData:function(){var a={type:EBG.adParts.BANNER,adkitConfigUrl:this._adConfig.assets["config.js"]?this._adConfig.resourcePath+this._adConfig.assets["config.js"].dsPath:""};a.width=a.containerWidth=this.getWidth();a.height=a.containerHeight=this.getHeight();return a},_sendAdKitData:function(a){var c=EBG.cloneObj(this._adConfig.adKitData),
d=EBG.ads&&this._adConfig&&this._adConfig.uid&&EBG.ads[this._adConfig.uid]?EBG.ads[this._adConfig.uid]._adaptiveUtils:null;if(d){c.adParts=c.adParts||{};c.adParts.type=EBG.adParts.BANNER;c.adParts.adkitConfigUrl=this._adConfig.assets["config.js"]?this._adConfig.resourcePath+this._adConfig.assets["config.js"].dsPath:"";var d=d.getAsset(),e=this.getActualSize();if(d)c.adParts.name=d.name,c.adParts.width=d.width,c.adParts.height=d.height;if(e)c.adParts.containerWidth=e.width,c.adParts.containerHeight=
e.height,c.actualWidth=e.width,c.actualHeight=e.height}else c.adParts=this.getAdPartsData();this._sendMessage(a,c)},_createIntMonitorObj:function(a){var c="";if(a)switch(a.type){case EBG.EBMessage.VIDEO_INTERACTION:a.data&&(c=EBG.format("'{0}',{1}",a.data.intName,a.data.ordinalNum));break;case EBG.EBMessage.EXPAND:case EBG.EBMessage.COLLAPSE:c=this._handleSpecialInt(a);break;default:c=a.data.intName}return{command:a.type,args:c,objName:this.iframeId,adId:this._adConfig.adId}},_handleSpecialInt:function(a){var c=
"";switch(a.type){case EBG.EBMessage.EXPAND:c=a.data&&EBGInfra.isDefinedNotNull(a.data.panelName)?a.data.panelName:"";c+=a.data&&EBGInfra.isDefinedNotNull(a.data.actionType)&&""!=a.data.actionType?","+a.data.actionType:",User";break;case EBG.EBMessage.COLLAPSE:c=a.data&&EBGInfra.isDefinedNotNull(a.data.panelName)?a.data.panelName:""}return c},_listenToMessages:function(){for(var a in EBG.EBMessage)EBG.EBMessage.hasOwnProperty(a)&&(a=EBG.EBMessage[a],EBG.pm.bind(a,this._handleMessage,this,this._adConfig.displayWin||
EBG.adaptor.getDisplayWin()))},_sendMessage:function(a,c){this._iframe&&(this.useFriendlyIframe?EBG.runTimed(this,function(){this._iframe.contentWindow.EBG.pm.dispatch(a,c,window,this._iframe.contentWindow)},[],1):EBG.pm({target:this._iframe.contentWindow,type:a,data:c}))},_handleEvents:function(a){this._isEBInitialized&&this._sendMessage(a.name,a.eventData)},_registerToEvents:function(){for(var a in EBG.Events.EbEventNames)EBG.Events.EbEventNames.hasOwnProperty(a)&&EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EbEventNames[a],
this._handleEvents,this))},_dispatchCloseAdEvent:function(){var a=new EBG.Events.Event(EBG.Events.EventNames.CLOSE_AD);a.dispatcher=this;a.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.dispatchEvent(a)},_checkSendInit:function(){this._isReqInitReceived&&this._sendInitToCreative()},_sendInitToCreative:function(){if(this._adConfig){var a={assetCreativeParams:this._assetCreativeParams,clickOccur:this._isClickOccur,clickedProductIds:this._getClickedProductIDs(),adConfig:this._adConfig,ffs:EBG.serverResponses[this._adConfig.uid].ffs,
dsBasePath:this._adConfig.resourcePath,events:EBG.Events.EbEventNames,assetId:this.iframeId};this._sendMessage(EBG.EBMessage.INIT,a)}},_getIframeElement:function(){var a=EBG.adaptor.getElementById(this.iframeId);a?(this._iframe=a,this.useFriendlyIframe&&!this._isContentLoading&&this._loadContentToIframe(this.getIframePath())):EBG.runTimed(this,this._getIframeElement,[],20)},_loadContentToIframe:function(a){this._isContentLoading=!0;var c=a.split("/");c.pop();var c=c.join("/")+"/",d=a.match(/\?.*$/)[0],
e=this._adConfig.adKitData;e.adParts=this.getAdPartsData();var f=this;this._getAssetHtmlContent(a,function(a){a?(a='<base href="'+c+'"/>'+a,f._iframe.contentWindow.document.open(),f._iframe.contentWindow.ebSafeFrame={pm:function(a){a&&EBG.runTimed(f,function(){f.pm.dispatch(a.type,a.data,f._iframe.contentWindow,a.target)},[],1)},getClickTagUrl:function(){return EBG.intMgr.getClickTag(f._adConfig.uid)},getAdKitData:function(){return{data:JSON.stringify({data:e,type:EBG.EBMessage.GET_ENVIROMENT}),source:window}}},
f._iframe.contentWindow.ebQueryString=d,f._iframe.contentWindow.document.write(a),setTimeout(function(){f._iframe.contentWindow.document.close()},200)):f._isContentLoading=!1})},_getAssetHtmlContent:function(a,c){EBG.adaptor.getDataFromRemoteServer(a,function(a){c(a)},this,!0,!1)},_buildIfrmSrc:function(a){a=EBG.format("{0}?v={1}",EBG.combinePaths(this._adConfig.resourcePath,a),EBG.html5Ver);this._adConfig.ffs.CFF_EBLoaderNew&&this._adConfig.useAsyncEBLoader&&(a+="&n=1");this._adConfig.pluId&&(a+=
"&plu="+this._adConfig.pluId,this._adConfig.sHost&&(a+="&sHost="+this._adConfig.sHost));this._adConfig.isClickTag&&(a=EBG.format("{0}&clickTag={1}",a,escape(EBG.intMgr.getClickTag(this._adConfig.uid))));EBG.isPreview&&(a=EBG.format("{0}&isPreview={1}",a,"1"));return a},buildCreativeContainerJson:function(){var a=this.useFriendlyIframe?this.getFriendlyIframePath():this.getIframePath(),a={tagName:EBG.Adaptors.TagNames.IFRAME,attributes:{id:this.iframeId,src:a,onload:EBG.format('(function(e) { var event = new EBG.Events.Event(EBG.Events.EventNames.ELEMENT_LOADED);event.dispatcher = this;event.eventData = { DOMEvent: e, elementId: "{0}", adUId:"{1}" };event.timing = EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(event);} )(typeof arguments != "undefined" ? arguments[0] : null);',
this.iframeId,this._adConfig.uid),width:this._adConfig.width?this._adConfig.width:"100%",height:this._adConfig.height?this._adConfig.height:"100%",allowfullscreen:!0}};this._getIframeElement();return[a]},getIframePath:function(){return this._buildIfrmSrc(this._adConfig.adHtmlPath)},getFriendlyIframePath:function(){return EBG.adaptor.browser.isIE()&&11>EBG.adaptor.browser.getVersion()?"javascript:'<script>window.onload=function(){document.write(\\'<script>document.domain=\\\""+document.domain+"\\\";<\\\\/script>\\');document.close();};<\/script>'":
""},_getClickedProductIDs:function(){return this._adConfig.uid&&EBG.intMgr.adsData[this._adConfig.uid]&&EBG.isArray(EBG.intMgr.adsData[this._adConfig.uid].isProductClicked)?EBG.intMgr.adsData[this._adConfig.uid].isProductClicked:[]}};EBG.declareClass(EBG.IFrameCC,EBG.CreativeContainer);EBG.declareNamespace("BWDetection");
EBG.BWDetection={checked:!1,checking:!1,speed:0,_adjustment:0.75,_images:[{path:EBG.format("{0}{1}micro.gif",ebPtcl,ebO.sms),bytes:51,start:null,end:null},{path:EBG.format("{0}{1}micro.gif",ebPtcl,ebO.sms),bytes:51,start:null,end:null},{path:EBG.format("{0}{1}bw_image.png",ebPtcl,ebO.sms),bytes:43677,start:null,end:null}],_loaded:0,_loadImage:function(a){this._images[a].start=(new Date).getTime();var c=new Image,d=Math.random();c.onload=function(){EBG.BWDetection._imageLoaded(a)};c.src=this._images[a].path+
"?rnd="+d},_imageLoaded:function(a){this._images[a].end=(new Date).getTime();this._loaded++;this._loaded==this._images.length&&this._calculateSpeed()},_dispatchEvent:function(){var a=new EBG.Events.Event(EBG.Events.EventNames.BANDWITH_DETECTED);a.dispatcher=this;a.eventData=this.speed;EBG.eventMgr.dispatchEvent(a)},_calculateSpeed:function(){var a=Math.min(this._images[0].end-this._images[0].start,this._images[1].end-this._images[1].start),c=this._images[2].end-this._images[2].start,d=c,e=this._images[2].bytes;
c>a&&(d=c-a,e-=this._images[0].bytes);this.speed=Math.round(8*(e/(d/1E3)/1024))*this._adjustment;if(Infinity==this.speed)this.speed=25E3;this.checked=!0;this.checking=!1;this._dispatchEvent()},init:function(){this.checking=!0;this._loadImage(0);this._loadImage(1);this._loadImage(2);var a=this;setTimeout(function(){if(!a.checked)a.speed=56,a.checked=!0,a.checking=!1,a._dispatchEvent()},5E3)}};var tempExtensionHook=ebO.extensionHooks;
try{ebO.extensionHooks.splice(0,0,function(a,c){function d(){if(EBG.RichModules&&EBG.RichModules.VisibilityManager&&EBG.RichModules.VisibilityManager.prototype)EBG.RichModules.VisibilityManager.prototype.checkVisibility=function(a){a=a?EBG.cloneObj(a):{};if(!EBG.isDefined(a.percentage)||!EBG.isNumber(a.percentage))a.percentage=this.calculateVisibilityPercentage();if(EBG.isDefinedNotNull(a.percentage)&&0<=a.percentage){if(!("viewPort"in a))a.viewPort=this.getViewPortMetrics();if(this._adCoveragePercentage)a.percentage=
Math.max(a.percentage-this._adCoveragePercentage,0);this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&this._calculateAverages(a);for(var c in EBG.RichModules.VisibilityManager.ThreholdType)EBG.RichModules.VisibilityManager.ThreholdType.hasOwnProperty(c)&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[c]]&&this._visibilityData[EBG.RichModules.VisibilityManager.ThreholdType[c]].isActive&&this._execCheckVisibility(a.percentage,EBG.RichModules.VisibilityManager.ThreholdType[c])}};
if(EBG.RichModules&&EBG.RichModules.AdStackingDetector)EBG.RichModules.AdStackingDetector=function(a,c){this._adConfig=a;this._isFriendlyIframe=this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME||this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.TOPMOST_FRIENDLY_IFRAME&&window.frameElement;this._isPanel=c;this._elementsIds=[];this._validElementParents=[];this._visibilityEvent={};if(this._shouldInitialize()){this._validElementParents.push(a.placeHolderId);EBG.Const.OUTER_DIV&&
this._validElementParents.push(EBG.Const.OUTER_DIV);var d=new EBG.Events.EventSubscription(EBG.Events.EventNames.VISIBILITY_CHECK,this._handleVisibilityEvent,this);d.dispatcherFilters={"adConfig.rnd":this._adConfig.rnd};d.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.subscribeToEvent(d);this._adConfig.adStarted?this._start():(d=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,function(){this._start()},this),d.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(d))}},
EBG.RichModules.AdStackingDetector.prototype={_interactionThreshold:100,_analyzeInterval:200,_densityFactor:5,_prevPercentage:0,_minThresholdForAdStacking:50,_generatePointsGrid:function(a){for(var c=[],d=(a.height-2)/this._densityFactor,a=(a.width-2)/this._densityFactor,h=0;h<=this._densityFactor;h++)for(var i=0;i<=this._densityFactor;i++)c.push({x:Math.round(a*h),y:Math.round(d*i)});return c},_handleVisibilityEvent:function(a){if(~EBGInfra.indexOfArray(this._elementsIds,a.dispatcher._resObjId))this._visibilityEvent=
EBG.cloneObj(a.eventData)},_shouldInitialize:function(){if(this._adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&this._adConfig.actualServingMode!=EBG.Adaptors.ServingMode.IFRAME)return this._adConfig.actualServingMode==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME&&window.parent!==top?!1:!0},_start:function(){EBG.setInterval(this,this._analyze,[],this._analyzeInterval)},_analyze:function(){var a=this._calculateConcealmentPercentage();if(!this._adStackingReported&&a.visible>=this._interactionThreshold&&
this._visibilityEvent.percentage>=this._minThresholdForAdStacking)EBG.intMgr.handleCounterInteraction((this._isPanel?"P":"")+EBG.Interactions.SystemInts.AD_STACKING,this._adConfig.uid),this._adStackingReported=!0;if(a.full!=this._prevPercentage){this._prevPercentage=a.full;var c=new EBG.Events.Event(this._isPanel?"P":""+EBG.Events.EventNames.AD_STACKING);c.eventData={intName:(this._isPanel?"P":"")+EBG.Interactions.SystemInts.AD_STACKING,percentage:a.full};c.dispatcher=this;c.timing=EBG.Events.EventTiming.BEFORE;
if(!EBG.eventMgr.dispatchEvent(c))c.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER,EBG.eventMgr.dispatchEvent(c)}},_calculateConcealmentPercentage:function(){var a={full:0,visible:0};try{if(!this._elementsIds.length)return a;var c=EBG.adaptor.serving._getTopFriendlyIframe(this._adConfig.displayWin||EBG.adaptor.getDisplayWin()),d=EBG.adaptor.getElementById(this._assetId),h=EBG.adaptor.getBoundingClientRect(d,{clip:!0,relativeToTop:!0});if(!d||!d.offsetWidth||!d.offsetHeight||this._visibilityEvent.assetId!=
this._assetId)return a;var i=this._visibilityEvent.visibleRect,d=i||h;if(!d||0==d.width||0==d.height)return a;this._grid=this._generatePointsGrid(d);for(var j=0,k=0;k<this._grid.length;k++){var l=this._grid[k];l.x+=Math.floor(d.left)+1;l.y+=Math.floor(d.top)+1;var m=c.document.elementFromPoint(l.x,l.y);if(m&&(!m.id||-1==EBG.indexOfArray(this._elementsIds,m.id)))(!this._isFriendlyIframe||m!=window.frameElement)&&!this._hasValidParent(m)&&!this._isElementTransparent(m)&&j++}var o=i?i.width*i.height/
(h.width*h.height):1,n=Math.round(100*(j/this._grid.length));return{full:Math.ceil(n*o),visible:n}}catch(q){return a}},addElementId:function(a,c){if(-1==EBGInfra.indexOfArray(this._elementsIds,a)&&(this._elementsIds.push(a),c))this._assetId=a},_invisibleProperties:{visibility:"hidden",display:"none",opacity:function(a){return 0==1*a},"-moz-opacity":function(a){return EBG.adaptor.browser.isFF()&&0==1*a},"-khtml-opacity":function(a){return EBG.adaptor.browser.isSafari()&&0==1*a},filter:function(a){return EBG.adaptor.browser.isIE()&&
10>EBG.adaptor.browser.getVersion()&&-1!=EBG.indexOfArray(["alpha(opacity=0)","progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"],a)},"background-color":function(a,c,d){var h=function(a){var c=a.replace(/^\s+|\s+$/g,"").match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);return c&&0==1*c[4]||"transparent"==a},i=c.innerText||c.textContent,j=EBG.adaptor.browser.isIE()&&9>EBG.adaptor.browser.getVersion(),d=d.getPropertyValue("color");return h(a)&&-1==EBG.indexOfArray("object,canvas,video,source,track,iframe,embed,img".split(","),
c.tagName.toLowerCase())&&(!i||!j&&h(d))}},_isElementTransparent:function(a){var c=EBG.adaptor.getComputedStyle(a),d=this._invisibleProperties,h,i;for(i in d){var j=c.getPropertyValue(i);if(j)for(var k=EBG.isArray(d[i])?d[i]:[d[i]],l=0;l<k.length;l++)if(h=EBG.isFunc(k[l])?k[l](j,a,c):j==k[l])return!0}return!1},_hasValidParent:function(a){if(!a)return!1;for(var c=a.id;a.parentElement;){if(a.parentElement.id&&-1!=EBG.indexOfArray(this._validElementParents,a.parentElement.id))return this.addElementId(c,
!1),!0;a=a.parentElement}return!1}},EBG.declareClass(EBG.RichModules.AdStackingDetector,null);if(EBG.RichModules&&EBG.RichModules.GeometricVisibilityProvider)EBG.RichModules.GeometricVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.GeometricVisibilityProvider,this,[a,c])},EBG.RichModules.GeometricVisibilityProvider._isAvailable=function(a){var c=!0,d=a.actualServingMode==EBG.Adaptors.ServingMode.IFRAME,h=EBG.Initializer._getAdClass({tn:a.templateName}),i=!h.requiresIframeBust&&
!a.UiVz,h=h.requiresIframeBust&&!EBG.iframeLocation&&a.aiE&&!a.aiE.iflExists;if(d&&(i||h)||a.ffs.CFF_MRAIDVis&&EBG.adaptor.isInApp())c=!1;return c},EBG.RichModules.GeometricVisibilityProvider.prototype={name:"Geometric",_focusOnResourceElem:null,_justReceivedFocusOnPage:null,_reachedMaxAdDuration:!1,_calculateVisibilityPercentage:function(a){try{if(!EBG.adaptor.isPageVisible())return 0;var a=a||{},c=this._getAssetRect(a.resourceObjId||this._resObjId),d=this._getViewPortRect();c.top+=~~a.offsetY;c.bottom+=
~~a.offsetY;c.left+=~~a.offsetX;c.right+=~~a.offsetX;if(EBG.isDefined(a.width))c.width=a.width,c.right=c.left+a.width;if(EBG.isDefined(a.height))c.height=a.height,c.bottom=c.top+a.height;if(this._intersect(c,d)){var h=this._overlap(d,c);this._visibleRect=h;return~~(100*(h.width*h.height/(c.width*c.height)))}return 0}catch(i){return 0}},_getAssetRect:function(a){a=EBG.adaptor.getElementById(a);return EBG.adaptor.getBoundingClientRect(a,{clip:!0,relativeToTop:!0})},_getViewPortMetrics:function(){var a=
EBG.adaptor._getCurrentWindow(void 0,this.adConfig.actualServingMode),c=EBG.adaptor.getWindowViewPortMetrics(a);if(EBG.adaptor.browser.isFF()&&"undefined"!=typeof a.outerWidth&&EBG.adaptor.serving.detectServingMode(!0)==EBG.Adaptors.ServingMode.IFRAME&&("undefined"==typeof this.adConfig||!EBG.isDefined(this.adConfig.UiVz)||!this.adConfig.UiVz)&&!EBG.iframeLocation&&"undefined"!=typeof this.adConfig&&this.adConfig.aiE&&!this.adConfig.aiE.iflExists)c.Width=a.outerWidth,c.Height=a.outerHeighth,EBG.isDefined(a.scrollMaxX)&&
0<a.scrollMaxX&&EBG.isDefined(EBG.adaptor.scrollBarWidth)&&0<EBG.adaptor.scrollBarWidth&&(c.Height-=EBG.adaptor.scrollBarWidth),EBG.isDefined(a.scrollMaxY)&&0<a.scrollMaxY&&EBG.isDefined(EBG.adaptor.scrollBarHeight)&&0<EBG.adaptor.scrollBarHeight&&(c.Width-=EBG.adaptor.scrollBarHeight);return c},_getViewPortRect:function(){var a=this._getViewPortMetrics();return{top:0,left:0,right:a.Width,bottom:a.Height}},_overlap:function(a,c){var d={top:-1,right:-1,bottom:-1,left:-1};if(!this._intersect(a,c))return d;
d.top=Math.max(a.top,c.top);d.left=Math.max(a.left,c.left);d.right=Math.min(a.right,c.right);d.bottom=Math.min(a.bottom,c.bottom);d.width=d.right-d.left;d.height=d.bottom-d.top;return d},_intersect:function(a,c){return!(c.left>a.right||c.right<a.left||c.top>a.bottom||c.bottom<a.top)},_isVisible:function(a){var a=a||{},c=EBG.adaptor.getBoundingClientRect(this._res,{clip:!0});return!!this._calculateVisibilityPercentage({resourceObjId:a.resourceObjId||this._resObjId,width:a.width||c.width,height:a.height||
c.height,offsetX:a.offsetX||this.adConfig.offsetX,offsetY:a.offsetY||this.adConfig.offsetY,isUIVZ:a.isUIVZ||this.adConfig.UiVz,actualServingMode:a.actualServingMode||this.adConfig.actualServingMode})},_subscribeToEvents:function(){try{EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"_subscribeToEvents");EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_RESIZE,this._pageResizeHandler,this));EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_SCROLL,
this._pageScrollHandler,this));if(!EBG.adaptor._getVisibilityEventName()||EBG.adaptor.browser.isAndroidNative()&&4.4>EBG.adaptor.browser.getVersion())EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_FOCUS,this._pageFocusHandler,this)),EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_BLUR,this._pageBlurHandler,this)),this._subscribeToElementEvents();var a=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_HIDDEN,
this._pageHiddenHandler,this);a.isDocumentEvent=!0;EBG.eventMgr.subscribeToEvent(a);a=new EBG.Events.EventSubscription(EBG.Events.EventNames.PAGE_VISIBLE,this._pageVisibleHandler,this);a.isDocumentEvent=!0;EBG.eventMgr.subscribeToEvent(a);EBG.eventMgr.subscribeToEvent(new EBG.Events.EventSubscription(EBG.Events.EventNames.RICH_FLASH_PLAYED,this.onChange,this))}catch(c){}},_subscribeToElementEvents:function(){var a=this,c=function(){a._resourceBlurHandler()},d=new EBG.Events.EventSubscription("focus",
function(){a._resourceFocusHandler()},this);d.isElementEvent=!0;d.elementId=this._resObjId;EBG.eventMgr.subscribeToEvent(d);if(EBG.adaptor.browser.isIE()&&this.actualServingMode!=EBG.Adaptors.ServingMode.SCRIPT)d=new EBG.Events.EventSubscription("blur",c,this),d.isElementEvent=!0,d.elementId=this._resObjId,EBG.eventMgr.subscribeToEvent(d)},updateResourceObjId:function(a){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"updateResourceObjId",[a]);EBG.adaptor._getVisibilityEventName()||
this._subscribeToElementEvents()},_pageVisibleHandler:function(){this._dispatchCheckVisibility(this._calculateVisibilityResult())},_pageHiddenHandler:function(){this._dispatchVisibilityHidden();this.adConfig.visibility.mode==EBG.VisibilityMode.ENHANCED_MODE&&this._dispatchCheckVisibility({percentage:0,viewPort:this._getViewPortMetrics()})},_resourceFocusHandler:function(){this._focusOnResourceElem=!0;EBG.runTimed(this,function(){this._focusOnResourceElem=!1},[],60);this._pageFocusHandler()},_resourceBlurHandler:function(){EBG.runTimed(this,
function(){!this._justReceivedFocusOnPage&&!this._focusOnResourceElem&&this._pageBlurHandler()},[],30)},_pageFocusHandler:function(){this._justReceivedFocusOnPage=!0;EBG.runTimed(this,function(){this._justReceivedFocusOnPage=!1},[],60);this._dispatchCheckVisibility(this._calculateVisibilityResult())},_pageBlurHandler:function(){EBG.runTimed(this,function(){this._justReceivedFocusOnPage||this._pageHiddenHandler()},[],30)},_pageScrollHandler:function(){this._dispatchCheckVisibility(this._calculateVisibilityResult())},
_pageResizeHandler:function(){if(!this._resizeTimeOut){var a=this;this._resizeTimeOut=setTimeout(function(){a._resizeTimeOut=null;var c=a._calculateVisibilityResult();a._dispatchCheckVisibility(c)},100)}},_maxAdDurationHandler:function(){this._reachedMaxAdDuration=!0},start:function(){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"start");var a=3;(function(){a--&&(this._dispatchCheckVisibility(this._calculateVisibilityResult()),EBG.runTimed(this,arguments.callee,[],1E3))}).apply(this)},
onElementMoved:function(){EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"onElementMove");this._dispatchCheckVisibility(this._calculateVisibilityResult())},onChange:function(){this._dispatchCheckVisibility(this._calculateVisibilityResult())},_calculateVisibilityResult:function(){var a=EBG.callSuperFunction(EBG.RichModules.GeometricVisibilityProvider,this,"_calculateVisibilityResult");a.visibleRect=this._visibleRect;return a}},EBG.declareClass(EBG.RichModules.GeometricVisibilityProvider,
EBG.RichModules.BasicVisibilityProvider),EBG.RichModules.FFVisibilityProvider=function(a,c){EBG.callSuperConstructor(EBG.RichModules.FFVisibilityProvider,this,[a,c])},EBG.RichModules.FFVisibilityProvider._isAvailable=function(a){return(EBG.adaptor.browser.isFF()||EBG.adaptor.browser.isSafari()&&(8<=EBG.adaptor.browser.getVersion()||6<=EBG.adaptor.browser.getVersion()&&!EBG.adaptor.browser.isMac()))&&a.actualServingMode==EBG.Adaptors.ServingMode.IFRAME},EBG.RichModules.FFVisibilityProvider.prototype=
{name:"FF",_focusOnResourceElem:null,_justReceivedFocusOnPage:null,_reachedMaxAdDuration:!1,_getInnerFrameTopLeft:function(){return EBG.adaptor.getIframePosition()},_getViewPortTopLeft:function(){var a=EBGInfra.callSuperFunction(EBG.RichModules.FFVisibilityProvider,this,"_getViewPortTopLeft");return{X:(this.adConfig.displayWin||EBG.adaptor.getDisplayWin()).screenX+a.X,Y:(this.adConfig.displayWin||EBG.adaptor.getDisplayWin()).screenY+a.Y}},_getViewPortRect:function(){var a=this._getViewPortMetrics(),
c=Math.max(0,~~window.screenY),d=Math.max(0,~~window.screenX);return{top:c+(window.fullScreen?0:70),left:d,right:d+a.Width,bottom:c+a.Height}},_getViewPortMetrics:function(){var a=this.adConfig.displayWin||EBG.adaptor.getDisplayWin(),c={Height:0,Width:0};if(EBG.isDefined(a.outerWidth)&&(0<a.outerWidth||0<a.outerHeight))c.Width=a.outerWidth,c.Height=a.outerHeight;else if(EBG.isDefined(a.screen.availWidth))c.Width=a.screen.availWidth,c.Height=a.screen.availHeight;EBG.isDefined(a.scrollMaxX)&&0<a.scrollMaxX&&
EBG.isDefined(EBG.adaptor.scrollBarWidth)&&0<EBG.adaptor.scrollBarWidth&&(c.Height-=EBG.adaptor.scrollBarWidth);EBG.isDefined(a.scrollMaxY)&&0<a.scrollMaxY&&EBG.isDefined(EBG.adaptor.scrollBarHeight)&&0<EBG.adaptor.scrollBarHeight&&(c.Width-=EBG.adaptor.scrollBarHeight);return c},_subscribeToEvents:function(){EBG.runTimed(this,this._visibilityPollingCheck,[],EBG.RichModules.VisibilityManager.VisibilityPollingTimer)},_visibilityPollingCheck:function(){this._reachedMaxAdDuration||(this._dispatchCheckVisibility(this._calculateVisibilityResult()),
EBG.runTimed(this,this._visibilityPollingCheck,[],EBG.RichModules.VisibilityManager.VisibilityPollingTimer))},_getAssetRect:function(a){a=EBGInfra.callSuperFunction(EBG.RichModules.FFVisibilityProvider,this,"_getAssetRect",[a]);a.top+=~~window.mozInnerScreenY;a.left+=~~window.mozInnerScreenX;a.bottom+=~~window.mozInnerScreenY;a.right+=~~window.mozInnerScreenX;return a}},EBG.declareClass(EBG.RichModules.FFVisibilityProvider,EBG.RichModules.GeometricVisibilityProvider),EBG.RichModules.VisibilityManager.prototype._availableVisibilityProviders=
[EBG.RichModules.GeometricVisibilityProvider,EBG.RichModules.SafeFrameVisibilityProvider,EBG.RichModules.MouseVisibilityProvider,EBG.RichModules.GridVisibilityProvider,EBG.RichModules.FlashVisibilityProvider,EBG.RichModules.FFVisibilityProvider,EBG.RichModules.MraidVisibilityProvider]}EBG.getFeatureFlagValue(c.ffs,"CFF_VisibilityExtension")&&d()})}catch(e$$99){ebO.extensionHooks=tempExtensionHook}tempExtensionHook=ebO.extensionHooks;
try{ebO.extensionHooks.splice(0,0,function(a,c){function d(){c.adConfig.UiVz=!1;if(EBG.Adaptors&&EBG.Adaptors.ServingMgr&&EBG.Adaptors.ServingMgr.prototype)EBG.Initializer._initServingMode=function(a){var c=this._getAdClass(a);a.requiresIframeBust=c.requiresIframeBust;var d=EBGInfra.isDefined(EBG.adaptor.serving)?EBG.adaptor.serving.detectServingMode(!0):null;if(EBG.adaptor.isSafeFrame())a.ifrm=0,a.adConfig.UiVz=!1;else{if(c.requiresIframeBust){if(!a.ifrm||a.soi)a.ifrm=0;if(a.innerIframe)a.ifrm=EBG.Adaptors.ServingMode.INNER_IFRAME;
EBG.adaptor.initServingMode(a.ifrm,!1,d)}else if(a.ifrm=0,c!=EBG.Ads.StdBanner&&c!=EBG.Ads.StdBannerHtml5&&(EBG.adaptor.initServingMode(a.ifrm,!c.requiresIframeBust,d),d==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME))try{document.close()}catch(e){}if(EBG.adaptor.inPlacementIframe()||!c.requiresIframeBust&&!a.innerIframe&&d==EBG.Adaptors.ServingMode.IFRAME&&!EBG.adaptor.isSkype()&&c!=EBG.Ads.StdBanner&&c!=EBG.Ads.StdBannerHtml5&&!EBG.adaptor.isSafeFrame())if(c.requiresIframeBust||a.IABBV||a.IABEV||a.invVis)a.ifrm=
1,c=new EBG.Events.EventSubscription(EBG.Events.EventNames.AIE_LOADED,this._handleAieLoad,this),c.dispatcherFilters={"_adConfig.rnd":a.rnd,"_adConfig.templateName":a.tn},c.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.subscribeToEvent(c),EBG.adaptor.serving.handleAieServing(a)}},EBG.Adaptors.ServingMgr.prototype.checkAie=function(a,d,e){EBG.serverResponses=EBG.serverResponses||{};EBG.serverResponses[a.adConfig.uid]||(EBG.serverResponses[a.adConfig.uid]=a);e.ebO=EBG.cloneObj(a);if(EBG.adaptor.browser.isIE()&&
9>EBG.adaptor.browser.getVersion())try{delete e.ebO.ut,delete e.ebO.fru}catch(i){e.ebO.ut="",e.ebO.fru=""}EBG.iframeLocation?d.apply(e,['{"iflExists":1,"iflCheck":0}']):EBG.isDefinedNotNull(c.aiE)&&EBG.isDefinedNotNull(c.aiE.iflExists)?d.apply(e,[JSON.stringify(c.aiE)]):(a=encodeURIComponent(document.referrer||document.location.href))?EBG.adaptor.getDataFromRemoteServer(ebPtcl+c.bs+this.aieServerRequestPrefix+a+this.aieServerRequestPrefixVersion,this._handleAddInEyeServerResponse,this,!0,!1)||d.apply(e,
['{"iflExists":1,"iflCheck":0}']):d.apply(e)},EBG.Adaptors.ServingMgr.prototype.handleAieServing=function(a){this.checkAie(a,this._handleAddInEyeServerResponse,this)},EBG.Adaptors.ServingMgr.prototype._handleAddInEyeServerResponse=function(a,c){var d;try{d=!c&&a?JSON.parse(a):{iflExists:0,iflCheck:1}}catch(e){d={iflExists:0,iflCheck:1}}EBG.serverResponses[this.ebO.adConfig.uid].aiE=d;this.ebO.aiE=d;if(!this.ebO.dmn)this.ebO.dmn=d.Domain?d.Domain:this._ebGetHostName(document.referrer);if(this.ebO.requiresIframeBust&&
d&&d.iflExists)this.insertInnerIframe(this.ebO.phid,d.iflCheck?EBG.Adaptors.IframeMode.SERVEANDVERIFY:EBG.Adaptors.IframeMode.SERVE);else{if(this.ebO.requiresIframeBust)this.ebO.adConfig.showAieDefaultImage=1;this.ebO.ifrm=0;var j=new EBG.Events.Event(EBG.Events.EventNames.AIE_LOADED);j.eventData={loadDefault:!0,currentResponse:this.ebO};j.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(j);d.iflCheck&&this.insertInnerIframe(this.ebO.phid,EBG.Adaptors.IframeMode.VERIFY)}};if(EBG.RichModules&&
EBG.RichModules.VisibilityManager){var a=function(){return!0};EBG.RichModules.BasicVisibilityProvider.prototype.shouldReportRecordable=a;EBG.RichModules.GeometricVisibilityProvider.prototype.shouldReportRecordable=a;EBG.RichModules.GeometricVisibilityProvider._isAvailable=function(a){return(a.actualServingMode!=EBG.Adaptors.ServingMode.IFRAME||EBG.adaptor.serving.servingMode==EBG.Adaptors.ServingMode.INNER_IFRAME)&&!(a.ffs.CFF_MRAIDVis&&EBG.adaptor.isInApp())};EBG.RichModules.MouseVisibilityProvider.prototype.shouldReportRecordable=
a;EBG.RichModules.MouseVisibilityProvider.prototype.shouldReportRecordable=a;EBG.RichModules.GridVisibilityProvider.prototype.shouldReportRecordable=a;if(EBG.RichModules.MraidVisibilityProvider)EBG.RichModules.MraidVisibilityProvider.prototype.shouldReportRecordable=a;EBG.RichModules.FlashVisibilityProvider.prototype.shouldReportRecordable=a;EBG.RichModules.SafeFrameVisibilityProvider.prototype.shouldReportRecordable=a;EBG.RichModules.FFVisibilityProvider.prototype.shouldReportRecordable=a;EBG.RichModules.VisibilityManager.prototype._availableVisibilityProviders=
[EBG.RichModules.GeometricVisibilityProvider,EBG.RichModules.SafeFrameVisibilityProvider,EBG.RichModules.AddingEyeProvider,EBG.RichModules.MouseVisibilityProvider,EBG.RichModules.GridVisibilityProvider,EBG.RichModules.FlashVisibilityProvider,EBG.RichModules.FFVisibilityProvider,EBG.RichModules.MraidVisibilityProvider];a=EBG.RichModules.VisibilityManager.prototype;EBG.RichModules.VisibilityManager=function(a,c,d){this.adConfig=a;this._resObjId=c;this._res=EBG.adaptor.getElementById(c);this.actualServingMode=
this.adConfig.actualServingMode;this._averageLastCalcTime=(new Date).getTime();this._isPanel=d;this._dpm=EBG.dataPipeMgr.getPipe(this.adConfig.sID);if(this._shouldInitialize())(this._visibilityProvider=this._getVisibilityProvider(this._resObjId,this.adConfig))?(this._dpm.send(EBG.DataProfile.VISIBILITY,{vsr:1,vsbp:this.getVisibilityProviderNum()}),this._initializeVisibilityData(),this._subscribeToEvents(),a=function(){this._visibilityProvider.shouldReportRecordable()&&this._reportVisibilityRecordable();
this._visibilityProvider.start()},this.adConfig.adStarted?a.apply(this):(a=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,a,this),a.timing=EBG.Events.EventTiming.ONTIME,EBG.eventMgr.subscribeToEvent(a))):this._dpm.send(EBG.DataProfile.VISIBILITY,{uvsr:3})};EBG.RichModules.VisibilityManager.ThreholdType={IAB:0,Agency:1,Advertiser:2};EBG.RichModules.VisibilityManager.VisibilityPollingTimer=1E3;EBG.RichModules.VisibilityManager.prototype=a;EBG.RichModules.VisibilityManager.prototype._shouldInitialize=
function(){EBG.Initializer._getAdClass({tn:this.adConfig.templateName});return this.adConfig.visibility.mode==EBG.VisibilityMode.DEFAULT_MODE?!1:!0}}}EBG.getFeatureFlagValue(c.ffs,"CFF_RemoveUivz")&&d()})}catch(e$$102){ebO.extensionHooks=tempExtensionHook}EBG.declareNamespace("Initializer");
EBG.Initializer={initialize:function(){var a=null,c;void 0!==c&&c||(a=EBG.Initializer._getCurrentServerResponse(a),EBG.Initializer._initGlobals(a),EBG.Initializer._callExtensionHooks(a),EBG.Initializer._initAdaptor(a),EBG.Initializer._initManagers(a),EBG.Initializer._initDisplayAd(a));return a},_initManagers:function(a){var c=new EBG.Events.Event(EBG.Events.EventNames.INIT_MANAGERS);c.eventData={"_adConfig.rnd":a.rnd};c.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(c);EBG.Initializer._initInteractionManager(a);
EBG.Initializer._initAnimationManager(a);EBG.Initializer._initDataPipeManager(a);(!~a.tn.toLowerCase().indexOf("html5")||!a.ffs.CFF_Html5Shrink)&&EBG.Initializer._initPositioningHelper();c.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(c)},_initDisplayAd:function(a){EBG.Initializer._updateAdConfig(a);if(EBG.Initializer._shouldInitAd(a)){if(EBG.isDefined(EBG.adaptor.getDisplayWin().EBG))try{EBGInfra.mergeObj(EBG,EBG.adaptor.getDisplayWin().EBG,!1)}catch(c){if(a.ffs.CFF_IEFreedScriptMerge)EBG.adaptor.getDisplayWin().EBG=
EBG}else EBG.adaptor.getDisplayWin().EBG=EBG;EBG.Initializer._initAd(a)}},_InitAdPreGlobals:function(a){try{var c=EBG.adaptor.getPageWin();if(!c.gEbPageGUID)c.gEbPageGUID=a.adConfig.rnd;EBG.pageGUID=c.gEbPageGUID}catch(d){EBG.pageGUID=a.adConfig.rnd}},_shouldInitAd:function(a){return a.innerIframe||0==a.ifrm||-1==a.ifrm&&EBG.adaptor.serving&&EBG.adaptor.serving.servingMode!=EBG.Adaptors.ServingMode.IFRAME},_getCurrentServerResponse:function(){for(var a=0,c;a<ebOArr.length;){if((c=ebOArr[a])&&this._getAdClass(c)){ebOArr.splice(a,
1);break}a++}return c},_initGlobals:function(a){var c=navigator.userAgent.toLowerCase(),d=a.adConfig;EBG.isOfflineDemo=!!window.gEbfOfflineDemo;"/"==ebResourcePath.charAt(ebResourcePath.length-1)&&"/"==ebResourcePath.charAt(ebResourcePath.length-2)&&(ebResourcePath=ebResourcePath.substring(0,ebResourcePath.length-1));EBG.resourcePath=ebResourcePath;d.rnd=a.rnd;d.uid=EBG.format("{0}_{1}",d.adId,d.rnd);d.resourcePath=ebResourcePath;d.ffs=a.ffs;EBG.sms=a.sms||"";EBG.fcsVirtualPath=a.fvp||"";EBG.pluId=
a.pi;EBG.dataCapture=EBG.bs=a.bs;EBG.protocol=ebPtcl;EBG.reportPageVer=a.rpv;EBG.html5Ver=a.html5v;EBG.flashPixelVer=a.vfp;EBG.intReportTimeout=a.irt||null;EBG.isMSNMessenger=(-1<c.indexOf("msn messenger")||-1<c.indexOf("windows live messenger"))&&window==parent;EBG.isIMBanner=window.gfEbExpBanerIM||window.gfEbExpBannerIM;EBG.isPreview=!!a.pr;EBG.isInWorkshop=window.gEbFlyLocal;EBG.iframeLocation=a.ifl||window.gstrEbIframeLocation;EBG.minZIndex=a.z||window.gnEbMinZIndex||1E4;EBG.eyeDivRefElement=
window.gEbEyeDivRefElement;EBG.eventMgr=EBG.eventMgr||new EBG.Events.EventManager;c=EBG.getTopAccessibleWindow();c.ebAds=c.ebAds||{};EBG.ads=c.ebAds;EBG.serverResponses=EBG.serverResponses||{};if((c=d.adHtmlPath)&&a.h5mi)d.adKitData={paths:{cachedScript:ebBigS,nonCachedScript:ebPtcl+a.sms,folderRoot:ebResourcePath+c.substring(0,c.lastIndexOf("/")+1)},version:a.h5mi.adkitversion}},_initServingMode:function(a){var c=this._getAdClass(a),d=a.adConfig;a.requiresIframeBust=c.requiresIframeBust;var e=EBG.adaptor.serving?
EBG.adaptor.serving.detectServingMode(!0):null;if(EBG.adaptor.isSafeFrame())a.ifrm=0,d.UiVz=!1;else if(c.requiresIframeBust){if(a.innerIframe)a.ifrm=EBG.Adaptors.ServingMode.INNER_IFRAME;if(!a.ifrm||a.soi)a.ifrm=0;EBG.adaptor.initServingMode(a.ifrm,!1,e);if(EBG.adaptor.inPlacementIframe())c=new EBG.Events.EventSubscription(EBG.Events.EventNames.AIE_LOADED,this._handleAieLoad,this),c.dispatcherFilters={"_adConfig.rnd":a.rnd},c.timing=EBG.Events.EventTiming.BEFORE,EBG.eventMgr.subscribeToEvent(c),EBG.adaptor.serving.handleAieServing(a)}else if(a.ifrm=
0,c!=EBG.Ads.StdBanner&&c!=EBG.Ads.StdBannerHtml5){EBG.adaptor.initServingMode(a.ifrm,!c.requiresIframeBust,e);if(e==EBG.Adaptors.ServingMode.FRIENDLY_IFRAME){d.UiVz=!1;try{document.close()}catch(f){}}if(e==EBG.Adaptors.ServingMode.SCRIPT)d.UiVz=!1}else d.UiVz=!1},_handleAieLoad:function(a){a.eventData.loadDefault&&a.eventData.currentResponse.tn!=EBG.adTypes.VisibilityAd&&(EBG.Initializer._initManagers(a.eventData.currentResponse),EBG.Initializer._initDisplayAd(a.eventData.currentResponse))},_callExtensionHooks:function(a){if(a.extensionHooks)for(;0!==
a.extensionHooks.length;)a.extensionHooks.pop().apply(null,[a.adConfig,a])},getRichestAdaptor:function(){return EBG.Adaptors.WebAdaptor||EBG.Adaptors.StdWebAdaptor},getRichestInteractionManager:function(){return EBG.Interactions.InteractionManager||EBG.Interactions.StdInteractionManager},_initAdaptor:function(a){var c=this.getRichestAdaptor(),d=new EBG.Events.Event(EBG.Events.EventNames.CREATE_ADAPTOR);d.eventData={currentClass:c};d.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(d);
if(!EBG.adaptor||EBG.adaptor.constructor.toString()!==d.eventData.currentClass.toString())c=new d.eventData.currentClass,EBG.adaptor=c;d.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(d);EBG.adaptor.initInnerModules(a.plt,a.bt,a.bv,a.dt,a.bc,!!a.adConfig.ffs.CFF_NoInDapIF);this._initServingMode(a);EBG.adaptor.registerSpecialBrowserEvents();EBG.eventMgr.attachToAdaptor()},_initInteractionManager:function(a){newEvent=new EBG.Events.Event(EBG.Events.EventNames.CREATE_INT_MGR);
newEvent.eventData={currentClass:this.getRichestInteractionManager()};newEvent.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(newEvent);if(!EBG.intMgr||EBG.intMgr.constructor.toString()!=newEvent.eventData.currentClass.toString())a=new newEvent.eventData.currentClass(a),EBG.intMgr=a;newEvent.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(newEvent)},_initAnimationManager:function(a){try{if(EBG.RichModules&&EBG.RichModules.AnimationManager){newEvent=new EBG.Events.Event(EBG.Events.EventNames.CREATE_ANIM_MGR);
newEvent.eventData=EBG.RichModules.AnimationManager;newEvent.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(newEvent);if(!EBG.animationMgr)EBG.animationMgr=new newEvent.eventData;if(!EBG.animator&&EBG.RichModules&&EBG.RichModules.Animator)EBG.animator=new EBG.RichModules.Animator(a.adConfig);newEvent.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(newEvent)}}catch(c){}},_initDataPipeManager:function(a){var c,d=1==a.dt||2==a.dt,e=!d&&(a.IABBV||a.IABEV||a.invVis)&&
a.ffs.CFF_DataPipeDesktop,f=!1;if(d&&a.ffs.CFF_DataPipeMobile||e)a.ffs.CFF_DataPipeAlways?f=!0:(d=this._getNumericDataFromFlag(a.ffs,"CFF_DataPipeThreshold"),f=Math.floor(1E4*Math.random())+1<=100*d);f&&(c=["general","platform","serving","visibility"]);a.dpu=a.dpu||"//datahub.serving-sys.com/samurai/collect/events";EBG.dataPipeMgr=new EBG.DataPipeManager(a.dpu,c)},_getNumericDataFromFlag:function(a,c){for(var d in a)if(0==d.indexOf(c)&&a[d]){var e=parseFloat(d.substr(c.length).replace("_","."));if(!isNaN(e))return e}return 0},
_initPositioningHelper:function(){try{if(EBG.Positioning&&EBG.Positioning.PositionManager){newEvent=new EBG.Events.Event(EBG.Events.EventNames.CREATE_POSITIONING_HELPER);newEvent.eventData=EBG.Positioning.PositionManager;newEvent.timing=EBG.Events.EventTiming.BEFORE;EBG.eventMgr.dispatchEvent(newEvent);if(!EBG.posHelper)EBG.posHelper=new newEvent.eventData;newEvent.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(newEvent)}}catch(a){}},_initAd:function(a){try{var c=this._getAdClass(a),
d=a.adConfig;newEvent=new EBG.Events.Event(EBG.Events.EventNames.CREATE_AD);newEvent.eventData={currentClass:c,adConfig:d};newEvent.timing=EBG.Events.EventTiming.BEFORE;newEvent.dispatcher={_adConfig:{rnd:d.rnd,uid:d.uid}};EBG.eventMgr.dispatchEvent(newEvent);EBG.Initializer._InitAdPreGlobals(a);new newEvent.eventData.currentClass(d);newEvent.timing=EBG.Events.EventTiming.ONTIME_AND_AFTER;EBG.eventMgr.dispatchEvent(newEvent);EBG.adaptor.getDisplayWin().EBG.ads[d.uid]||(EBG.adaptor.getDisplayWin().EBG.ads[d.uid]=
EBG.ads[d.uid]);if(EBG.BWDetection&&window.gEBMainWindow&&gEBMainWindow.EBP)if(gEBMainWindow.EBP.ebBW&&gEBMainWindow.EBP.ebBW.checked)EBG.BWDetection.speed=gEBMainWindow.EBP.ebBW.speed,EBG.BWDetection.checked=!0;else if(gEBMainWindow.EBP.BW&&gEBMainWindow.EBP.BW.checked)EBG.BWDetection.speed=gEBMainWindow.EBP.BW.speed,EBG.BWDetection.checked=!0;if(d.pckAssets){var a=0,e;for(e in d.pckAssets)d.pckAssets.hasOwnProperty(e)&&a++;if(0<a&&!EBG.BWDetection.checked)d.bwApplied=!0,EBG.BWDetection.init();d.BWD=
EBG.BWDetection}}catch(f){}},_getAdClass:function(a){var c;switch(a.tn){case EBG.adTypes.RichBannerHtml5:c=EBG.Ads.RichBannerHtml5;break;case EBG.adTypes.PoliteBannerHtml5:c=EBG.Ads.PoliteBannerHtml5;break;case EBG.adTypes.SEBannerHtml5:c=EBG.Ads.SEBannerHtml5;break;case EBG.adTypes.ExpBannerHtml5:c=EBG.Ads.ExpBannerHtml5;break;case EBG.adTypes.StdBannerHtml5:c=EBG.Ads.StdBannerHtml5;break;case EBG.adTypes.StdBanner:c=a.IABBV||a.IABEV?EBG.Ads.StdBannerEx:EBG.Ads.StdBanner;break;case EBG.adTypes.Banner:c=
EBG.Ads.RichBanner;break;case EBG.adTypes.SingleExpBanner:c=EBG.Ads.SingleExpBanner;break;case EBG.adTypes.ExpBanner:c=EBG.Ads.ExpBanner;break;case EBG.adTypes.VisibilityAd:c=EBG.Ads.VisibilityAd;break;case EBG.adTypes.FloatingAd:c=EBG.Ads.Floating;break;case EBG.adTypes.FloatingAdWithRem:c=EBG.Ads.FloatingWithReminder;break;case EBG.adTypes.TrackingAd:c=EBG.Ads.TrackingAd;break;case EBG.adTypes.WallpaperAd:c=EBG.Ads.WallpaperAd}return c},_updateAdConfig:function(a){var c=a.adConfig;c.sHost=window.sHost;
EBG.serverResponses[c.uid]||(EBG.serverResponses[c.uid]=a);c.placeHolderId=a.phid;c.sUrlTokens=a.ut;if(a.element_id)c.element_id=a.element_id;var d=EBG.adaptor.getPageWin();if(d=EBG.getPageUrl(d))c.ebReferrer=d;c.html5supported=a.html5Enabled;c.useHtmlConvertor=c.html5supported&&window.ebUseHtml5;c.actualServingMode=EBG.adaptor.serving?EBG.adaptor.serving.detectServingMode(!0):null;if(a.ffs.CFF_RemoveUivz)EBG.adaptor.focused=c.focused?c.focused:EBG.adaptor.focused;if(a.ffs.CFF_ServingMode)c.displayWin=
EBG.adaptor.getDisplayWin(),c.pageWin=EBG.adaptor.getPageWin();if(c.expandDynamic)c.showSinglePanel=1;if(!c.clickTrackingUrls)c.clickTrackingUrls=[];if(a.ncu)c.clickTrackingUrls.push(a.ncu),c.ncu=a.ncu;if(!c.defaultImpTrackingUrls)c.defaultImpTrackingUrls=[],c.defaultClickTrackingUrls=[];if(a.dctu)c.defaultClickTrackingUrls=a.dctu;if(a.ditu)c.defaultImpTrackingUrls=a.ditu;c.delayedImpParams=a.delayedImpParams;c.impressionTrackingURLs=[];if(a.itu&&0<a.itu.length)c.impressionTrackingURLs=a.itu;window.gEbBAd&&
(gEbBAd.playRS&&gEbBAd.playRS.strNUrl&&c.impressionTrackingURLs.push(gEbBAd.playRS.strNUrl),gEbBAd.strNImpUrl&&c.impressionTrackingURLs.push(gEbBAd.strNImpUrl));c.imageOnly=!1;c.page=a.p;c.massVersioning={targetAudienceId:a.ta&&"-1"!=a.ta?a.ta:"",deliveryGroupId:a.dg&&"-1"!=a.dg?a.dg:"",subDeliveryGroupId:a.sdg&&"-1"!=a.sdg?a.sdg:"",adVersions:a.av||"",defaultAdVersion:a.avd||"",adBasePath:a.abp||"",massVersionFolderDivider:a.mvfd||0,versionTargetAudienceId:a.tav&&"-1"!=a.tav?a.tav:"",dgTargetAudienceId:a.tadg&&
"-1"!=a.tadg?a.tadg:"",originalDeliveryGroupId:a.dgo&&"-1"!=a.dgo?a.dgo:""};if(0<=c.massVersioning.adVersions.indexOf("/")){if(c.massVersioning.defaultAdVersion)c.massVersioning.defaultAdVersion=JSON.parse(c.massVersioning.defaultAdVersion);c.massVersioning.versionFullPath=!0}if(a.soi)c.showOnlyImage=a.soi,c.massVersioning.adVersions=c.massVersioning.defaultAdVersion;if(EBGInfra.isDefinedNotNull(a.diAppId))c.diAppId=a.diAppId;c.reportDelayedImpression=a.rdi||0;c.defaultImageReason=a.dir||"";c.mobileSDK=
a.sdk||"";c.isOfflineDemo=EBG.isOfflineDemo;if("undefined"==typeof c.openWindow)c.openWindow=!0;this._updateAdConfigToHandleOpenWindow(a);c.bigSDir=unescape(ebBigS);c.imagesDir=unescape(ebBigS)+"Res/Images"+a.imgv+"/";c.modulesDir=unescape(ebBigS)+"Modules"+a.modv+"/";c.arrOnStartDnlEvents=a.osde;c.arrOnPlayEvents=a.ope;c.isGeoStrict=0!=a.igs?1:0;d=a.oo||0;EBG.adaptor.optOut=c.optOut=window.gEbFOptOut||d;EBG.adaptor.histLen=c.histLen=a.hl||30;c.sPublisherPlacementId=a.ppi||"";c.width=c.width||"";
c.height=c.height||"";c.adHtmlOptions?(c.width=a.adw||c.width,c.height=a.adh||c.height,c.defaultWidth=a.w||c.width,c.defaultHeight=a.h||c.height,c.adaptiveAd=!0):(c.width=a.w||c.width,c.height=a.h||c.height);c.shouldCollectUrl=a.cu||0;c.sID=a.sid||"";c.dlm=a.dlm||3;c.testImp=!!a.t;c.usercookie=a.usercookie||"";c.visibility={};d=c.visibility;d.mode=EBG.VisibilityMode.DEFAULT_MODE;if(a.IABEV||a.insVis)d.mode=EBG.VisibilityMode.ENHANCED_MODE;else if(a.IABBV)d.mode=EBG.VisibilityMode.BASIC_MODE;d.iabMinSurface=
a.IABMS;d.iabMinDuration=a.IABMD;d.agencyMinSurface=a.AgMS;d.agencyMinDuration=a.AgMD;d.advertiserMinSurface=a.AdMS;d.advertiserMinDuration=a.AdMD;d.iabMinLargeSurface=30;d.iabMinLargeDuration=a.IABMD;c.isInstreamVisibility=!!a.insVis;c.isInstreamVerification=!!a.insVer;c.displayVerification=!!a.disVer;if(d=c.interactionsToReport)if(d[EBG.Interactions.SystemInts.AD_START]=EBG.Interactions.SystemInts.AD_START,d[EBG.Interactions.SystemInts.AD_STACKING]=EBG.Interactions.SystemInts.AD_STACKING,d[EBG.Interactions.SystemInts.MULTI_BURN]=
EBG.Interactions.SystemInts.MULTI_BURN,d[EBG.Interactions.SystemInts.AD_COLLISION]=EBG.Interactions.SystemInts.AD_COLLISION,d[EBG.Interactions.SystemInts.AD_CAROUSEL]=EBG.Interactions.SystemInts.AD_CAROUSEL,d.visibility&&(d[EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE]=EBG.Interactions.SystemInts.VISIBILITY_RECORDABLE,d[EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE]=EBG.Interactions.SystemInts.VISIBILITY_AGENCY_RECORDABLE,d[EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE]=
EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_RECORDABLE,d[EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER]=EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER,d[EBG.Interactions.SystemInts.VISIBILITY_AGENCY]=EBG.Interactions.SystemInts.VISIBILITY_AGENCY,d[EBG.Interactions.SystemInts.VISIBILITY_IAB]=EBG.Interactions.SystemInts.VISIBILITY_IAB,d[EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION]=EBG.Interactions.SystemInts.VISIBILITY_ADVERTISER_DURATION,d[EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION]=
EBG.Interactions.SystemInts.VISIBILITY_AGENCY_DURATION,d[EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE]=EBG.Interactions.SystemInts.VISIBILITY_AVG_AD_SURFACE,!EBG.adaptor.isInApp()))d[EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE]=EBG.Interactions.SystemInts.VISIBILITY_AVG_SCREEN_SHARE;c.adParamsEnabled=c.displayVerification||c.isInstreamVerification||!!a.ap;c.playerParamsEnabled=c.isInstreamVerification||!!a.pp;if(c.defaultFlashName&&!c.defaultFlashPath)c.defaultFlashPath=c.imagesDir+
"BannerAssets/"+c.defaultFlashName;c.offsetX=a.offsetX||0;c.offsetY=a.offsetY||0;c.adChoice={};c.adChoice.certificationProgram=a.AcCP;c.adChoice.customUrl=a.CAcURL;c.adChoice.includeMarker=c.AcIncludeMarker;c.adChoice.iconPosition=parseInt(c.AcIconPosition);if(a.wm)c.wmode=a.wm.toLowerCase();if(!c.pushDownConfig&&"none"!=a.disp)c.display=a.disp||"inline";c.disableAutoExpand=a.dex||0;c.aiE=a.aiE||{};c.appPool=a.appPool||"BurstingPipe";c.interactionServer=a.is||"BurstingPipe";c.advertiserId=a.advid;
c.moduleInfo=a.h5mi||{};try{if(window.gEbBAd){if(gEbBAd.panelsWMode)c.panelsWMode=gEbBAd.panelsWMode;if(gEbBAd.strWmode)c.wmode=gEbBAd.strWmode.toLowerCase()}}catch(e){}if(EBG.adaptor.isSafeFrame()){c.isSafeFrame=!0;c.expandDynamic=0;for(var f in c.panels){d=c.panels[f];try{var g=$sf.ext.geom();if(d.posType==EBG.PanelPositionType.PAGE_RELATIVE_PERCENTAGE||d.posType==EBG.PanelPositionType.VIEWPORT_RELATIVE_PERCENTAGE)d.xPos=Math.round((g.win.w-d.width)*(d.xPos/100)),d.yPos=Math.round((g.win.h-d.height)*
(d.yPos/100));d.posType!=EBG.PanelPositionType.BANNER_RELATIVE_PIXELS&&(d.xPos-=g.self.l,d.yPos-=g.self.t)}catch(h){d.xPos=0,d.yPos=0}d.posType=EBG.PanelPositionType.BANNER_RELATIVE_PIXELS}}if(EBG.adaptor.isSkype()&&(c.isSkype=!0,!a.ffs.CFF_SkypeDynamic))c.expandDynamic=0;if(a.ffs.CFF_FireFoxFlash&&!a.ffs.CFF_FlashBlockPixel)a=EBG.adaptor.flash.getFlashVersionForBlockingDetection(),c.minimalflashVer=a||c.minimalflashVer,c.flashVer=a||c.flashVer;c.isInApp=EBG.adaptor.isInApp();c.locationPolling=this._setLocationPolling(c.locationPolling)},
_setLocationPolling:function(a){0<a?(a=Math.min(a,100),a=Math.max(a,10)):a=0;return a},_updateAdConfigToHandleOpenWindow:function(a){var c=a.adConfig;c.bsPath=EBG.bs;c.pluId=EBG.pluId;c.protocol=EBG.protocol;if(EBGInfra.isDefined(a.lid))c.lineId=a.lid;c.isPreview=!!a.pr}};
try{var currentResponse=EBG.Initializer.initialize();if(currentResponse.adConfig.UiVz&&!currentResponse.requiresIframeBust&&(currentResponse.IABBV||currentResponse.IABEV)&&!EBG.adaptor.isSafeFrame()&&"Visibility"!=currentResponse.tn){var vizClone=EBG.cloneObj(currentResponse);vizClone.tn=vizClone.adConfig.templateName="Visibility";vizClone.ifrm=2;vizClone.soi=0;ebOArr[ebOArr.length]=vizClone;var newEbSrc=ebSrc.replace(currentResponse.tn,vizClone.tn),newEbSrc=newEbSrc.replace(/ex(debug|_api|)\.js/ig,
".js"),newScript=document.createElement("SCRIPT");newScript.src=newEbSrc;vizClone.ebSrc=newEbSrc;if(currentResponse.adConfig.adStarted){var target=document.getElementById(vizClone.phid);target&&target.appendChild(newScript)}else{var sub=new EBG.Events.EventSubscription(EBG.Events.EventNames.AD_START,function(){var a=document.getElementById(vizClone.phid);a&&a.appendChild(newScript)},this);sub.timing=EBG.Events.EventTiming.ONTIME;EBG.eventMgr.subscribeToEvent(sub)}}}catch(e$$109){};
