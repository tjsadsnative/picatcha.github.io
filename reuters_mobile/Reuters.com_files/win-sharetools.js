var Reuters=Reuters||{};
Reuters.share={init:function(a){this.configureSharetools(a);this.createSharetoolsHTML();this.createMoreSharetoolsHTML();this.addShareCount();this.addTrackingEvents()},configureSharetools:function(a){this.$el=$(a);this.$shareMore=this.$el.find(".reuters-share-more");this.tool=this.$el.data("share").split(",");this.moreTool=this.$el.data("more").split(",");this.moreToolL=this.$el.data("more").length;this.id=this.$el.data("share-id");this.mediaId=this.$el.data("share-media-id")||"";this.showCount=this.$el.data("share-count");
this.title=this.$el.data("share-title");this.titleShort=this.$el.data("share-title-short");this.longURL=this.$el.data("share-url");this.url=(this.shortURL=this.$el.data("share-short-url"))||this.longURL;this.urlEnc=encodeURIComponent(this.url);this.descEnc=encodeURIComponent(this.$el.data("share-desc"));this.titleEnc=encodeURIComponent(this.$el.data("share-title"));this.imgEnc=encodeURIComponent(this.$el.data("share-img"));this.img=this.$el.data("share-img");this.imgSm=this.$el.data("share-img-sm");
this.edition=$("body").attr("class").split(" ")[0];a=this.edition=="WIN-JP"?"Reuters_co_jp":this.edition=="WIN-IN"?"ReutersIndia":this.edition=="WIN-UK"?"ReutersUK":"Reuters";this.edition=="WIN-CN"?(this.mailTxtBody="\u60a8\u53ef\u80fd\u5bf9\u4ee5\u4e0b\u5185\u5bb9\u611f\u5174\u8da3:",this.mailTxtLink="\u60a8\u53ef\u4ee5\u901a\u8fc7\u90ae\u7bb1\u8ba2\u5236\u65b0\u95fb\u8d44\u8baf\uff0c\u8bf7\u5728\u6b64\u8ba2\u5236 http://reut.rs/1bB38fv."):this.edition=="WIN-UK"?(this.mailTxtBody="I thought you would be interested in the following:",
this.mailTxtLink="If you would like to receive news articles delivered to your email address, please subscribe at http://reut.rs/1GtMWVI."):this.edition=="WIN-IN"?(this.mailTxtBody="I thought you would be interested in the following:",this.mailTxtLink="If you would like to receive news articles delivered to your email address, please subscribe at http://reut.rs/1Krh3AZ."):this.edition=="WIN-JP"?(this.mailTxtBody="\u3053\u306e\u8a18\u4e8b\u3092\u304a\u3059\u3059\u3081\u3057\u307e\u3059\uff1a",this.mailTxtLink=
"\u30ed\u30a4\u30bf\u30fc\u30cb\u30e5\u30fc\u30b9\u30e1\u30fc\u30eb\u306e\u7121\u6599\u4f1a\u54e1\u767b\u9332\u306f\u3053\u3061\u3089\u304b\u3089 https://commerce.jp.reuters.com/registration/pages/registration/begin.do"):(this.mailTxtBody="I thought you would be interested in the following:",this.mailTxtLink="If you would like to receive news articles delivered to your email address, please subscribe at http://www.reuters.com/newsmails.");this.shareObj={twitter:{shareUrl:"http://www.twitter.com/intent/tweet?url="+
this.urlEnc+"&via="+a+"&text="+this.titleEnc,shareSlideUrl:"http://www.twitter.com/intent/tweet?url="+this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId+"&via=Reuters&text="+this.titleEnc,countUrl:"http://cdn.api.twitter.com/1/urls/count.json?url="+this.longURL+"&callback=?",countVar:"count"},facebook:{shareUrl:"http://www.facebook.com/sharer/sharer.php?u="+this.urlEnc+"&t="+this.titleEnc,shareSlideUrl:"http://www.facebook.com/sharer/sharer.php?u="+this.urlEnc+"?articleId="+this.id+"%26slideId="+
this.mediaId+"&t="+this.titleEnc,countUrl:"http://graph.facebook.com/?id="+this.url+"&callback=?",countVar:"shares"},whatsapp:{shareUrl:"whatsapp://send?text="+this.titleEnc+"%20"+this.url,shareSlideUrl:"whatsapp://send?text="+this.titleEnc+"%20"+this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId},linkedin:{shareUrl:"http://www.linkedin.com/shareArticle?mini=true&url="+this.urlEnc+"&title="+this.titleEnc+"&summary="+this.descEnc+"&source=Reuters",shareSlideUrl:"http://www.linkedin.com/shareArticle?mini=true&url="+
this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId+"&title="+this.titleEnc+"&summary="+this.descEnc+"&source=Reuters",countUrl:"http://www.linkedin.com/countserv/count/share?url="+this.url+"&callback=?",countVar:"count"},pinterest:{shareUrl:"http://pinterest.com/pin/create%2Fbutton/?url="+this.urlEnc+"&media="+this.imgEnc,shareSlideUrl:"http://pinterest.com/pin/create%2Fbutton/?url="+this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId+"&media="+this.imgEnc},reddit:{shareUrl:"http://www.reddit.com/submit?url="+
this.urlEnc+"&title="+this.titleEnc,shareSlideUrl:"http://www.reddit.com/submit?url="+this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId+"&title="+this.titleEnc},google:{shareUrl:"http://plus.google.com/share?url="+this.urlEnc,shareSlideUrl:"http://plus.google.com/share?url="+this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId},weibo:{shareUrl:"http://service.weibo.com/share/share.php?appkey=1278851849&source=Reuters&url="+this.urlEnc+"&title="+this.descEnc+"&searchPic=false",shareSlideUrl:"http://service.weibo.com/share/share.php?appkey=1278851849&source=Reuters&url="+
this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId+"&title="+this.descEnc+"&searchPic=false"},qqzone:{shareUrl:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?site=Reuters&url="+this.urlEnc+"&showcount=1&title="+this.titleEnc+"&pics="+this.imgEnc+"&desc="+this.descEnc,shareSlideUrl:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?site=Reuters&url="+this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId+"&showcount=1&title="+this.titleEnc+"&pics="+this.imgEnc+
"&desc="+this.descEnc},tencent:{shareUrl:"http://v.t.qq.com/share/share.php?appkey=e8f498130dae4fecbacadc98092f22e1&site=Reuters&url="+this.urlEnc+"&title="+this.descEnc+"&pic="+this.imgEnc+"&desc="+this.descEnc,shareSlideUrl:"http://v.t.qq.com/share/share.php?appkey=e8f498130dae4fecbacadc98092f22e1&site=Reuters&url="+this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId+"&title="+this.descEnc+"&pic="+this.imgEnc+"&desc="+this.descEnc},mixi:{shareUrl:"http://mixi.jp/share.pl?u="+this.urlEnc+
"&k=5381dd613c8f0e2ce5785e50ff631e8350b9f26b",shareSlideUrl:"http://mixi.jp/share.pl?u="+this.urlEnc+"?articleId="+this.id+"%26slideId="+this.mediaId+"&k=5381dd613c8f0e2ce5785e50ff631e8350b9f26b"},mail:{shareUrl:"mailto:?subject=(Reuters) "+encodeURIComponent(this.title)+"&body="+encodeURIComponent(this.mailTxtBody)+" "+this.urlEnc+"%0D%0D"+this.mailTxtLink,shareSlideUrl:"mailto:?subject=(Reuters) "+encodeURIComponent(this.title)+"&body="+encodeURIComponent(this.mailTxtBody)+" "+this.urlEnc+"?articleId="+
this.id+"%26slideId="+this.mediaId+"%0D%0D"+this.mailTxtLink},share:{shareUrl:this.url,shareSlideUrl:this.url+"?articleId="+this.id+"%26slideId="+this.mediaId},buy:{shareUrl:this.url,shareSlideUrl:this.url+"?articleId="+this.id+"%26slideId="+this.mediaId},more:{shareUrl:this.url,shareSlideUrl:this.url+"?articleId="+this.id+"%26slideId="+this.mediaId},blank:{shareUrl:"",shareSlideUrl:""}}},createSharetoolsHTML:function(){var a=[];if(this.tool!==void 0&&this.tool.length>0){a.push('<ul class="horizontal-list">');
for(var b=0,c=this.tool.length;b<c;b++)a.push(this.addSharetool(this.tool[b]));a.push("</ul>")}this.$el.prepend(a.join(""))},createMoreSharetoolsHTML:function(){var a=[];if(this.moreTool!==void 0&&this.moreToolL>0){$(".sec-slideshow")[0]?a.push('<div id="'+this.mediaId+'" class="share-overlay-container"><div class="share-overlay" style="background: url('+this.imgSm+') no-repeat center 0 #000;"><div class="share-overlay-hdr">'+this.titleShort+'<a href="javascript:Reuters.share.closeShareWindow();" class="shr-close">X</a></div><div class="share-overlay-tools"><div class="share-overlay-bg"></div><input type="text" value="'+
this.url+"?articleId="+this.id+"&slideId="+this.mediaId+'" class="share-overlay-link"></input><ul class="horizontal-list">'):a.push('<div id="'+this.mediaId+'" class="share-overlay-container"><div class="share-overlay" style="background: url('+this.imgSm+') no-repeat center 0 #000;"><div class="share-overlay-hdr">'+this.titleShort+'<a href="javascript:Reuters.share.closeShareWindow();" class="shr-close">X</a></div><div class="share-overlay-tools"><div class="share-overlay-bg"></div><input type="text" value="'+
this.url+'" class="share-overlay-link"></input><ul class="horizontal-list">');for(var b=0,c=this.moreTool.length;b<c;b++)a.push(this.addSharetool(this.moreTool[b]));a.push("</ul></div></div></div>")}this.$el.prepend(a.join(""))},addSharetool:function(a){var b=[],b=this.shareObj[a],c=a=="buy",d=a==="embed"||a==="link"?false:true,b=a=="share"?['<li class="shr-',a,'">','<a href="',b.shareUrl,'" target="_blank">','<i class="shr-ico"></i>','<span class="shr-txt">Share slideshow</span>',"</a>","</li>"]:
a=="more-social"?['<li class="shr-',a,'">','<a href="javascript:Reuters.share.openShareWindow('+this.mediaId+');">','<i class="shr-ico"></i>',"</a>","</li>"]:a=="mail"?$(".sec-slideshow")[0]?['<li class="shr-',a,'">','<a href="',b.shareSlideUrl,'">','<i class="shr-ico"></i>',"</a>","</li>"]:['<li class="shr-',a,'">','<a href="',b.shareUrl,'">','<i class="shr-ico"></i>',"</a>","</li>"]:c?['<li class="shr-',a,'">','<a href="',b.shareUrl,'" target="_blank">','<i class="shr-ico"></i>','<span class="shr-txt">Buy Print</span>',
"</a>","</li>"]:d?$(".sec-slideshow")[0]?['<li class="shr-',a,'">','<a href="',b.shareSlideUrl,'" target="_blank">','<i class="shr-ico"></i>',"</a>","</li>"]:['<li class="shr-',a,'">','<a href="',b.shareUrl,'" target="_blank">','<i class="shr-ico"></i>',"</a>","</li>"]:['<li class="shr-',a,'">','<i class="shr-ico"></i>',"</li>"];return b.join("")},addShareCount:function(){this.count&&$.each(this.shareObj,this.shareCountHTML)},shareCountHTML:function(a,b){var c=$el.find(".shr-"+a+" a"),d;c.length>
0&&"countUrl"in b&&$.getJSON(b.countUrl,function(a){a=a[b.countVar]?a[b.countVar]:"0";a==="0"&&(a="");a=['<span class="shr-count">',a,"</span>"].join("");c.append(a)})},addEvents:function(){var a=this.$el;a.find(".shr-twitter, .shr-facebook, .shr-qqzone").on("click",this.openSmallWindow);a.find(".shr-whatsapp, .shr-print, .shr-google, .shr-linkedin, .shr-reddit, .shr-weibo, .shr-tencent, .shr-mixi, .shr-pinterest").on("click",this.openBigWindow);a.find(".shr-mail").on("click",this.mailFunc);a.find(".shr-more-social").on("click",
this.showMoreSocial);a.find(".shr-embed").on("click",this.showMoreEmbed);a.find(".shr-link").on("click",this.showMoreLink);a.find(".shr-share, .shr-license").on("click",this.staticBtnAnalytics);a.find(".reuters-share-more .shr-close").on("click",this.closeMoreWindow);this.$shareMore.find("textarea").on("focus",this.selectText)},addTrackingEvents:function(){this.$el.find(".shr-twitter, .shr-facebook, .shr-qqzone, .shr-whatsapp, .shr-print, .shr-google, .shr-linkedin, .shr-reddit, .shr-weibo, .shr-tencent, .shr-mixi, .shr-pinterest, .shr-mail").on("click",
this.trackingShare)},openSmallWindow:function(a){a.preventDefault();var a=$(this).find("a").attr("href"),b="",c=$(this).find("a").attr("target");c&&(b=c);window.open(a,b,"")},openBigWindow:function(a){a.preventDefault();var a=$(this).find("a").attr("href"),b="",c=$(this).find("a").attr("target");c&&(b=c);window.open(a,b,"")},mailFunc:function(){},showMoreSocial:function(a){a.preventDefault();$(".share-overlay").addClass("active")},showMoreEmbed:function(a){a.preventDefault();var a=$(a.target).closest(".current-slide-info").find(".reuters-share-more"),
b=a.find(".reuters-share-embed");a.show();a.find(".reuters-share-extra").hide();b.show();b.focus()},showMoreLink:function(a){a.preventDefault();var a=$(a.target).closest(".current-slide-info").find(".reuters-share-more"),b=a.find(".reuters-share-link");a.show();a.find(".reuters-share-extra").hide();b.show();b.focus()},staticBtnAnalytics:function(){},selectText:function(a){$(a.target).closest(".current-slide-info").find(".reuters-share-more").find("textarea").select()},closeMoreWindow:function(a){a.preventDefault();
$(a.target).closest(".current-slide-info").find(".reuters-share-more").hide()},openShareWindow:function(a){$("body").addClass("noscroll");$(a).length>0?($("#"+a).prependTo("body"),$("#"+a+" .share-overlay").fadeTo(200,1).addClass("active")):$(".share-overlay").fadeTo(200,1).addClass("active");$("body").on("touchmove",function(a){a.preventDefault()})},closeShareWindow:function(){$("body").removeClass("noscroll");$(".share-overlay").fadeTo(200,0);$(".share-overlay").delay(210).queue(function(){$(this).removeClass("active").clearQueue()});
$("body").unbind("touchmove")},wtShare:function(a){a=$(a).attr("class").split("-")[1];Webtrends.multiTrack({argsa:["WT.z_event","Share-"+a,"DCSext.rchannel","Event-Share","DCSext.ContentID_Shared",this.id,"WT.dl","15","WT.nv","reuters-share"]})},wtShareMail:function(a){$(a).attr("class").split("-");Webtrends.multiTrack({argsa:["WT.z_event","Share-Mail","DCSext.rchannel","Event-Share","DCSext.ContentID_Shared",this.id,"WT.dl","15","WT.nv","reuters-share"]})},trackingShare:function(){var a=$(this).attr("class").split("-")[1];
Reuters.win.event&&Reuters.win.event.fire("Share",{"Share Type":a})}};(function(a){a(".reuters-share").each(function(){Object.create(Reuters.share).init(this)});a(".reuters-share-more").each(function(){Object.create(Reuters.share).init(this)})})(jQuery);