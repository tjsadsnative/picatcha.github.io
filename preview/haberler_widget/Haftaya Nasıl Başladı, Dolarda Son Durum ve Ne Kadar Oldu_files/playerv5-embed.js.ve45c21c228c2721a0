window.require=function(){};window.store=require("store");(function(f){function h(b){var a={};$.extend(a,window.store);a.get=function(d){if(!b[d]){b[d]={}}if(b[d].version){var c=store.get("_"+d+"-version");if(!c||parseFloat(b[d].version)!==parseFloat(c)){return undefined}}if(b[d].expire){return storeWithExpiration.get(d)}return store.get(d)};a.set=function(d,c){if(!b[d]){b[d]={}}if(b[d].version){store.set("_"+d+"-version",b[d].version)}if(b[d].expire){return storeWithExpiration.set(d,c,b[d].expire)}return store.set(d,c)};a.remove=function(c){store.remove("_"+c+"-version");return store.remove(c)};return a}var j={},i={inject:function(b,a){if(f.DM_ENV[b]){f[b]=f[b]||{};a=a||j[b]||f[b];for(var c in f.DM_ENV[b]){if(f.DM_ENV[b].hasOwnProperty(c)){a[c]=f.DM_ENV[b][c]}}}}},g={define:function(a,c,d){var b=j[a]||f[a];if(b&&!b.__preModule){return}b=c();if(!b){return}i.inject(a,b);if(d){f[a]=b}else{j[a]=b}b.store=b.__localstorageConf?h(b.__localstorageConf):window.store;delete (b.__localstorageConf);b.__initialize&&b.__initialize();delete (b.__initialize);b.__onDomReady&&$(b.__onDomReady);delete (b.__onDomReady);delete (b.__preModule)},__debug:function(a){return j[a]||f[a]||null}};PubSub.subscribe("envs:added",function(a){i.inject(a)});f._DM=g})(window);_DM.define("DM_PlayerUtils",function(){var k=[],p=[],o=document.title,l=false,i=false,m=function(a){if(a==1){document.title="â–¶ "+o}else{document.title=o}},n=function(a){k.push(a);p.push({object:$("#"+a).get(0),id:a,previousState:0,pauseTimeout:0});if(p.length==1){DM_PlayerEvents.on("StateChange",a,m)}};var j={needsCssUpdate:function(){return $("html.gecko.win, html.gecko.linux").length&&$(playerV5).children("embed").first().length},hideAllPlayers:function(){if(typeof playerV5!=="undefined"){playerV5.pause();if(j.needsCssUpdate()){$(playerV5).css("visibility","hidden")}return}if(i){return}var b=function(c){if(!$("#"+c.id).closest("#popupContent").length){c.previousState=c.object.getPlayerState();var d=$(c.object);d.parent().addClass("invisible");d.css("visibility","hidden");j.pausePlayer(c)}};try{if(p.length){$.each(p,function(d,c){b(c)})}else{DM_PlayerEvents.on("Ready",function(c){b({object:$("#"+c).get(0),id:c})})}$(".dmpi_video_partnerplayer").each(function(d,c){$(c).parent().addClass("invisible").css("visibility","hidden")});i=true}catch(a){}},showAllPlayers:function(){if(typeof playerV5!=="undefined"){playerV5.play();if(j.needsCssUpdate()){$(playerV5).css("visibility","visible")}return}if(!i||l){return}try{$.each(p,function(d,b){clearTimeout(b.pauseTimeout);var c=$(b.object);c.parent().removeClass("invisible");c.css("visibility","visible");var e=b.object.getAPICustomParams();if(b.previousState==1||(b.previousState==-1&&e.autoplay)||b.previousState==3){b.object.playVideo()}});$(".dmpi_video_partnerplayer").each(function(c,b){var d=$(b);d.parent().removeClass("invisible");d.css("visibility","visible")});i=false}catch(a){}},pausePlayer:function(b){clearTimeout(b.pauseTimeout);var a=b.object.getPlayerState();if(a==-1||a==3||a>100){b.pauseTimeout=setTimeout(function(){j.pausePlayer(b)},500)}else{if(a==1){b.object.pauseVideo()}}},showWarning:function(a,c,b){$("#container_"+a).addClass("notice").empty().append($("<div/>").addClass("warning").append($("<p/>").addClass("title").html(c)).append($("<p/>").addClass("message").html(b)))},initialize:function(){DM_PlayerEvents.on("Ready",n)},__initialize:function(){PubSub.subscribe("popup:opening",j.hideAllPlayers);PubSub.subscribe("dm-tour:start",function(){l=true;j.hideAllPlayers()});PubSub.subscribe("popup:closed",j.showAllPlayers);PubSub.subscribe("dm-tour:end",function(){l=false;j.showAllPlayers()})}};return j},true);_DM.define("DM_DispatchEvent",function(){var b={dispatch:function(i,j,h){var g={bubbles:false,cancelable:false,detail:h},a;if(typeof CustomEvent=="function"){a=new CustomEvent(j,g)}else{if(document.createEvent){a=document.createEvent("CustomEvent");a.initCustomEvent(j,g.bubbles,g.cancelable,g.detail)}else{a=document.createEventObject();a.eventType=j;event.detail=g.detail}}if(i.dispatchEvent){i.dispatchEvent(a)}else{if(i.fireEvent){i.fireEvent("on"+j,a)}}}};return b},true);