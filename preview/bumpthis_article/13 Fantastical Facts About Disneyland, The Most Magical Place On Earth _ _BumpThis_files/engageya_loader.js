var _ENGAGEYA_WIDGETS=_ENGAGEYA_WIDGETS||[],ENGAGEYA=function(t){this.widget_wrapper_elm_id=t.wwei,this.pid=t.pid?t.pid:"",this.subid=t.subid?t.subid:"",this.publisher_id=t.pubid?t.pubid:"",this.website_id=t.webid?t.webid:"",this.widget_id=t.wid?t.wid:"",this.width=t.width||"",this.height=t.height||"",this.plr_elm_id=t.plreid,this.plr_type=t.plrtid||-1,this.show_on_pause=t.issop?t.issop:0,this.show_on_complete=t.issoc?t.issoc:0,this.show_on_idle=t.issoi?t.issoi:0,this.is_index_page=t.isidx?t.isidx:1,this.is_widget_autorun=t.isar?t.isar:0,this.is_video_widget=t.isvw?t.isvw:0,this.plr_wmode=t.pwmd?t.pwmd:"opaque",this.plr_func_name=t.pfn,this.input_url=t.iurl||null,this.feed_url="ext1-api.engageya.com/gas-api/feed.json",this.recs_url="recs.engageya.com/rec-api/getrecs.json",this.recs_url_premium="premium.engageya.com/rec-api/getrecs.json",this.event_url="recs.engageya.com/rec-api/event.json",this.default_imgs_url="widget.engageya.com/img/",this.aws_images_url="//engageya-eu-images9.s3-website-eu-west-1.amazonaws.com",this.cdn_images_url="//images9.engageya.com",this.default_video_post_btn="widget.engageya.com/img/vplay.png",this.def,this.doc_ready_called=!1,this.random_id=Math.ceil(1e17*Math.random()),this.cb="engageya_cb_"+this.random_id,this.num_of_slides=t.tnos||15,this.min_slides=2,this.jq=null,this.num_of_jq_attempts=20,this.find_wrapper_elm_retries=10,this.widget_idx=0,this.isNoConflictJquery=t.ncjqry||!1,this.scripts_elms=[],this.get_recs_states=[[],["BUFFERING","PLAYING"],[0,2,3],[1]],this.rec_types=["all","eng_inner","eng_ads","eng_outer"],this.widget_wrapper_elm=null,this.widget_add_data=null,this.is_widget_wrapper_dom_ready=!1,this.is_user_initiated_event=!1,this.data_json=null,this.is_real_imps_called=!1,this.visible_posts_and_types=[],this.load_time_start=(new Date).getTime(),this.widget_direction="left",this.widget_op_direction="right",this.click_pixels=t.cpxls?t.cpxls:"",this.premium_pub_ids=[158041],this.max_num_of_image_load_retries=6,this.image_load_retries_arr={}};ENGAGEYA.prototype.run=function(){1==this.is_video_widget?this.attach_player_events():this.start_run()},ENGAGEYA.prototype.attach_player_events=function(){1==this.plr_type?this.attach_jwplayer_events():2==this.plr_type?this.attach_flowplayer_events():this.attach_generic_player_events(),1==this.is_widget_autorun&&this.start_run()},ENGAGEYA.prototype.attach_jwplayer_events=function(){var t=this;jwplayer(this.plr_elm_id).onPlay(function(){t.on_play_action()}),jwplayer(this.plr_elm_id).onBuffer(function(){t.on_play_action()}),jwplayer(this.plr_elm_id).onPause(function(){t.on_pause_action()}),jwplayer(this.plr_elm_id).onIdle(function(){t.on_idle_action()}),jwplayer(this.plr_elm_id).onComplete(function(){t.on_complete_action()}),this.plr_get_state_fnc=jwplayer(this.plr_elm_id).getState,this.state_events()},ENGAGEYA.prototype.attach_flowplayer_events=function(){var t=this,i=null;i=flowplayer(this.plr_elm_id)?flowplayer(this.plr_elm_id):flowplayer();try{i.onStart(function(){t.on_play_action()}),i.onLoad(function(){t.on_play_action()}),i.getClip().onResume(function(){t.on_play_action()}),i.getClip().onPause(function(){t.on_pause_action()}),i.getClip().onStop(function(){t.on_pause_action()}),i.getClip().onFinish(function(){t.on_complete_action()}),this.plr_get_state_fnc=i.getState}catch(e){i.bind("load",function(i,e){t.on_play_action()}),i.bind("click",function(i,e){t.is_user_initiated_event=!0}),i.bind("resume",function(i,e){t.on_play_action()}),i.bind("pause",function(i,e){t.is_user_initiated_event&&(t.on_pause_action(),t.is_user_initiated_event=!1)}),i.bind("stop",function(i,e){t.on_pause_action()}),i.bind("finish",function(i,e){t.on_complete_action()}),this.plr_get_state_fnc=function(){return 1}}this.state_events()},ENGAGEYA.prototype.attach_generic_player_events=function(){var t=this;try{var i=window[this.plr_func_name](this.plr_elm_id)}catch(e){}i=i?i:window[this.plr_func_name],i=i?i:document.getElementById(this.plr_elm_id);try{i.onStart(function(){t.on_play_action()})}catch(e){}try{i.onLoad(function(){t.on_play_action()})}catch(e){}try{i.onPlaying(function(){t.on_play_action()})}catch(e){}try{i.onplay=function(){t.on_play_action()}}catch(e){}try{i.onPlay(function(){t.on_play_action()})}catch(e){}try{i.onBuffer(function(){t.on_play_action()})}catch(e){}try{i.onResume(function(){t.on_play_action()})}catch(e){}try{i.onPause(function(){t.on_pause_action()})}catch(e){}try{i.onpause=function(){t.on_pause_action()}}catch(e){}try{i.onStop(function(){t.on_pause_action()})}catch(e){}try{i.onFinish(function(){t.on_complete_action()})}catch(e){}try{i.onended=function(){t.on_complete_action()}}catch(e){}try{i.onComplete(function(){t.on_complete_action()})}catch(e){}try{this.plr_get_state_fnc=i.getState||function(){return 1}}catch(e){}this.state_events()},ENGAGEYA.prototype.on_play_action=function(){this.hide_widget(this),this.start_run()},ENGAGEYA.prototype.on_pause_action=function(){1==this.show_on_pause&&this.is_widget_wrapper_dom_ready&&this.show_widget()},ENGAGEYA.prototype.on_idle_action=function(){1==this.show_on_idle?this.show_widget():""},ENGAGEYA.prototype.on_complete_action=function(){1==this.show_on_complete?this.show_widget():""},ENGAGEYA.prototype.state_events=function(){this.is_load_recs_state()&&this.start_run()},ENGAGEYA.prototype.is_load_recs_state=function(){var t=this.plr_get_state_fnc(),i=this.in_array(t,this.get_recs_states[this.plr_type]);return i},ENGAGEYA.prototype.show_widget=function(){this.jq("#eng_recs_holder_"+this.random_id).fadeIn("slow"),this.align_widget_elements()},ENGAGEYA.prototype.hide_widget=function(t){try{this.jq("#eng_recs_holder_"+t.random_id).hide()}catch(i){}},ENGAGEYA.prototype.attach_widget_events=function(){try{var t=this;this.load_real_imps_events(),this.widget_imgs_events(),this.widget_clicks_events(),this.jq("#eng_ww_close_"+this.random_id).click(function(){t.hide_widget(t)})}catch(i){console.log("ERROR - events:"),console.log(i)}},ENGAGEYA.prototype.widget_clicks_events=function(){this.attach_on_click_pixel_event()},ENGAGEYA.prototype.attach_on_click_pixel_event=function(){var t=this;if(t.click_pixels)try{for(var i=0;i<t.click_pixels.length;i++){for(var e=t.click_pixels[i],_=e.urls.split(";"),s="",n=0;n<_.length;n++)e.etype&&0!=e.etype?1==e.etype&&(s=_):s+='<img src="'+_[n]+'" style="display:none;" width="1px" height="1px" />';var r=".eng_widget_href,.eng_m_widget_href";if(0!=e.type){var d=t.rec_types[e.type];r=".eng_widget_href."+d+",.eng_m_widget_href."+d}e.etype&&0!=e.etype?1==e.etype&&t.get_recs_holder_elm().find(r).mousedown({pxls:s},function(t){try{for(var i=t.data.pxls,e=0;e<i.length;e++){var _=i[e],s=_.match("engcval_(.*?)['|\"],");if(s&&s.length>1){var n="engcval_"+s[1],r=s[1],d=".*?href=.*?"+r+"=(.*?)&",o=this.outerHTML.match(d);if(o&&o[1]){var a=decodeURIComponent(o[1]);_=_.replace(n,a)}}ga("send",_)}}catch(t){console.log("ERROR - ga click event"),console.log(t)}}):t.get_recs_holder_elm().find(r).mousedown({pxls:s},function(i){t.jq(this).append(i.data.pxls)})}}catch(o){console.log("ERROR - click pixel"),console.log(o)}},ENGAGEYA.prototype.widget_imgs_events=function(){this.attach_on_img_error_event(),this.attach_on_hover_brand_img_event()},ENGAGEYA.prototype.attach_on_hover_brand_img_event=function(){var t=this,i=this.get_add_data("brnd");i&&i.imghvr&&t.get_recs_holder_elm().hover(function(){t.jq(this).find("#eng_brnd_img_"+t.widget_id).attr("src",i.imghvr)},function(){t.jq(this).find("#eng_brnd_img_"+t.widget_id).attr("src",i.img.src)}),i&&i.img2hvr&&t.get_recs_holder_elm().hover(function(){t.jq(this).find("#eng_brnd_img2_"+t.widget_id).attr("src",i.img2hvr)},function(){t.jq(this).find("#eng_brnd_img2_"+t.widget_id).attr("src",i.img2.src)})},ENGAGEYA.prototype.attach_on_img_error_event=function(){var t=this;t.get_recs_holder_elm().find(".eng_widget_img,.eng_m_widget_img").error(function(){try{var i=1*this.outerHTML.match(".*?_img_(.*?)_.*")[1],e=t.image_load_retries_arr[i];if("undefined"==typeof e&&(e=t.max_num_of_image_load_retries,t.image_load_retries_arr[i]=e),1>e)t.set_default_image(t,this);else{t.image_load_retries_arr[i]--;var _=this.src.match(".*?//.*?(/.*)")[1],s="";s=t.image_load_retries_arr[i]%2==0?t.aws_images_url+_:t.cdn_images_url+_;var n=this;window.setTimeout(function(){n.src=s+"?"+ +new Date},300)}}catch(r){console.log("ERROR:"),console.log(r),t.set_default_image(t,this)}}),t.get_recs_holder_elm().find(".eng_widget_img,.eng_m_widget_img").load(function(){1*this.outerHTML.match(".*?_img_(.*?)_.*")[1];t.jq(this).unbind("error")})},ENGAGEYA.prototype.set_default_image=function(t,i){var e=Math.floor(3*Math.random()+1),_=t.custom_default_image||"//"+t.default_imgs_url+"def/def_"+e+".jpg";t.jq(i).unbind("error").attr("src",_)},ENGAGEYA.prototype.start_run=function(){"complete"==document.readyState||"loaded"==document.readyState||"interactive"==document.readyState?this.doc_ready(this):this.inj_init_binding(this)},ENGAGEYA.prototype.doc_ready=function(t){t.doc_ready_called||(t.doc_ready_called=!0,t.load_jQuery(),t.validate_jquery_loaded(this))},ENGAGEYA.prototype.validate_jquery_loaded=function(t){if(t.jq)t.inner_run();else if(window.jQuery)t.jq=window.jQuery,t.isNoConflictJquery&&jQuery.noConflict(),t.inner_run();else if(t.num_of_jq_attempts--,t.num_of_jq_attempts>0)return void window.setTimeout(function(){t.validate_jquery_loaded(t)},100)},ENGAGEYA.prototype.load_jQuery=function(){window.jQuery?this.jq=window.jQuery:this.append_script_to_head("//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js","")},ENGAGEYA.prototype.inner_run=function(t){var i=t||this;if(window[i.cb]=function(t){if(t&&t.recs.length>0){for(var i=null,e=!1,_=0;_<_ENGAGEYA_WIDGETS.length;_++)if("undefined"!=typeof t.rndid&&_ENGAGEYA_WIDGETS[_].random_id==t.rndid){i=_ENGAGEYA_WIDGETS[_],t.widget.id=_ENGAGEYA_WIDGETS[_].widget_id,e=!0;break}if(!e)for(var _=0;_<_ENGAGEYA_WIDGETS.length;_++)if(_ENGAGEYA_WIDGETS[_].widget_id==t.widget.id){i=_ENGAGEYA_WIDGETS[_],e=!0;break}if(i){i.data_json=t,i.widget_id=t.widget.id;var s={widget:t.widget.additionalData||"{}",network:t.widget.anad||"{}"};i.populate_add_data(s),i.populate_widget_data(t),i.reposition_widget(),i.build_layout(),i.add_player_wmode(),i.attach_widget_events(),i.run_criteo()}}},i.widget_wrapper_elm=document.getElementById(i.widget_wrapper_elm_id),!i.widget_wrapper_elm)return i.find_wrapper_elm_retries>0?(i.find_wrapper_elm_retries--,void window.setTimeout(function(){i.inner_run(i)},50)):void console.log("INFO: Couldn't find element "+i.widget_wrapper_elm_id);i.create_placement(),i.is_widget_wrapper_dom_ready=!0;var e=i.get_page_url(),_=i.get_lang(),s=i.get_page_ttl(),n=i.get_meta_content("keywords","content"),r=document.characterSet?document.characterSet:document.charset,d="";1==i.is_index_page?(i.is_premium()&&(i.recs_url=i.recs_url_premium),d="//"+i.recs_url+"?cb="+i.cb+"&pubid="+i.publisher_id+"&webid="+i.website_id+"&wid="+i.widget_id+"&recsnum="+i.num_of_slides+"&url="+e+"&cs="+r+"&subid="+i.subid+"&title="+s+"&kwrds="+n+"&rndid="+i.random_id):d="//"+i.feed_url+"?cb="+i.cb+"&format=json&action=paid&url="+e+"&count="+i.num_of_slides+"&min_count="+i.min_slides+"&is_xpath=0&lang="+_+"&cs="+r+"&pid="+i.pid+"&subid="+i.subid+"&title="+s+"&kwrds="+n,i.append_script_to_head(d,i.random_id),_ENGAGEYA_WIDGETS.push(i)},ENGAGEYA.prototype.load_real_imps_events=function(){function t(t){return function(){var i=t.is_elm_visible(t.widget_wrapper_elm);if(i&&!t.is_real_imps_called){t.is_real_imps_called=!0;var e=t.data_json,_=t.visible_posts_and_types;if(_.length>0){for(var s="",n=0;n<_.length;n++)s+=_[n].pi+":"+_[n].pt,n!=_.length-1&&(s+=",");var r=new Date,d=r.getTime()-t.load_time_start,o=document.createElement("img");o.src="//"+t.event_url+"?irid="+e.requestId+"&webid="+e.srcWebsiteId+"&wid="+e.srcWidgetId+"&spid="+e.srcPostId+"&tpids="+s+"&tti="+d+"&ucc="+e.requestGeoCountry;try{document.getElementsByTagName("head")[0].appendChild(o)}catch(a){console.log("ERROR - real imps:"),console.log(a)}}}return i}}var i=this.data_json.widget;if(i&&i.isRealImpressions){var e=t(this);window.addEventListener?(addEventListener("DOMContentLoaded",e,!1),addEventListener("load",e,!1),addEventListener("scroll",e,!1),addEventListener("resize",e,!1)):window.attachEvent&&(attachEvent("onDOMContentLoaded",e),attachEvent("onload",e),attachEvent("onscroll",e),attachEvent("onresize",e))}},ENGAGEYA.prototype.run_criteo=function(){if(this.get_add_data("criteo")){var t=document.createElement("script");t.type="text/javascript",t.src="//widget.engageya.com/eng_crt_loader.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(t,i)}},ENGAGEYA.prototype.isShouldBeRTL=function(t){try{var i=/[\u0590-\u083F]|[\u08A0-\u08FF]|[\uFB1D-\uFDFF]|[\uFE70-\uFEFF]/gm,e=t.match(i);if(!e)return!1}catch(_){console.log("ERROR: text direction - "+t)}return!0},ENGAGEYA.prototype.is_elm_visible=function(t){var i=t.getBoundingClientRect(),e=100;try{return i.bottom>e&&i.right>0&&i.left<(window.innerWidth||document.documentElement.clientWidth)&&i.top<(window.innerHeight||document.documentElement.clientHeight)-e}catch(_){return!1}},ENGAGEYA.prototype.is_premium=function(){try{var t=this.publisher_id,i=this.premium_pub_ids;return t&&this.in_array(t,i)?!0:!1}catch(e){return!1}},ENGAGEYA.prototype.populate_widget_data=function(t){try{var i=t.widget,e=i.layoutTypeId;this.widget_img_size=26==e?4:2,this.vertical_widget_img_size=null;var _=this.get_add_data("jsvls");_&&_.vcis&&this.is_mobile_conditions_satisfied()&&(this.vertical_widget_img_size=_.vcis),this.is_order_by_post_id&&this.sort_results_by_post_id()}catch(s){console.log("ERROR - widget data:"),console.log(s)}},ENGAGEYA.prototype.sort_results_by_post_id=function(){var t=this.data_json.srcWebsiteId,i=this.jq.extend({},this.data_json.recs),e=[];for(var _ in i)i[_].partner_id==t&&e.push(i[_]);e.sort(function(t,i){return i.postId-t.postId});for(var s=0;s<this.data_json.recs.length;s++){var n=this.data_json.recs[s].partner_id;n==t&&e[s]&&(this.data_json.recs[s]=e[s])}},ENGAGEYA.prototype.reposition_widget=function(){if(this.widget_wrapper_positioning_obj){var t=this.widget_wrapper_positioning_obj.elm,i=this.widget_wrapper_positioning_obj.type;if(this.jq(t).length>0){var e=this.jq(this.widget_wrapper_elm).detach();switch(i){case 0:e.appendTo(t);break;case 1:e.prependTo(t);break;case 2:e.insertAfter(t);break;case 3:e.insertBefore(t);break;default:e.appendTo(t)}this.width=null,this.calculate_widget_wrapper_dims()}}},ENGAGEYA.prototype.populate_add_data=function(t){try{var i=JSON.parse(t.widget.replace(/\[rid\]/g,this.random_id)),e=JSON.parse(t.network.replace(/\[rid\]/g,this.random_id));!i.brnd&&e&&e.brnd&&(i.brnd=e.brnd),this.widget_add_data=i;var _=this.widget_add_data.jcss||{},s=this.widget_add_data.jsvls||{};this.slide_height=_.sh||(this.is_video_widget?150:115),this.slide_width=_.sw||(this.is_video_widget?200:140),this.slide_horz_margin=_.shm||10,this.widget_lpadding=_.wlp||(this.is_video_widget?15:0),this.widget_rpadding=_.wrp||(this.is_video_widget?15:0),this.widget_rmargin=_.wrm||(this.is_video_widget?2:0),this.widget_lmargin=_.wlm||(this.is_video_widget?2:0),this.slides_wrapper_lpadding=_.swlp||0,this.slides_wrapper_rpadding=_.swrp||0,this.slides_wrapper_lmargin=_.swlm||0,this.slides_wrapper_rmargin=_.swrm||0,this.slide_bpadding=_.sbp||(this.is_video_widget?15:5),this.slide_tpadding=_.stp||(this.is_video_widget?15:5),this.widget_txt_direction=_.wtdir||null,this.widget_img_size=s.cis||2,this.num_of_slides_a_row=s.spr||(this.is_video_widget?3:null),this.num_of_mobile_slides_a_row=s.mspr||(this.is_video_widget?3:null),this.is_cancel_click_bubble=s.iccb||!1,this.max_width_for_mobile=s.mwfm||420,this.is_vertical_mobile_widget="undefined"!=typeof s.ivmw&&0==s.ivmw?!1:!0,this.is_force_vertical_layout=s.ifvl||!1,this.num_of_mobile_slides=s.noms||6,this.is_default_brand=!this.website_id||this.website_id<127432?s.isdb:"undefined"!=typeof s.isdb&&0==s.isdb?!1:!0,this.title_elm_type=s.ttlelm?s.ttlelm:"div",this.width=s.rplcwidth&&s.rplcwidthval&&s.rplcwidth==Math.floor(this.width)?s.rplcwidthval:this.width,this.widget_wrapper_positioning_obj=s.wwpo?s.wwpo:null,this.max_width_for_tablet_cls=s.mwftc||null,this.image_size_for_rec_num=s.cisfrm||null,this.is_order_by_post_id=s.iobpi||null,this.custom_default_image=s.cdi||null,this.is_description_span=s.idesc||null,this.is_links_open_new_window=s.inw||null,this.max_description_chars=s.mdc||1e3,this.max_mobile_description_chars=s.mmdc||1e3}catch(n){console.log("ERROR - additional data:"),console.log(n)}},ENGAGEYA.prototype.get_add_data=function(t){return this.widget_add_data&&this.widget_add_data[t]?this.widget_add_data[t]:null},ENGAGEYA.prototype.set_add_data=function(t,i){this.widget_add_data[t]=i},ENGAGEYA.prototype.add_player_wmode=function(){},ENGAGEYA.prototype.get_page_url=function(){if(this.input_url)return this.input_url;var t=document.location.href;return this.is_in_iframe()&&(t=document.referrer?document.referrer:t),t=encodeURIComponent(t)},ENGAGEYA.prototype.get_total_slides=function(t,i){for(var e=this.num_of_slides_a_row*t,_=e;_>i&&t>1;)t--,_=this.num_of_slides_a_row*t;return this.is_mobile_conditions_satisfied()&&(_=this.num_of_mobile_slides?this.num_of_mobile_slides:_),_=_>i?i:_},ENGAGEYA.prototype.build_layout=function(){1==this.is_vertical_mobile_widget&&this.is_mobile_conditions_satisfied()||this.is_force_vertical_layout?this.build_vertical_layout():this.build_horizontal_layout()},ENGAGEYA.prototype.is_mobile_conditions_satisfied=function(){return!this.is_video_widget&&this.is_mobile()&&this.width<this.max_width_for_mobile?!0:!1},ENGAGEYA.prototype.build_vertical_layout=function(){var t=this.data_json,i=Math.min(this.num_of_mobile_slides,t.recs.length),e=this.get_recs_holder_elm(),_="eng_m_top_ww_widget_"+this.random_id,s=this.get_tablet_cls(),n=this.get_mobile_device_OS(),r=n?"_"+n:"",d='<div class="eng_m_top_ww_widget'+r+s+'" id="'+_+'"><div class="eng_m_ww_widget" id="eng_m_ww_widget_'+this.widget_id+'">';this.populate_widget_directions();var o=this.get_default_css("MOBILE_VERTICAL",_),a="<"+this.title_elm_type+' class="eng_m_ww_title" id="eng_m_ww_title_'+this.random_id+'"><span class="eng_m_ww_ttl_span1">'+t.widget.headerText+'</span><span class="eng_m_ww_ttl_span2"></span></'+this.title_elm_type+">",l='<div class="eng_m_asw" id="eng_m_asw_'+this.random_id+'">';d+=a+l;for(var g=t.recs,h="",p=0;i>p;p++){var c=g[p].postId,m=g[p].recTypeDB,w=this.get_display_name(g[p]);this.visible_posts_and_types.push({pi:c,pt:m});var u=this.is_video_post(g[p])?" eng_m_widget_vsw":"",f='<div id="eng_m_sw_'+p+"_"+this.widget_id+'" class="eng_m_widget_sw'+u+'">',v=this.get_rec_type(g[p]),y='<a id="eng_m_href_'+p+"_"+this.widget_id+'" class="eng_m_widget_href '+v+'" ',E='<div id="eng_m_img_w_'+p+"_"+this.widget_id+'" class="eng_m_widget_img_w"><img id="eng_m_img_'+p+"_"+this.widget_id+'" class="eng_m_widget_img" ',b=this.is_video_widget?this.shorten(g[p].title,50):this.shorten(g[p].title,150),G=this.get_description(g[p]),A="";"rtl"!=this.widget_txt_direction||this.isShouldBeRTL(b)||(A='style="direction:ltr;text-align:left;"');var x='<div id="eng_m_in_'+p+"_"+this.widget_id+'" class="eng_m_widget_in" '+A+">",N='<span id="eng_m_is_'+p+"_"+this.widget_id+'" class="eng_m_widget_is">',Y=this.is_description_span?'<span id="eng_m_isd_'+p+"_"+this.widget_id+'" class="eng_m_widget_isd">'+G+"</span>":"",j=w?'<span id="eng_m_dn_'+p+"_"+this.widget_id+'" class="eng_m_widget_dn">':"";y+=this.get_click_defs(g[p],t.srcWebsiteId);var k=this.get_thumb(t,g[p].thumbnail_path,g[p].category_id,p+1);E+='src="'+k+'" data-pin-no-hover="true" /></div>',N+=b+"</span>",j+=w?w+"</span>":"",f+=y+E+x+N+Y+j,f+="</div></a></div>",d+=f,d+=this.add_row_if_required(p+1,this.num_of_slides_a_row,i),h+=this.get_impression_pixel_imgs(t.recs[p].impressionUrls)}var T=this.get_widget_branding();d+='</div><div id="eng_m_brnd_'+this.widget_id+'" class="eng_m_branding">'+T+"</div></div>",d+=h+"</div>";var R=this.get_add_data("css")||"";widgetCss="<style>"+o+R+"</style>",e.html(widgetCss+d)},ENGAGEYA.prototype.build_horizontal_layout=function(){var t=this.data_json;this.calc_slides_dims();var i=t.widget.displayRows,e=this.get_total_slides(i,t.recs.length),_=this.get_recs_holder_elm(),s=this.is_mobile_conditions_satisfied()?"m_":"",n="eng_"+s+"top_ww_widget_"+this.random_id,r=this.get_tablet_cls(),d='<div class="eng_top_ww_widget'+r+'" id="'+n+'"><div class="eng_ww_widget" id="eng_ww_widget_'+this.widget_id+'">';this.populate_widget_directions();var o=this.get_default_css("DESKTOP_VIDEO",n),a=this.get_default_css("DESKTOP_NON_VIDEO",n),l=this.get_default_css("DESKTOP",n);l+=this.is_video_widget?o:a;var g="<"+this.title_elm_type+' class="eng_ww_title" id="eng_ww_title_'+this.random_id+'"><span class="eng_ww_ttl_span1">'+t.widget.headerText+'</span><span class="eng_ww_ttl_span2"></span></'+this.title_elm_type+">",h=this.is_video_widget?'<div class="eng_ww_close" id="eng_ww_close_'+this.random_id+'"><span>&times</span></div>':"",p='<div class="eng_asw" id="eng_asw_'+this.random_id+'">';d+=g+h+p;for(var c=t.recs,m="",w=0;e>w;w++){var u=c[w].postId,f=c[w].recTypeDB;this.visible_posts_and_types.push({pi:u,pt:f}),this.is_start_of_row(w,this.num_of_slides_a_row)&&(l+="#eng_sw_"+w+"_"+this.widget_id+"{margin-"+this.widget_direction+":0px !important;}");var v=this.is_video_post(c[w])?" eng_widget_vsw":"",y='<div id="eng_sw_'+w+"_"+this.widget_id+'" class="eng_widget_sw'+v+'">',E=this.get_rec_type(c[w]),b='<a id="eng_href_'+w+"_"+this.widget_id+'" class="eng_widget_href '+E+'" ',G='<div id="eng_img_w_'+w+"_"+this.widget_id+'" class="eng_widget_img_w"><img id="eng_img_'+w+"_"+this.widget_id+'" class="eng_widget_img" ',A=this.shorten(c[w].title,100),x=this.get_description(c[w]),N="";"rtl"!=this.widget_txt_direction||this.isShouldBeRTL(A)||(N='style="direction:ltr;text-align:left;"');var Y='<div id="eng_in_'+w+"_"+this.widget_id+'" class="eng_widget_in" '+N+">",j='<span id="eng_is_'+w+"_"+this.widget_id+'" class="eng_widget_is">',k=this.is_description_span?'<span id="eng_isd_'+w+"_"+this.widget_id+'" class="eng_widget_isd">'+x+"</span>":"",T=this.get_display_name(c[w]),R=T?'<span id="eng_dn_'+w+"_"+this.widget_id+'" class="eng_widget_dn">':"";b+=this.get_click_defs(c[w],t.srcWebsiteId);var I=this.get_thumb(t,c[w].thumbnail_path,c[w].category_id,w+1);G+='src="'+I+'" data-pin-no-hover="true" /></div>',j+=A+"</span>",R+=T?T+"</span>":"",y+=b+G+Y+j+k+R,y+="</div></a></div>",d+=y,d+=this.add_row_if_required(w+1,this.num_of_slides_a_row,e),m+=this.get_impression_pixel_imgs(t.recs[w].impressionUrls)}var q=this.get_widget_branding();d+='</div><div id="eng_brnd_'+this.widget_id+'" class="eng_branding">'+q+"</div></div>",d+=m+"</div>";var S=this.get_add_data("css")||"";widgetCss="<style>"+l+S+"</style>",_.html(widgetCss+d)},ENGAGEYA.prototype.get_default_css=function(t,i){var e="",_=this.get_add_data("vpost"),s=_&&_.pimg?_.pimg:"//"+this.default_video_post_btn;switch(t){case"DESKTOP":e="#"+i+" .eng_top_ww_widget{}#"+i+" .eng_ww_widget{display:inline-block;direction:"+this.widget_txt_direction+";position:relative;margin-bottom:2px;margin-left:"+this.widget_lmargin+"px;margin-right:"+this.widget_rmargin+"px;text-align:center;padding-left:"+this.widget_lpadding+"px;padding-right:"+this.widget_rpadding+"px;padding-top:"+this.slide_tpadding+"px;padding-bottom:"+this.slide_bpadding+"px;}#"+i+" .eng_ww_title{text-align:"+this.widget_direction+";}#"+i+" .eng_ww_close{position:absolute;top:8px;"+this.widget_op_direction+":8px;cursor:pointer;font-size:20px;}#"+i+" .eng_asw{display:block;margin-left:"+this.slides_wrapper_lmargin+"px;margin-right:"+this.slides_wrapper_rmargin+"px;padding-left:"+this.slides_wrapper_lpadding+"px;padding-right:"+this.slides_wrapper_rpadding+"px;}#"+i+" .eng_widget_sw{width:"+this.slide_width+"px;text-align:"+this.widget_direction+";position:relative;display:inline-block;margin-"+this.widget_direction+":"+this.slide_horz_margin+"px;}#"+i+" .eng_widget_in{width:100%;}#"+i+" .eng_widget_is{}#"+i+" .eng_widget_dn{font-size:10px;text-decoration:none !important;display:inline-block;width:100%;}#"+i+" .eng_widget_img{width:100%;height:auto;border-radius:inherit;margin-bottom:5px;}#"+i+" .eng_widget_href{border-radius:inherit;}#"+i+" .eng_rows_seperator{height:10px;}#"+i+" .eng_branding{text-align:"+this.widget_op_direction+";margin:8px 0px 0px 0px;}#"+i+" .eng_branding a{color:#BBB;font-size:12px;font-family:arial;}";break;case"DESKTOP_NON_VIDEO":e="#"+i+" .eng_ww_widget{color:#000;}#"+i+" .eng_widget_sw{vertical-align:top;margin-bottom:10px}#"+i+" .eng_widget_vsw .eng_widget_img_w::after{content:'';background-image: url("+s+");position:absolute;left:40%;top:42%;width:35px;height:26px;z-index:2;}#"+i+" .eng_widget_href{position:relative;display:block !important;visibility:visible !important;}#"+i+" .eng_widget_in{width:100%;line-height:1.4;}#"+i+" .eng_widget_dn{color:#CDCDCD;}#"+i+" .eng_ww_title{padding:0px;margin:0px 0px 5px 0px;}#"+i+" .eng_ww_ttl_span1{display:block;padding:5px 0px;float:none !important;}#"+i+" .eng_widget_img_w{position:relative;}#"+i+" .eng_widget_img{margin-bottom:5px;display:block;}";break;case"DESKTOP_VIDEO":e="#"+i+" .eng_ww_widget{background-color:rgba(1, 1, 1, 0.9);color:#FFF;}#"+i+" .eng_widget_in{position:absolute;background-color:rgba(36,36,36,0.8);color:#FFF;font-size:12px;line-height:normal !important;bottom:0px;}#"+i+" .eng_widget_sw{height:"+this.slide_height+"px;}#"+i+" .eng_widget_dn{}#"+i+" .eng_widget_is{display:block;padding: 2px 5px 2px 5px;}#"+i+" .eng_ww_title{padding:0px 0px 5px 0px;font-size:15px;}";break;case"MOBILE_VERTICAL":e="#"+i+" .eng_m_top_ww_widget{}#"+i+" .eng_m_ww_widget{display:inline-block;direction:"+this.widget_txt_direction+";position:relative;margin-bottom:2px;margin-left:"+this.widget_lmargin+"px;margin-right:"+this.widget_rmargin+"px;text-align:center;padding-left:"+this.widget_lpadding+"px;padding-right:"+this.widget_rpadding+"px;padding-top:"+this.slide_tpadding+"px;padding-bottom:"+this.slide_bpadding+"px;}#"+i+" .eng_m_ww_title{padding:0px 0px 5px 0px;text-align:"+this.widget_direction+";}#"+i+" .eng_m_asw{display:block;margin-left:"+this.slides_wrapper_lmargin+"px;margin-right:"+this.slides_wrapper_rmargin+"px;padding-left:"+this.slides_wrapper_lpadding+"px;padding-right:"+this.slides_wrapper_rpadding+"px;}#"+i+" .eng_m_widget_sw{width:100%;padding-bottom:8px;}#"+i+" .eng_m_widget_vsw .eng_m_widget_img_w::after{content:'';background-image: url("+s+");position:absolute;"+this.widget_direction+":37%;top:42%;width:35px;height:26px;z-index:2;}#"+i+" .eng_m_widget_in{width:57%;display:inline-block;vertical-align:top;text-align:"+this.widget_direction+";}#"+i+" .eng_m_widget_is{line-height:1.4;}#"+i+" .eng_m_widget_dn{font-size:10px;padding:5px 5px 3px 0px;color:#999999;display:block;}#"+i+" .eng_m_widget_img_w{width:40%;margin-"+this.widget_op_direction+":3%;display:inline-block;position:relative;}#"+i+" .eng_m_widget_img{width:100%;}#"+i+" .eng_m_ww_ttl_span1{display:block;padding:5px 0px;float:none !important;}#"+i+" .eng_m_widget_href{border-radius:inherit;display:block !important;visibility:visible !important;}#"+i+" .eng_m_rows_seperator{height:8px;}#"+i+" .eng_m_branding{text-align:"+this.widget_op_direction+";margin:8px 0px 0px 0px;}#"+i+" .eng_m_branding a{color:#BBB;font-size:12px;font-family:arial;}"}return e},ENGAGEYA.prototype.get_description=function(t){if(t){var i=t.description;try{var e;if(e=this.is_mobile_conditions_satisfied()?this.max_mobile_description_chars:this.max_description_chars,i&&i.length>e){i=i.replace("...",""),i=i.trim();var _=i.lastIndexOf(" ");i=i.substring(0,_);var s=i.charAt(i.length-1);(","==s||"."==s||"-"==s||"|"==s)&&(i=i.substring(0,i.length-1).trim()),i+="..."}}catch(n){console.log("ERROR"),console.log(n)}return i}},ENGAGEYA.prototype.get_click_defs=function(t,i){var e=this.get_href_target(t.partner_id,i),_=this.get_cancle_click_bubble(),s='onclick="'+_+'"',n=t.ajx?!0:!1,r="",d=t.clickUrl;if(n)window.ajx_sprk_click=function(t){},r+=e+' href="'+t.url+'" '+s+' title="'+t.title+'" onmousedown="_eng_do_async_click(\''+d+"');"+_+'return true;">';else{if(this.is_in_iframe()){var o=this.get_page_url();o&&(o=encodeURIComponent(decodeURIComponent(o)),d=d+"&cr="+o)}r+=e+' href="'+t.url+'" '+s+' title="'+t.title+'" onmousedown="this.href=\''+d+"';"+_+'return true;">'}return r},ENGAGEYA.prototype.get_rec_type=function(t){var i=t.recType.split("_"),e="eng_"+i[1].toLowerCase();return e},ENGAGEYA.prototype.is_video_post=function(t){var i=!1,e=this.get_add_data("vpost");return e&&e.drgx&&(i=null!=t.url.match(e.drgx)),i},ENGAGEYA.prototype.get_impression_pixel_imgs=function(t){var i="";if(t&&null!=t&&t.length>0)for(var e=0;e<t.length;e++)i+='<img src="'+t[e]+'" style="display:none;" width="1px" height="1px" />';return i},ENGAGEYA.prototype.get_display_name=function(t){var i="",e=[2,3,4,8,18,19,20,21,30],_=1*t.recTypeDB;return this.in_array(_,e)&&(i=this.shorten(t.displayName,20)),i},ENGAGEYA.prototype.populate_widget_directions=function(){this.widget_txt_direction=this.widget_txt_direction||this.get_recs_holder_elm().css("direction");var t="rtl"==this.widget_txt_direction?!0:!1;this.widget_direction=t?"right":"left",this.widget_op_direction=t?"left":"right"},ENGAGEYA.prototype.get_cancle_click_bubble=function(){return this.is_cancel_click_bubble?"event&&event.cancelBubble&&(event.cancelBubble=true);event&&event.stopPropagation&&(event.stopPropagation());":""},ENGAGEYA.prototype.get_recs_holder_elm=function(){return this.jq("#eng_recs_holder_"+this.random_id)},ENGAGEYA.prototype.align_widget_elements=function(){this.align_widget_title()},ENGAGEYA.prototype.get_widget_branding=function(){var t="",i=null,e={img:"",img2:""};this.get_add_data("jsvls");if(this.is_default_brand){var _="//"+this.default_imgs_url;i=this.get_add_data("brnd")||{href:"//www.engageya.com",name:"",ttl:"Engageya",img:{src:_+"eng_logo.png",width:41,height:12},imghvr:_+"eng_logo_c.png",href2:"",name2:"",ttl2:"",img2:"",img2hvr:""},this.set_add_data("brnd",i)}else i=this.get_add_data("brnd")||{href:"",name:"",ttl:"",img:"",imghvr:"",adds:"",href2:"",name2:"",ttl2:"",img2:"",adds2:"",img2hvr:""};if(i.adds||(i.adds=""),i.img){var s=i.img;e.img='<img id="eng_brnd_img_'+this.widget_id+'" class="eng_brnd_img" src="'+s.src+'" width="'+s.width+'px" height="'+s.height+'px"/>'}if(i.img2){var s=i.img2;e.img2='<img id="eng_brnd_img2_'+this.widget_id+'" class="eng_brnd_img2" src="'+s.src+'" width="'+s.width+'px" height="'+s.height+'px"/>'}return(i.name||i.img)&&(t='<a href="'+i.href+'" '+i.adds+' target="_blank" title="'+i.ttl+'">'+i.name+e.img+"</a>"),(i.name2||i.img2)&&(i.href2=i.href2||"",i.ttl2=i.ttl2||"",i.name2=i.name2||"",t+='<a href="'+i.href2+'" '+i.adds2+' target="_blank" title="'+i.ttl2+'">'+i.name2+e.img2+"</a>"),t},ENGAGEYA.prototype.is_mobile=function(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}},ENGAGEYA.prototype.get_tablet_cls=function(){var t="";return this.is_tablet_conditions_satisfied()&&(t=" eng_tablet"),t},ENGAGEYA.prototype.is_tablet_conditions_satisfied=function(){return this.is_mobile()&&!this.is_mobile_conditions_satisfied()&&this.max_width_for_tablet_cls&&this.max_width_for_tablet_cls>=this.width?!0:!1},ENGAGEYA.prototype.get_mobile_device_OS=function(){var t="";if(this.is_mobile())return t=navigator.userAgent.match(/Android/i)?"android":navigator.userAgent.match(/iPhone|iPad|iPod/i)?"ios":"other"},ENGAGEYA.prototype.align_widget_title=function(){},ENGAGEYA.prototype.get_thumb=function(t,i,e,_){var s,n=this.widget_img_size,r=4,d=3;if(this.vertical_widget_img_size&&(n=this.vertical_widget_img_size,r=17),this.image_size_for_rec_num)if(r=17,this.image_size_for_rec_num.phone&&this.is_mobile_conditions_satisfied())for(var o=0;o<this.image_size_for_rec_num.phone.length;o++)this.image_size_for_rec_num.phone[o][0]==_&&(n=this.image_size_for_rec_num.phone[o][1]);else if(this.image_size_for_rec_num.tablet&&this.is_tablet_conditions_satisfied())for(var o=0;o<this.image_size_for_rec_num.tablet.length;o++)this.image_size_for_rec_num.tablet[o][0]==_&&(n=this.image_size_for_rec_num.tablet[o][1]);else if(this.image_size_for_rec_num.desktop)for(var o=0;o<this.image_size_for_rec_num.desktop.length;o++)this.image_size_for_rec_num.desktop[o][0]==_&&(n=this.image_size_for_rec_num.desktop[o][1]);
if(i)for(var o=1;r>=o;o++)if(o!=n&&(s=i.lastIndexOf("_"+o+"."),-1!=s)){o>=10&&(d=4),i=i.substr(0,s)+"_"+n+"."+i.substr(s+d);break}return i},ENGAGEYA.prototype.shorten=function(t,i){if(!t)return"";var e=t.length,_=t.indexOf(" ",i);return-1==_?i>=e?t:t.substring(0,i)+"...":(sS=t.substring(0,_),sS.length<e&&(sS+="..."),sS)},ENGAGEYA.prototype.click=function(t,i,e){return t.href=i,!0},ENGAGEYA.prototype.get_href_target=function(t,i){var e="";return t!=i||this.is_links_open_new_window?e='target="_blank"':this.is_in_iframe()&&(e='target="_parent"'),e},ENGAGEYA.prototype.is_in_iframe=function(){var t=window.self!==window.top?!0:!1;return t},ENGAGEYA.prototype.is_start_of_row=function(t,i){return t%i==0?!0:!1},ENGAGEYA.prototype.add_row_if_required=function(t,i,e){return t%i==0&&t!=e?'<div style="clear: both" class="eng_rows_seperator"></div>':""},ENGAGEYA.prototype.floor_figure=function(t,i){i||(i=2);var e=Math.pow(10,i);return(parseInt(t*e)/e).toFixed(i)},ENGAGEYA.prototype.calc_slides_dims=function(){try{var t=this.width-this.widget_lpadding-this.widget_rpadding-this.widget_rmargin-this.widget_lmargin-this.slides_wrapper_lpadding-this.slides_wrapper_rpadding-this.slides_wrapper_lmargin-this.slides_wrapper_rmargin,i=Math.floor(t/this.slide_width),e=Math.floor((t-(i-1)*this.slide_horz_margin)/this.slide_width);this.get_add_data("jsvls");this.is_mobile_conditions_satisfied()?this.num_of_slides_a_row=this.num_of_mobile_slides_a_row?this.num_of_mobile_slides_a_row:e:this.num_of_slides_a_row=this.num_of_slides_a_row?this.num_of_slides_a_row:e;var _=this.get_add_data("jcss");if(0==this.num_of_slides_a_row&&t>99&&(this.slide_width=t,this.num_of_slides_a_row=1),!this.is_video_widget&&this.num_of_slides_a_row>1&&(!_||!_.sw)){var s=t-this.num_of_slides_a_row*this.slide_width-this.slide_horz_margin*(this.num_of_slides_a_row-1),n=s/this.num_of_slides_a_row+this.slide_width;this.slide_width=this.floor_figure(n,2)}}catch(r){this.num_of_slides_a_row=1,console.log("ERROR"),console.log(r)}},ENGAGEYA.prototype.populate_required_fields=function(){this.calculate_widget_wrapper_dims()},ENGAGEYA.prototype.calculate_widget_wrapper_dims=function(){var t=1==this.is_video_widget?document.getElementById(this.plr_elm_id):this.widget_wrapper_elm;t=t?t:this.widget_wrapper_elm;var i=t;this.width=this.width?this.width:this.jq(t).width();var e=this.get_exact_width(t);e&&(this.width=e),this.height=this.height?this.height:this.jq(t).height();try{for(;t&&(0===this.height||this.height<100)&&this.jq(t).parent();)t&&(t=this.jq(t).parent().get(0),this.height=this.jq(t).height());for(t=i;t&&(0===this.width||this.width<100)&&this.jq(t).parent();)t=this.jq(t).parent().get(0),t&&(this.width=this.jq(t).width(),e=this.get_exact_width(t),this.width=e?e:this.width)}catch(_){console.log("ERROR"),console.log(_)}},ENGAGEYA.prototype.get_exact_width=function(t){var i=this.jq(t)[0].getBoundingClientRect().width;return i&&Math.abs(i-this.width)>0&&Math.abs(i-this.width)<1?i:null},ENGAGEYA.prototype.create_placement=function(){this.populate_required_fields();var t=document.createElement("div");t.id="eng_recs_holder_"+this.random_id,t.className="eng_recs_holder",this.widget_wrapper_elm.appendChild(t);var i=document.createElement("style");i.type="text/css";var e=this.is_video_widget?"none":"block",_="#eng_recs_holder_"+this.random_id+" .eng_widget_sw:hover{zoom:1;filter:alpha(opacity=100);opacity:1;-webkit-filter: brightness(120%);filter: brightness(1.2);}#eng_recs_holder_"+this.random_id+" .eng_widget_sw{filter:alpha(opacity=90);opacity:0.9;}#eng_recs_holder_"+this.random_id+"{height:"+(this.height-40)+"px;-webkit-transform-style: preserve-3d;-moz-transform-style: preserve-3d;transform-style: preserve-3d;}#eng_top_ww_widget_"+this.random_id+"{position: relative;top: 50%;transform: translateY(-50%);width: 100%;}",s="";this.is_video_widget&&(this.jq(this.widget_wrapper_elm).parent().css("position","relative"),s+=_,s+=".eng_recs_holder{width: 100%;top:0px;position: absolute;text-align:center;z-index:999999;background-color: rgba(1, 1, 1, 0.6);}#eng_recs_holder_"+this.random_id+"{display:"+e+";}.eng_recs_holder a{text-decoration:none;}"),i.styleSheet?i.styleSheet.cssText=s:i.appendChild(document.createTextNode(s)),document.getElementsByTagName("head")[0].appendChild(i)},ENGAGEYA.prototype.get_page_ttl=function(){var t="",i=document.getElementsByTagName("title");if(i&&i.length>0)try{t=i[0].innerText||i[0].textContent,t=t.substring(0,100).substring(0,t.lastIndexOf(" ")),t=encodeURIComponent(t)}catch(e){}return t},ENGAGEYA.prototype.get_meta_content=function(t,i){for(var e=document.getElementsByTagName("meta"),_="",s=0;s<e.length;s++)if(e[s].getAttribute("property")==t||e[s].getAttribute("name")==t){try{_=e[s].getAttribute(i),_=_.substring(0,200).substring(0,_.lastIndexOf(" ")),_=encodeURIComponent(_)}catch(n){}break}return _},ENGAGEYA.prototype.get_lang=function(){var t=window.navigator.userLanguage||window.navigator.language;return t},ENGAGEYA.prototype.append_script_to_head=function(t,i){var e=document.createElement("script");e.type="text/javascript",e.id=i,e.src=t,e.charset="UTF-8",e.async=!0;var _=document.getElementsByTagName("script")[0];_.parentNode.insertBefore(e,_)},ENGAGEYA.prototype.getQS=function(t){var i=t.replace(/^[^\?]+\??/,""),e=new Object;if(!i)return e;for(var _=i.split(/[;&]/),s=0;s<_.length;s++){for(var n=_[s].replace(/(pid=.*)=.*/,"$1"),r=_[s].length-n.length,d=0;r>d;d++)n+="%3D";var o=n.split(/=(.*)/);if(o&&!(o.length<2)){var a=unescape(o[0]),l=o[1];l=l.replace(/\+/g," "),e[a]=l}}return e},ENGAGEYA.prototype.inj_init_binding=function(t){function i(){if(!called)try{document.documentElement.doScroll("left"),t.doc_ready(t)}catch(e){setTimeout(i,10)}}if(document.addEventListener)document.addEventListener("DOMContentLoaded",t.doc_ready(t),!1);else if(document.attachEvent){try{var e=null!=window.frameElement}catch(_){}document.documentElement.doScroll&&!e&&i(),document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&t.doc_ready(t)})}},ENGAGEYA.prototype.in_array=function(t,i){for(var e in i)if(i[e]==t)return!0;return!1};var _eng_do_async_click=function(t){var i=document.createElement("script");i.type="text/javascript",i.src=t,document.getElementsByTagName("head")[0].appendChild(i)};!function(){var t=function(t,i){switch(t){case"createWidget":var e=new ENGAGEYA(i);e.run()}},i=window.EngageyaObject;window[i].l;for(var e in window[i].q){var _=window[i].q[e],s=_[0],n=_[1];t(s,n)}window[i]=t}();