(function(){this.WorkCreator||(this.WorkCreator={}),this.WorkCreator.notifier=new c.Server.Notification("paper_uploads"),this.WorkCreator.notifier.notifyAndLog=function(e,t,i){return $a.log(e),this.notify({event:e,user_id:$current_user.id,source:i||"three_step",error:t,user_time:parseInt((new Date).getTime()/1e3)})},this.WorkCreator.start=function(e,t,i){return WorkCreator.notifier.notifyAndLog("render-three-step-creator"),t||(t="three_step"),e||(e="Papers"),window.work_creator_router?(window.work_creator_router.resetSection(e),window.work_creator_router.resetSource(t)):window.work_creator_router=new WorkCreator.Router({containerDiv:$("#full-screen-modal"),section:e,source:t,recaptchaKey:i}),$.get($r.api_v0_is_discussion_promotion_qualified_path({subdomain_param:"api"}),function(e){return window.discussion_promotion_qualified=e.qualified,window.survey_eligible=e.survey_eligible}),Backbone.History.started||Backbone.history.start(),window.work_creator_router.navigate("add/classify",{trigger:!0})}}).call(this),function(){this.WorkCreator.Router=Backbone.Router.extend({routes:{"add/classify":"classifyPage","add/upload":"uploadPage","add/paper_details":"paperDetailsPage","add/feedback":"feedbackPage","add/research_interests":"researchInterestsPage","add/share":"sharingPage","add/discussion_invites":"discussionsInvitesPage","add/close":"close","add/success_close":"successClose","add/reset":"reset","add/survey":"survey","add/academia_select_v1":"academiaSelect","add/academia_select":"academiaSelectV2","add/academia_select_submit":"academiaSelectSubmit","add/robot":"robot"},initialize:function(e){return this.container=e.containerDiv,this.section=e.section?e.section:"Papers",this.source=e.source?e.source:"three_step",this.recaptchaKey=e.recaptchaKey},setupLayout:function(){return this.layout?void 0:(this.layout=new WorkCreator.Layout({section:this.section,source:this.source,recaptcha_key:this.recaptchaKey}),this.container.html(this.layout.render().el),this.container.fadeIn())},resetSection:function(e){return this.section=e},resetSource:function(e){return this.source=e},close:function(){return null!=WorkCreator.callback?window.location=WorkCreator.callback:($("#full-screen-modal").fadeOut(),this.layout.remove(),this.layout.undelegateEvents(),this.layout=null,WorkCreator.notifier.notifyAndLog("close-clicked"),$(".this-is-the-wow-profile").length?Backbone.history.navigate(""):void 0)},successClose:function(){return window.location.href=$current_user.url},classifyPage:function(){return this.setupLayout(),this.layout.changePage("ClassifyPaperPage"),WorkCreator.notifier.notifyAndLog("show-classify-page","",this.source)},uploadPage:function(){return this.setupLayout(),this.layout.changePage("UploadPage"),WorkCreator.notifier.notifyAndLog("show-upload-page"),"Draft"===this.layout.currentPage.model.get("type")?WorkCreator.notifier.notifyAndLog("show-upload-page-draft","",this.source):void 0},paperDetailsPage:function(){return this.setupLayout(),this.layout.changePage("PaperDetailsPage"),WorkCreator.notifier.notifyAndLog("show-paper-details-page"),"Draft"===this.layout.currentPage.model.get("type")&&this.layout.currentPage.model.get("primaryAttachment")&&WorkCreator.notifier.notifyAndLog("show-paper-details-page-draft","",this.source),"Draft"!==this.layout.currentPage.model.get("type")||this.layout.currentPage.model.get("primaryAttachment")?void 0:WorkCreator.notifier.notifyAndLog("show-paper-details-page-draft-no-attachment","",this.source)},feedbackPage:function(){return this.setupLayout(),this.layout.changePage("FeedbackPage"),WorkCreator.notifier.notifyAndLog("show-feedback-page","",this.source)},researchInterestsPage:function(){return this.setupLayout(),this.layout.changePage("ResearchInterestsPage"),WorkCreator.notifier.notifyAndLog("show-research-interest-page"),"Draft"===this.layout.currentPage.model.get("type")&&window.feedback_wanted?WorkCreator.notifier.notifyAndLog("show-ri-page-feedback-yes","",this.source):void 0},sharingPage:function(){return this.setupLayout(),this.layout.changePage("SharingPage"),WorkCreator.notifier.notifyAndLog("show-sharing-page","",this.source)},survey:function(){return this.setupLayout(),this.layout.changePage("SurveyPage"),WorkCreator.notifier.notifyAndLog("show-survey-page")},discussionsInvitesPage:function(){return this.setupLayout(),this.layout.changePage("DiscussionInvitesPage"),WorkCreator.notifier.notifyAndLog("show-discussion-invites-page","",this.source)},academiaSelect:function(){return this.setupLayout(),this.layout.changePage("AcademiaSelectPage"),WorkCreator.notifier.notifyAndLog("show-acdemia-select-page","",this.source)},academiaSelectV2:function(){return this.setupLayout(),this.layout.changePage("AcademiaSelectV2Page"),WorkCreator.notifier.notifyAndLog("show-acdemia-select-v2-page","",this.source)},academiaSelectSubmit:function(){return this.setupLayout(),this.layout.changePage("AcademiaSelectSubmitPage"),WorkCreator.notifier.notifyAndLog("show-acdemia-select-submit-page","",this.source)},robot:function(){return this.setupLayout(),this.layout.changePage("RobotCheckPage"),WorkCreator.notifier.notifyAndLog("robot-check-page","",this.source)},reset:function(){return this.layout.resetModel(),this.classifyPage()}})}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/attachments/attachment"]=function(e){var t,i=[],s=e||{};return function(e){i.push('<div class="row attachment"><div class="col-xs-12"><div class="row info"><div class="col-md-1 col-md-offset-1 hidden-xs hidden-sm"><i class="fa fa-file-text-o fa-2x"></i></div><div class="col-md-8 col-xs-9 file-name"><span class="pull-left">'+jade.escape(null==(t=e)?"":t)+'</span></div><div class="col-md-1 col-xs-3"><button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div></div></div></div>')}.call(this,"file_name"in s?s.file_name:"undefined"!=typeof file_name?file_name:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/attachments/no_attachments"]=function(){var e=[];return e.push('<div class="row"><div class="col-md-12"><div class="prompt"><p>drag & drop, or...</p></div><div class="uploader"><span class="btn btn-md btn-success fileinput-button"><span class="h6 text-bold text-wide-letter-space">CHOOSE FILE</span><input type="file" name="files[]"/></span></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/attachments/primary_uploaded"]=function(){var e=[];return e.push('<div class="row"><div class="col-md-12"><h4 class="upload-success-message">Upload Successful!</h4><div class="primary-attachment"></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/attachments/primary_uploading"]=function(){var e=[];return e.push('<div class="row"><div class="col-md-12"><div class="upload-percent text-success">0%</div><div class="progress"><div role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%" class="progress-bar progress-bar-success"><span class="sr-only">0% Complete</span></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/authors/author_module"]=function(){var e=[];return e.push('<div class="form-group"><div class="row"><div class="col-xs-12"><div class="input-group pull-left"><label for="add-coauthors"><span>Authors</span></label></div></div></div><div class="row"><div class="col-xs-12"><div class="select2-no-default-pills"><input id="authors-input" type="hidden" placeholder="&#xf002; add co-authors..." class="work-creator-tag-input"/></div><div class="work-creator-tag-list panel-body bg-white"><ul id="authors-list" class="list-pills list-inline"></ul></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/discussions/eligible_invitee"]=function(e){var t,i=[],s=e||{};return function(e){i.push('<li class="media_v2"><div class="media-left"><img'+jade.attr("src",""+e.photo,!0,!1)+' width="40" height="40" class="invitee-photo"/></div><div class="media-body"><p class="text-bold margin-0x">'+jade.escape(null==(t=e.display_name)?"":t)+"</p>"),e.department&&i.push('<p class="invitee-university-name text-gray margin-0x">'+jade.escape(null==(t=[e.department.university.name,e.position,e.department.name].join(", "))?"":t)+"</p>"),i.push('</div><div class="media-right"><input type="checkbox"'+jade.attr("checked",e.is_brain_trust,!0,!1)+' class="js-invitee-checkbox invitee-checkbox"/></div></li>')}.call(this,"eligibleInvitee"in s?s.eligibleInvitee:"undefined"!=typeof eligibleInvitee?eligibleInvitee:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/discussions/eligible_invitees"]=function(){var e=[];return e.push('<div class="check-all-selector-wrapper clearfix"><div data-toggle="tooltip" title="Selected persons will be invited; people in your field will be able to join." class="pull-left text-bold text-off-black padding-bottom-4x js-manage-invitee"><span>Invite</span></div><div class="pull-right"><span class="js-discussion-select-all-attendees clickable text-primary"></span></div></div><div class="eligible-invitees-list-wrapper js-eligible-invitees-list-wrapper panel panel-flat padding-0x"><span class="js-error-message text-gray-dark padding-2x hidden">An error occured. Please try again.</span><ul class="media-list eligible-invitees-list js-eligible-invitees-list"><div class="js-no-mutuals text-center padding-2x hidden"><p class="margin-0x">You have no followers to invite.</p></div></ul></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/layout"]=function(e){var t=[],i=e||{};return function(e){t.push('<div id="work-creator"><div class="bootstrap"><div class="container-fluid"><div class="row full-screen-modal-header padding-vertical-6x margin-bottom-8x"><div class="col-xs-3"><i class="close-full-screen-modal clickable fa fa-times fa-2x"></i><i class="close-full-screen-modal-refresh clickable fa fa-times fa-2x"></i></div><div class="col-xs-6 text-center"><img'+jade.attr("src",""+e("academia-logo-redesign-2015.svg"),!0,!1)+jade.attr("onerror","this.onerror=null;this.src="+e("academia-logo-redesign-2015.png"),!0,!1)+' style="height:28px" class="Logo"/></div></div><div class="row full-screen-modal-page center-block js-work-creator-width"><div class="col-md-12"><div class="row margin-bottom-5x"><div class="col-xs-12"><div class="full-screen-modal-page-header text-center"><h3 class="modal-page-header js-modal-page-header text-off-black text-bold"></h3></div></div></div><div class="row"><div class="col-xs-12"><div class="full-screen-modal-page-content js-work-creator-content"></div></div></div></div></div></div></div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:void 0),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/academia_select_page"]=function(e){var t=[],i=e||{};return function(e){t.push('<script src="https://checkout.stripe.com/checkout.js"></script><div class="row DesignSystem"><div class="col-xs-12"><div class="full-screen-modal-white-content-box u-mt0x u-pb6x"><div class="row u-pv8x"><div class="col-xs-offset-1 col-xs-10 u-taCenter"><div class="work-creator-work-title u-fw700 u-tcGrayDarker">Submit to Academia Select</div></div></div><div class="row"><div class="col-xs-offset-1 col-xs-10 u-taCenter u-tcGrayDark"><div class="u-fontSerif">Academia Select is a curated list of papers that warrant boosted distribution on Academia.edu. Papers that are chosen<span class="u-fw700">&nbsp;get 5x the exposure</span>&nbsp;they otherwise would receive.</div><img'+jade.attr("src",""+e("chart@2x.png"),!0,!1)+' style="height:160px" class="u-mv2x"/><div class="u-fontSerif u-tcGrayDark u-pv2x">It costs $40 to submit a paper to Academia Select. Submissions are reviewed by an internal academic committee.</div><div class="u-fontSerif u-fw700 u-tcGrayDarker u-pt2x">If your paper is not selected, the $40 will be refunded.</div></div></div><div class="row lg-top-buffer"><div class="col-xs-offset-1 col-xs-5"><button class="btn btn-lg btn-none dim pull-left js-academia-select-no u-fw700">No, Thanks.</button></div><div class="col-xs-5"><button class="Button full-screen-modal-next-page-button js-academia-select-yes Button--green">$40 - SUBMIT</button></div></div></div></div></div>')}.call(this,"$image_url"in i?i.$image_url:"undefined"!=typeof $image_url?$image_url:void 0),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/academia_select_submit_page"]=function(e){var t,i=[],s=e||{};return function(e,s){i.push('<div class="row"><div class="col-xs-12"><div class="full-screen-modal-white-content-box"><div class="row"><div class="col-xs-12"><img'+jade.attr("src",""+e("icons/paper-icon@2x.png"),!0,!1)+' class="attachment-icon center-block"/></div></div><div class="row"><div style="padding-bottom:20px" class="col-xs-offset-1 col-xs-10 text-center"><div class="work-creator-work-title text-bold">'+jade.escape(null==(t=s)?"":t)+'</div></div></div><div class="row"><div class="col-xs-10 col-xs-offset-1 text-center">Thanks for submitting your paper for review. Our team will review your paper and contact you within 24 hours. </div></div><div style="margin-top:30px" class="row"><div class="col-xs-10 col-xs-offset-1 text-center"><div style="padding-top:30px;padding-bottom:30px;border-top: 1px solid #ddd" class="work-creator-work-title text-bold">Share Your Paper</div><button type="button" class="btn btn-md btn-twitter twitter-share"><i class="fa-twitter fa fa-lg"></i><span class="h6 text-bold text-wide-letter-space">TWEET</span></button></div></div></div></div></div><div class="row"><div class="page-controls"><div class="col-xs-6"><button type="button" style="padding-left:0px;" class="btn btn-lg btn-none dim pull-left work-creator-upload-another"><i class="fa-repeat fa"></i><span class="h6 text-bold text-gray-dark">&nbsp;&nbsp;&nbsp;UPLOAD ANOTHER</span></button></div><div class="col-xs-6"><button type="button" class="btn btn-lg btn-success-clear pull-right full-screen-modal-next-page-button work-creator-finish"><span class="h6 text-bold text-wide-letter-space">FINISH</span></button></div></div></div>')}.call(this,"$image_url"in s?s.$image_url:"undefined"!=typeof $image_url?$image_url:void 0,"title"in s?s.title:"undefined"!=typeof title?title:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/academia_select_v2_page"]=function(e){var t,i=[],s=e||{};return function(e,s){i.push('<req https://checkout.stripe.com/checkout.js="https://checkout.stripe.com/checkout.js"></req><div class="DesignSystem"><div class="row"><div class="col-xs-12 u-taCenter"><div class="u-fw500 u-tcGrayDarkest u-fontSerif">Papers Sent to the entire field ('+jade.escape(null==(t=s)?"":t)+') are reviewed to <span class="u-fw700">ensure the highest quality and relevance. </span></div></div></div><div class="row u-pb8x u-pt13x"><div class="col-xs-6"><div class="Panel"><div class="Panel-header u-pv6x u-taCenter"><div class="u-fw700 u-tcGrayDarkest u-fs20">Share with&nbsp;<span class="js-followers-count"></span>&nbsp;- No Review</div></div><div class="Panel-bodySegment u-p6x"><ul style="height:128px" class="u-listStyleNone u-pl0x u-taLeft u-fs14 u-tcGrayDarkest"><li class="u-pb2x"><i class="fa fa-check u-tcGreen u-fs13"></i><span> \n&nbsp;&nbsp;Shared with&nbsp;<span class="js-followers-count"></span></span></li><li class="u-pv2x"> <i class="fa fa-check u-tcGreen u-fs13"></i><span>&nbsp;&nbsp;Followers can bookmark and share with their followers. </span></li><li class="u-pt2x"> <i class="fa fa-check u-tcGreen u-fs13"></i><span>&nbsp;&nbsp;Indexed by Google, Bing, and Yahoo  </span></li></ul><Button class="Button Button--block Button--blue Button--xl u-mt6x js-academia-select-no">Share with&nbsp;<span class="js-followers-count"></span>&nbsp;- Free</Button></div></div></div><div class="col-xs-6"><div class="Panel"><div class="Panel-header u-pv6x u-taCenter"><div class="u-fw700 u-tcGrayDarkest u-fs20">Share with Field ('+jade.escape(null==(t=s)?"":t)+') - Review Required</div></div><div class="Panel-bodySegment u-p6x"><ul class="u-listStyleNone u-pl0x u-taLeft u-fs14 u-tcGrayDarkest"><li class="u-pb2x"> <i class="fa fa-check u-tcGreen u-fs13"></i><span>&nbsp;&nbsp;Includes Followers, Bookmarking, and Indexing</span></li><li class="u-pv2x"> <i class="fa fa-check u-tcGreen u-fs13"></i><span>&nbsp;&nbsp;Each Submission is reviewed for quality and relevance </span></li><li class="u-pv2x"> <i class="fa fa-check u-tcGreen u-fs13"></i><span>&nbsp;&nbsp;Review Fee is '+jade.escape(null==(t=e)?"":t)+' - refundable if your paper is not accepted  </span></li><li class="u-pt2x"> <i class="fa fa-check u-tcGreen u-fs13"></i><span> \n&nbsp;Accepted papers are sent to the newsfeed of entire field ('+jade.escape(null==(t=s)?"":t)+')</span></li></ul><Button class="Button Button--block Button--green Button--xl u-mt6x js-academia-select-yes">Submit to Field ('+jade.escape(null==(t=s)?"":t)+") - "+jade.escape(null==(t=e)?"":t)+"</Button></div></div></div></div></div>")}.call(this,"charge_amount"in s?s.charge_amount:"undefined"!=typeof charge_amount?charge_amount:void 0,"field_size"in s?s.field_size:"undefined"!=typeof field_size?field_size:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/classify_paper_page"]=function(){var e=[];return e.push('<div class="row"><div class="col-xs-6"><div class="panel panel-flat text-center padding-vertical-8x clickable js-published classify-paper-item"><div class="row margin-top-3x"><div class="col-xs-12"><img width="50px" height="50px" src="/images/icons/file_published.svg"/></div></div><div class="row margin-top-5x"><div class="col-xs-12"><h5 class="text-bold text-gray">Published Work</h5></div></div></div></div><div class="col-xs-6"><div class="panel panel-flat text-center padding-vertical-8x clickable js-draft classify-paper-item"><div class="row margin-top-3x"><div class="col-xs-12"><img width="50px" height="50px" src="/images/icons/file_edit.svg"/></div></div><div class="row margin-top-5x"><div class="col-xs-12"><h5 class="text-bold text-gray">Unpublished Draft Paper</h5></div></div></div></div></div><div class="row margin-top-3x"><div class="col-xs-12"><div class="panel panel-flat text-center clickable js-other classify-paper-item"><h5 class="text-bold text-gray">Other</h5></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/discussion_invites_page"]=function(){var e=[];return e.push('<div class="row"><div class="col-xs-12"><div class="js-manage-invitees"><div class="js-invitees-loading-container panel panel-flat text-center"><i class="fa fa-spinner fa-5x fa-spin"></i></div></div></div></div><div class="row"><div class="col-xs-12"><button class="btn btn-primary btn-lg pull-right js-invite-btn full-screen-modal-next-page-button"><span class="h6 text-bold text-wide-letter-space js-invite-btn-text">CONTINUE</span><div class="js-continue-button-spinner hidden"><i class="fa fa-spinner fa-spin fa-lg"></i></div></button></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/feedback_page"]=function(){var e=[];return e.push('<div class="row"><div class="col-xs-12 text-center"><button class="btn btn-outline btn-lg margin-right-5x js-no-feedback full-screen-modal-next-page-button"><span class="h6 text-bold text-wide-letter-space">NO</span></button><button class="btn btn-primary btn-lg js-feedback full-screen-modal-next-page-button"><span class="h6 text-bold text-wide-letter-space">YES</span></button></div></div><div class="row"><div class="page-controls"><div class="col-xs-12"><button type="button" class="btn btn-lg btn-none text-gray-dark dim pull-left padding-left-0x js-back-button"><i class="fa-angle-left fa"></i><span class="h6 text-bold">&nbsp;&nbsp;&nbsp;BACK</span></button></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/paper_details_page"]=function(e){var t,i=[],s=e||{};return function(e,s,r){i.push('<div class="row alert-box text-center"><div class="col-xs-12 alert-list"></div></div><div class="row"><div class="col-xs-12"><div class="form-group"><label for="add-work-title">Title</label><input type="text" id="add-work-title" placeholder="add a title..."'+jade.attr("value",r,!0,!1)+' class="form-control"/></div></div></div><div class="row top-buffer"><div class="col-xs-12"><div class="form-group"><label for="add-work-abstract"><span>Abstract</span></label><textarea name="abstract" rows="4" id="add-work-abstract" placeholder="add an abstract for your paper..." class="form-control">'+jade.escape(null==(t=e)?"":t)+'</textarea></div></div></div><div class="row top-buffer author-module-row"><div class="col-xs-12"><div class="author-module"></div></div></div><div class="row top-buffer"><div class="col-xs-12"><div class="form-group"><label for="add-work-section"><span>Section</span></label><select id="add-work-section" name="section" class="form-control">'),0===s.length?i.push('<option value="Papers">Papers</option>'):function(){var e=s;if("number"==typeof e.length)for(var r=0,a=e.length;a>r;r++){var o=e[r];i.push("<option"+jade.attr("value",o,!0,!1)+">"+jade.escape(null==(t=o)?"":t)+"</option>")}else{var a=0;for(var r in e){a++;var o=e[r];i.push("<option"+jade.attr("value",o,!0,!1)+">"+jade.escape(null==(t=o)?"":t)+"</option>")}}}.call(this),i.push('</select></div></div></div><div class="row top-buffer url-row"><div class="col-xs-12"><div class="url-module"></div></div></div><div class="row"><div class="page-controls"><div class="col-xs-6"><button type="button" class="btn btn-lg btn-none text-gray-dark dim pull-left padding-left-0x js-back-button"><i class="fa-angle-left fa"></i><span class="h6 text-bold">&nbsp;&nbsp;&nbsp;BACK</span></button></div><div class="col-xs-6"><button type="button" class="btn btn-lg btn-primary pull-right js-next-page full-screen-modal-next-page-button"><span class="h6 text-bold text-wide-letter-space">CONTINUE</span></button></div></div></div>')}.call(this,"abstract"in s?s["abstract"]:"undefined"!=typeof abstract?abstract:void 0,"sections"in s?s.sections:"undefined"!=typeof sections?sections:void 0,"title"in s?s.title:"undefined"!=typeof title?title:void 0,"undefined"in s?s.undefined:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/research_interests_page"]=function(){var e=[];return e.push('<div class="row alert-box"><div class="col-xs-12"><div role="alert" class="alert alert-warning text-center"><span>Try tagging your paper with some research interests!</span></div></div></div><div class="row too-many-ri-alert-box"><div class="col-xs-12"><div role="alert" class="alert alert-danger text-center"><span>Sorry! You can\'t tag your paper with any more research interests!</span></div></div></div><div class="row"><div class="col-xs-12"><div class="research-interest-module bg-off-white text-center"></div></div></div><div class="row work-save-error-alert-box"><div class="col-xs-12"><div role="alert" class="alert alert-danger text-center"><span>Sorry!  We encountered an error and were unable to save your paper!</span></div></div></div><div class="row top-buffer"><div class="page-controls"><div class="col-xs-6"><button type="button" style="padding-left:0px;" class="btn btn-lg btn-none dim text-gray-dark pull-left js-back-button"><i class="fa-angle-left fa"></i><span class="h6 text-bold">&nbsp;&nbsp;&nbsp;BACK</span></button></div><div class="col-xs-6"><button type="button" class="btn btn-lg btn-primary pull-right full-screen-modal-next-page-button js-save-work"><span class="h6 text-bold text-wide-letter-space finish-text">SAVE</span><div class="finish-spinner hidden"><i class="fa fa-spinner fa-spin fa-lg"></i></div></button></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/robot_check_page"]=function(e){var t=[],i=e||{};return function(e){t.push('<script src="https://www.google.com/recaptcha/api.js" async="" defer=""></script><div class="DesignSystem"><div class="u-taCenter"><form style="margin:auto;width:66%" class="js-recaptcha-form"><div'+jade.attr("data-sitekey",""+e,!0,!1)+' class="g-recaptcha"></div><br/><button type="submit" data-loading-text="&lt;i class=\'fa fa-spinner fa-spin fa-2x\'&gt;&lt;/i&gt;" class="js-stop-refresh js-recaptcha-next-button btn btn-lg btn-primary full-screen-modal-next-page-button">Continue</button></form></div></div>')}.call(this,"recaptcha_key"in i?i.recaptcha_key:"undefined"!=typeof recaptcha_key?recaptcha_key:void 0),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/sharing_page"]=function(e){var t,i=[],s=e||{};return function(e,s){i.push('<div class="row"><div class="col-xs-12"><div class="full-screen-modal-white-content-box"><div class="row"><div class="col-xs-12"><img'+jade.attr("src",""+e("icons/paper-icon@2x.png"),!0,!1)+' class="attachment-icon center-block"/></div></div><div class="row"><div class="col-xs-offset-1 col-xs-10 text-center"><div class="work-creator-work-title text-bold">'+jade.escape(null==(t=s)?"":t)+'</div></div></div><div class="row lg-top-buffer"><div class="col-xs-12 text-center"><button type="button" class="btn btn-md btn-twitter twitter-share"><i class="fa-twitter fa fa-lg"></i><span class="h6 text-bold text-wide-letter-space">TWEET</span></button></div></div></div></div></div><div class="row"><div class="page-controls"><div class="col-xs-6"><button type="button" style="padding-left:0px;" class="btn btn-lg btn-none dim pull-left work-creator-upload-another"><i class="fa-repeat fa"></i><span class="h6 text-bold text-gray-dark">&nbsp;&nbsp;&nbsp;UPLOAD ANOTHER</span></button></div><div class="col-xs-6"><button type="button" class="btn btn-lg btn-success-clear pull-right full-screen-modal-next-page-button work-creator-finish"><span class="h6 text-bold text-wide-letter-space">FINISH</span></button></div></div></div>')}.call(this,"$image_url"in s?s.$image_url:"undefined"!=typeof $image_url?$image_url:void 0,"title"in s?s.title:"undefined"!=typeof title?title:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/survey_page"]=function(){var e=[];return e.push('<div class="row"><div class="col-xs-12"><div style="margin-top: 0" class="full-screen-modal-white-content-box"><div class="row padding-top-8x"><div class="col-xs-offset-1 col-xs-10 text-center"><div class="work-creator-work-title text-bold text-grayDark">Can we get your feedback?</div></div></div><div class="row lg-top-buffer"><div style="font-size:16px;line-height:22px" class="col-xs-10 col-xs-offset-1 text-gray-darker"><div class="text-serif text-center">Next year you will be able to have a paper peer reviewed and published on Academia.edu.</div><hr class="margin-vertical-8x"/><div class="h6 text-bold">For which reason(s) would you consider publishing on Academia.edu?</div><div style="font-size:13px" class="checkboxes"><div class="checkbox"><label><input type="checkbox" value="exposure" class="exp option"/>Exposure (leading to citations)</label></div><div class="checkbox"><label><input type="checkbox" value="peer_review" class="peer option"/>Rapid Peer Review (peer review will be done in 20 days)</label></div><div class="checkbox"><label><input type="checkbox" value="open_access" class="open option"/>Open Access (anyone can read the paper for free)</label></div><div class="checkbox"><label><input type="checkbox" value="none" class="option-none"/>I would not consider publishing on Academia.edu</label></div></div><textarea rows="3" style="width:100%;font-size:13px;border-color:#D6D6D6;-webkit-border-radius: 3px;-moz-border-radius: 3px;border-radius: 3px" placeholder="leave an optional comment" class="comments margin-top-4x padding-2x padding-left-3x"></textarea><div class="margin-top-8x"><button type="button" style="padding-left:0px;" class="btn btn-lg btn-none dim pull-left work-creator-upload-another"><span class="h6 text-bold text-gray-dark">DO THIS LATER</span></button><button type="button" disabled="disabled" class="btn btn-lg full-screen-modal-next-page-button work-creator-finish pull-right middle-gray button"><span class="h6 text-bold text-wide-letter-space">SUBMIT</span></button></div></div></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/pages/upload_page"]=function(){var e=[];return e.push('<div class="row"><div class="col-xs-12"><div class="upload-box bg-white text-center"><div class="alert-box"><div role="alert" class="alert alert-danger text-center"><span class="alert-text"></span></div></div><div class="current-view"></div></div></div></div><div class="row page-controls no-papers-to-upload text-center"><div class="col-xs-6"><button type="button" class="btn btn-lg btn-none dim pull-left padding-left-0x js-back-button"><i class="fa-angle-left fa"></i><span class="h6 text-bold">&nbsp;&nbsp;&nbsp;BACK</span></button></div><div class="col-xs-6"><button type="button" class="btn btn-lg btn-none dim padding-right-0x pull-right js-forward-button"><span class="h6 text-bold">NO FILE TO UPLOAD?</span></button></div></div><div class="row page-controls cancel-upload text-center"><div class="col-xs-12"><button type="button" class="btn btn-lg btn-none stop-upload"><span class="h6 text-bold text-gray-dark">CANCEL UPLOAD</span></button></div></div><div class="row page-controls continue"><div class="col-xs-6"><button type="button" class="btn btn-lg btn-none dim pull-left padding-left-0x js-back-button"><i class="fa-angle-left fa"></i><span class="h6 text-bold">&nbsp;&nbsp;&nbsp;BACK</span></button></div><div class="col-xs-6"><button type="button" class="btn btn-lg btn-primary btn-block pull-right full-screen-modal-next-page-button js-forward-button"><span class="h6 text-bold text-wide-letter-space">CONTINUE</span></button></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/research_interests/research_interest"]=function(e){var t,i=[],s=e||{};return function(e,s){i.push('<div class="row"><div class="col-sm-7 col-xs-9 col-xs-offset-1"><span class="ri-name text-truncate">'+jade.escape(null==(t=s)?"":t)+'</span></div><div class="col-sm-2 hidden-xs"><span class="ri-follower-count text-gray">'+jade.escape(null==(t=e)?"":t)+'</span></div><div class="col-xs-1"><button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div></div>')}.call(this,"follower_count"in s?s.follower_count:"undefined"!=typeof follower_count?follower_count:void 0,"name"in s?s.name:"undefined"!=typeof name?name:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/research_interests/research_interest_module"]=function(){var e=[];return e.push('<div class="row margin-top-3x js-academics-reached"><div class="col-xs-12"><div class="followers-reached">0</div><h5 class="text-without-reach text-center text-gray hidden">CURRENT REACH</h5><h5 class="text-with-reach text-center text-gray hidden">ACADEMICS REACHED!</h5></div></div><div class="row margin-top-3x js-discussion-open-container hidden"><div class="col-xs-12"><h5 class="text-gray">Academics from the following research interests will have the ability to leave comments on your paper</h5></div></div><div class="row margin-top-3x"><div class="col-xs-12"><div class="ri-list"></div></div></div><div class="row margin-top-3x"><div class="col-xs-10 col-xs-offset-1"><div class="js-work-creator-research-interest-picker work-creator-research-interest-picker"></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/research_interests/research_interest_picker"]=function(){var e=[];return e.push('<div class="form-group select2-no-default-pills"><input type="hidden" placeholder="add a research interest" style="width: 100%"/></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/upload_prompt"]=function(e){var t,i=[],s=e||{};return function(e){i.push('<div class="bootstrap"><div class="no-works-upload-prompt panel panel-flat bg-gray-lightest padding-top-12x padding-bottom-12x solid-gray-border"><div class="panel-heading text-center"><div> <i class="attachment-icon fa fa-file-text-o fa-5x"></i></div><div class="h4 text-bold">It looks like you don\'t have any '+jade.escape(null==(t=e.toLowerCase())?"":t)+'.</div><div class="h4">Would you like to add one?</div><div> <button type="button" class="btn btn-success add-paper"><span>UPLOAD</span></button></div></div></div></div>')
}.call(this,"sectionName"in s?s.sectionName:"undefined"!=typeof sectionName?sectionName:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/urls/url"]=function(e){var t,i=[],s=e||{};return function(e){i.push('<div class="row"><div class="col-sm-1 hidden-xs"><span><i class="fa fa-link fa-lg"></i></span></div><div class="col-sm-10 col-xs-10"><span class="url text-truncate">'+jade.escape(null==(t=e)?"":t)+'</span></div><div class="col-sm-1 col-xs-2"><button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div></div>')}.call(this,"url"in s?s.url:"undefined"!=typeof url?url:void 0),i.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/urls/url_creator"]=function(){var e=[];return e.push('<div class="row"><div class="col-md-12"><div class="input-group pull-left"><label for="add-work-link"><span>Links</span></label></div></div></div><div class="row"><div class="col-md-12"><div class="input-group"><input type="text" id="add-work-url" placeholder="add a link" class="form-control"/><span class="input-group-btn"><button type="button" class="btn btn-default form-control add-url"><i class="fa-plus fa"></i></button></span></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_creator/templates/urls/url_module"]=function(){var e=[];return e.push('<div class="form-group"><div class="row url-alert-box"><div class="col-md-12"><div role="alert" class="alert alert-danger text-center"><span></span></div></div></div><div class="url-creator"></div><div class="row top-buffer"><div class="col-md-12"><div class="url-list"></div></div></div></div>'),e.join("")}}.call(this),function(){this.WorkCreator.EligibleInvitee=Backbone.Model.extend({defaults:{id:null,display_name:null,photo:null,is_brain_trust:!0},sync:function(){return!1}})}.call(this),function(){this.WorkCreator.EligibleInvitees=Backbone.Collection.extend({model:WorkCreator.EligibleInvitee,url:function(){return $r.api_v0_discussion_invitees_with_brain_trust_path({subdomain_param:"api"})},getCheckedUserIds:function(){var e;return e=this.where({is_brain_trust:!0}),_.pluck(e,"id")},setCheckedUserIds:function(e){return this.each(function(t){return t.set("is_brain_trust",e)})},isAllChecked:function(){return this.every(function(e){return e.get("is_brain_trust")})}})}.call(this),function(){this.WorkCreator.Attachment=Backbone.Model.extend({routeKey:"api_v0_attachment",blacklist:["status","progress"],toJSON:function(){return _.omit(this.attributes,this.blacklist)}})}.call(this),function(){this.WorkCreator.Discussion=Backbone.Model.extend({routeKey:"api_v0_discussions",url:function(){return $r.api_v0_discussions_path({subdomain_param:"api"})},saveDiscussion:function(e){return this.set(e),this.save({},{success:function(e){return function(){return e.trigger("work_uploader:discussion-save-success")}}(this),error:function(e){return function(){return e.trigger("work_uploaded:discussion-save-failure")}}(this)})},fetchPotentialInvitees:function(){return this.potentialInviteesLoading=!0,this.potentialInviteesLoaded=!1,this.eligibleInvitees=new WorkCreator.EligibleInvitees,this.eligibleInvitees.fetch({success:function(e){return function(){return e.trigger("work-uploader:discussion-invitees-loaded"),e.potentialInviteesLoading=!1,e.potentialInviteesLoaded=!0}}(this),error:function(e){return function(){return e.trigger("work-uploader:discussion-invitees-load-failed")}}(this)})}})}.call(this),function(){this.WorkCreator.NewWork=Backbone.Model.extend({initialize:function(){return this.useCoauthorSuggestions=!0,this.useResearchInterestSuggestions=!1,this.set({title:"",research_interests:new Works.ResearchInterests,urls:new WorkCreator.Urls,coauthor_tags:new Works.CoauthorTags([],{source:"work_creator",includeOwner:$current_user}),rejected_coauthors:new Works.CoauthorTags,metadata:new WorkCreator.WorkMetadata}),this.on("attachment-uploaded",this.pollForSuggestions,this),this.listenTo(this.get("coauthor_tags"),"remove",function(e){return function(t){return e.get("rejected_coauthors").add(t)}}(this))},save:function(){return this.savingToServer?void 0:(this.savingToServer=!0,this.trigger("work-save-starting"),WorkCreator.notifier.notifyAndLog("work-save-started"),$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:$r.api_v0_works_path({subdomain_param:"api"}),data:this.dataForSave(),success:function(e){return function(){return e.set({errors:null}),e.savingToServer=!1}}(this),error:function(e){return function(t){return e.set({errors:JSON.parse(t.responseText).errors}),e.savingToServer=!1}}(this),complete:function(e){return function(t,i){var s;return"error"===i?(s=JSON.parse(t.responseText).errors,e.trigger("work-save-error",s),$a.admin_log(t.status,t.responseText),$a.log("work-save-error"),WorkCreator.notifier.notify({event:"work-save-error",user_id:$current_user.id,source:"three_step",user_time:parseInt((new Date).getTime()/1e3),error:s})):(e.set("internalUrl",JSON.parse(t.responseText).work.internal_url),e.set("workId",JSON.parse(t.responseText).work.id),e.set("charge_amount",JSON.parse(t.responseText).ab_test_value),$a.admin_log(t.status,t.responseText),e.trigger("work-save-success"))}}(this)}))},dataForSave:function(){var e;return e={attachments:this.getAttachmentsJSON(),research_interests:this.get("research_interests").toJSON(),urls:this.get("urls").toJSON(),coauthor_tags:this.get("coauthor_tags").toJSON(),rejected_coauthors:this.get("rejected_coauthors").toJSON(),section_name:this.get("section"),source:this.get("source")||"three_step",type:this.get("type"),work:{title:this.get("title"),metadata:this.get("metadata").toJSON()}},JSON.stringify(e)},getAttachmentsJSON:function(){var e;return e=[],this.has("primaryAttachment")&&e.push(this.get("primaryAttachment").toJSON()),e},primaryAttachmentUploaded:function(){return this.has("primaryAttachment")?"uploaded"===this.get("primaryAttachment").get("status"):!1},primaryAttachmentUploading:function(){return this.has("primaryAttachment")?"uploading"===this.get("primaryAttachment").get("status"):!1},validate:function(){var e;return e=[],this._validateTitlePresence()||e.push(["#add-work-title","You must provide a title!"]),this._validateTitleLength()||e.push(["#add-work-title","Your title can't be more than 300 characters long!"]),this._validateAbstractLength()||e.push(["#add-work-abstract","Your abstract can't be more than 10,000 characters long!"]),e.length>0?e:void 0},_validateTitlePresence:function(){return this.has("title")&&this.get("title").length>0?!0:!1},_validateTitleLength:function(){return this.has("title")&&this.get("title").length<=300?!0:!1},_validateAbstractLength:function(){return this.get("metadata").get("abstract").length<=1e4?!0:!1},pollForSuggestions:function(){var e;if(this.has("primaryAttachment"))return this.pollingForSuggestions=!0,e=$r.parsed_attributes_api_v0_attachment_path({subdomain_param:"api",id:this.get("primaryAttachment").get("id")}),$.get(e).error(function(e){return function(){return e.pollingForSuggestions=!1}}(this)).done(function(e){return function(t){var i;return t.complete?(e.useCoauthorSuggestions&&(i=t.co_author_tags||[],_(i).each(function(e){return e.source="work_creator_suggestion"}),e.get("coauthor_tags").add(i)),e.useResearchInterestSuggestions&&e.get("research_interests").add(t.research_interests||[]),e.pollingForSuggestions=!1):(null!=e._repollForSuggestions&&clearTimeout(e._repollForSuggestions),e.useCoauthorSuggestions||e.useResearchInterestSuggestions?e._repollForSuggestions=setTimeout(function(){return e.pollForSuggestions()},500):void 0)}}(this))},checkForCaptcha:function(){return $.ajax({type:"GET",dataType:"json",data:this.dataForCaptcha(),url:$r.should_display_captcha_api_v0_works_path({subdomain_param:"api"}),success:function(e){return function(t){return e.set({captcha:t.should_display_captcha})}}(this)})},dataForCaptcha:function(){var e;return e={title:this.get("title")}}})}.call(this),function(){this.WorkCreator.Url=Backbone.Model.extend({routeKey:"api_v0_work_url",initialize:function(){return this.on("error",function(e){return function(t,i){return e.parse_server_error(i),e.trigger("invalid")}}(this))},parse_server_error:function(e){var t;return(e.status=422)?(t=JSON.parse(e.responseText).errors,this.validationError=t):void 0},validate:function(){var e;return e=null,$.ajax({type:"POST",async:!1,url:$r.validate_url_api_v0_works_path({subdomain_param:"api"}),data:this.toJSON(),error:function(t){return function(i){return e=t.parse_server_error(i)}}(this)}),e}})}.call(this),function(){this.WorkCreator.WorkMetadata=Backbone.Model.extend({initialize:function(){return this.set({"abstract":""})}})}.call(this),function(){this.WorkCreator.Attachments=Backbone.Collection.extend({model:WorkCreator.Attachment})}.call(this),function(){this.WorkCreator.Urls=Backbone.Collection.extend({model:WorkCreator.Url})}.call(this),function(){this.WorkCreator.AttachmentView=Backbone.View.extend({template:"work_creator/templates/attachments/attachment",events:{"click button.close":"removeAttachment"},render:function(){return this.$el.html(JST[this.template]({file_name:this.model.get("primaryAttachment").get("file_name")})),this},removeAttachment:function(){return this.model.unset("primaryAttachment"),WorkCreator.notifier.notifyAndLog("attachment-removed"),this.model.trigger("attachment-removed")}})}.call(this),function(){this.WorkCreator.NoAttachmentView=Backbone.View.extend({template:"work_creator/templates/attachments/no_attachments",render:function(){var e;return this.$el.html(JST[this.template]()),e=this.$(".uploader input[type=file]"),this.uploader=new WorkCreator.Uploader({fileInput:e,dropZone:$(".full-screen-modal-page"),model:this.model}),this}})}.call(this),function(){this.WorkCreator.PrimaryAttachmentUploadedView=Backbone.View.extend({template:"work_creator/templates/attachments/primary_uploaded",initialize:function(){return"undefined"!=typeof heap&&null!==heap?heap.track("Paper Upload Complete"):void 0},render:function(){var e;return this.$el.html(JST[this.template]()),e=new WorkCreator.AttachmentView({model:this.model}),this.$(".primary-attachment").append(e.render().el),this}})}.call(this),function(){this.WorkCreator.PrimaryAttachmentUploadingView=Backbone.View.extend({template:"work_creator/templates/attachments/primary_uploading",initialize:function(){return this.model.get("primaryAttachment").on("change:progress",this.updatePercent,this)},render:function(){return this.$el.html(JST[this.template]()),this},updatePercent:function(){var e;return e=this.model.get("primaryAttachment").get("progress"),this.$(".progress-bar").width(e+"%"),this.$(".upload-percent").html(e+"%"),this.$(".progress-bar").attr("aria-valuenow",e),this.$(".progress-bar span").html(e+"% Complete")}})}.call(this),function(){var e=function(e,i){function s(){this.constructor=e}for(var r in i)t.call(i,r)&&(e[r]=i[r]);return s.prototype=i.prototype,e.prototype=new s,e.__super__=i.prototype,e},t={}.hasOwnProperty;this.WorkCreator.AuthorModule=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.template="work_creator/templates/authors/author_module",i.prototype.initialize=function(){return this.collection.on("add remove change",this.collectionUpdated,this)},i.prototype.render=function(){return this.$el.html(JST[this.template]()),this.loadCoauthorSearch(),this.inviteModalView=new Works.InviteCoauthorModal({collection:this.collection}).render(),this},i.prototype.loadCoauthorSearch=function(){return this.searchView=new Search.CoauthorSearch({el:this.$("#authors-input"),collection:this.collection}),this.collectionUpdated(),this.searchView.$el.on("select2-footer-clicked",function(e){return function(){return e.footerClicked()}}(this)),this.listView=new Works.CoauthorTagsView({el:this.$("#authors-list"),collection:this.collection,tag_options:{className:"bg-off-white"}}),this.listView.render()},i.prototype.collectionUpdated=function(){return this.$("#authors-input").select2("data",this.collection.models)},i.prototype.footerClicked=function(){return $("#authors-input").select2("close"),this.inviteModalView.show(),this.listenTo(this.inviteModalView,"close",function(){return this.$("#authors-input").select2("open")})},i}(Backbone.View)}.call(this),function(){this.WorkCreator.EligibleInviteeView=Backbone.View.extend({template:"work_creator/templates/discussions/eligible_invitee",tagName:"li",className:"media padding-horizontal-4x padding-vertical-4x margin-vertical-0x",events:{"click .js-invitee-checkbox":"inviteeCheckboxClicked"},initialize:function(){return this.render(),this.postRender()},render:function(){return this.$el.html(JST[this.template]({eligibleInvitee:this.model.toJSON()})),this},postRender:function(){return this.listenTo(this.model,"change",this.modelChanged),this.ui={$checkbox:this.$(".js-invitee-checkbox")}},inviteeCheckboxClicked:function(){var e;return e=this.ui.$checkbox.prop("checked"),this.model.set("is_brain_trust",e)},modelChanged:function(){var e;return e=this.model.get("is_brain_trust"),this.ui.$checkbox.prop("checked",e)}})}.call(this),function(){this.WorkCreator.EligibleInviteesView=Backbone.View.extend({template:"work_creator/templates/discussions/eligible_invitees",events:{"click .js-discussion-select-all-attendees":"checkAllClicked"},initialize:function(){return this.eligibleInvitees=this.options.collection,this.render(),this.postRender(),this.loadMutualFollows(),this},render:function(){return this.$el.html(JST[this.template]()),this},postRender:function(){return this.ui={$eligibleInviteeList:this.$(".js-eligible-invitees-list"),$checkAllAttendeesLink:this.$(".js-discussion-select-all-attendees"),$errorMessage:this.$(".js-error-message"),$spinner:this.$(".js-invitees-loading-spinner"),$noMutualsView:this.$(".js-no-mutuals"),$manageInviteesLabel:this.$(".js-manage-invitee")},this.ui.$manageInviteesLabel.tooltip()},renderChildrenView:function(){return this.eligibleInviteeItems=[],this.eligibleInvitees.length>0?(this.setInviteesCheckboxState(),this.eligibleInvitees.each(function(e){return function(t){var i;return i=new WorkCreator.EligibleInviteeView({model:t}),e.eligibleInviteeItems.push(i),e.ui.$eligibleInviteeList.append(i.el)}}(this))):(this.ui.$noMutualsView.removeClass("hidden"),this.ui.$checkAllAttendeesLink.addClass("hidden"))},loadMutualFollows:function(){return this.listenTo(this.eligibleInvitees,"add change",this.setInviteesCheckboxState),this.renderChildrenView()},setInviteesCheckboxState:function(){return this.ui.$checkAllAttendeesLink.text(this.eligibleInvitees.isAllChecked()?"Deselect All":"Select All")},checkAllClicked:function(){return this.eligibleInvitees.setCheckedUserIds(this.eligibleInvitees.isAllChecked()?!1:!0)},getCheckedUserIds:function(){return this.eligibleInvitees.getCheckedUserIds()},remove:function(){var e,t,i,s,r;for(i=this.eligibleInviteeItems,s=[],e=0,t=i.length;t>e;e++)r=i[e],s.push(r.remove());return s}})}.call(this),function(){this.WorkCreator.Layout=Backbone.View.extend({template:"work_creator/templates/layout",events:{"click .close-full-screen-modal":"closeWorkCreator","click .close-full-screen-modal-refresh":"closeWorkCreatorWithRefresh"},initialize:function(e){return this.section=e.section,this.source=e.source,this.recaptchaPublicKey=e.recaptcha_key},render:function(){return this.$el.html(JST[this.template]()),this.setupSelectors(),this},setupSelectors:function(){return this.headerText=this.$(".js-modal-page-header"),this.pageContent=this.$(".full-screen-modal-page-content")},changePage:function(e){var t,i,s;return this.currentPage?(s=new WorkCreator[e]({model:this.currentPage.model,discussion:this.currentPage.options.discussion,recaptcha_public_key:this.recaptchaPublicKey}),this.currentPage.remove()):(i=new WorkCreator.NewWork({section:this.section,source:this.source}),t=new WorkCreator.Discussion,s=new WorkCreator[e]({model:i,discussion:t,recaptcha_public_key:this.recaptchaPublicKey})),this.currentPage=s,this.listenTo(this.currentPage,"show-close-with-refresh-icon",this.showCloseWithRefreshIcon),this.updateHeaderText(),this.updatePageContent()},resetModel:function(){return this.currentPage.model=new WorkCreator.NewWork({section:this.section}),this.currentPage.options.discussion=new WorkCreator.Discussion},showCloseWithRefreshIcon:function(){return this.$(".close-full-screen-modal").hide(),this.$(".close-full-screen-modal-refresh").show()},updateHeaderText:function(){return this.currentPage.headerText?this.headerText.html(this.currentPage.headerText):void 0},updatePageContent:function(){return this.pageContent.html(this.currentPage.render().el),this.currentPage.postRender?this.currentPage.postRender():void 0},closeWorkCreator:function(){return window.work_creator_router.navigate("add/close",{trigger:!0})},closeWorkCreatorWithRefresh:function(){return window.work_creator_router.navigate("add/success_close",{trigger:!0})}})}.call(this),function(){this.WorkCreator.AcademiaSelectPage=Backbone.View.extend({id:"academia-select",headerText:"Upload Complete",stepNumber:4,template:"work_creator/templates/pages/academia_select_page",events:{"click .js-academia-select-no":"selectNo","click .js-academia-select-yes":"selectYes"},render:function(){return this.$el.html(JST[this.template]({title:this.model.get("title")})),this},selectNo:function(){return this.academiaSelect(!1),window.work_creator_router.navigate("add/share",{trigger:!0})},selectYes:function(e){return this.academiaSelect(!0),this.handler=StripeCheckout.configure({key:AcademiaStripeConfig.publishable_key,image:$image_url("academia-logo-redesign-2015-A.png"),locale:"auto",token:function(e){return function(t){return $.ajax({type:"PUT",url:$r.academia_select_charge_api_v0_work_path({subdomain_param:"api",id:e.model.get("workId")}),data:{academia_select_charge:{token:t}}}).done(function(){return window.work_creator_router.navigate("add/academia_select_submit",{trigger:!0})})}}(this)}),this.handler.open({name:"Academia Select",description:"Boost Exposure 5x",amount:4e3}),e.preventDefault()},academiaSelect:function(e){return $.ajax({type:"PUT",url:$r.academia_select_answer_api_v0_work_path({subdomain_param:"api",id:this.model.get("workId")}),data:{academia_select_answer:{answer:e}}})}})}.call(this),function(){this.WorkCreator.AcademiaSelectSubmitPage=Backbone.View.extend({id:"academia-select",headerText:"Thanks for your Submission",stepNumber:4,template:"work_creator/templates/pages/academia_select_submit_page",events:{"click .work-creator-upload-another":"uploadAnotherWork","click .work-creator-finish":"closeWorkCreator","click .twitter-share":"handleTwitterClick"},render:function(){return this.$el.html(JST[this.template]({title:this.model.get("title")})),this.trigger("show-close-with-refresh-icon"),this},uploadAnotherWork:function(){return WorkCreator.notifier.notifyAndLog("upload-another-clicked"),window.work_creator_router.navigate("add/reset",{trigger:!0})},closeWorkCreator:function(){return window.work_creator_router.navigate("add/success_close",{trigger:!0})},handleTwitterClick:function(){return this.showTwitterModal(),this.deprioritizeTwitterButton(),this.prioritizeFinishButton(),this.prioritizeUploadAnotherLink()},showTwitterModal:function(){var e,t;return WorkCreator.notifier.notifyAndLog("show-twitter-modal"),t=this.getTweetText(),e=this.model.get("internalUrl"),window.Academia.openTwitterShareWindow(t,e)},deprioritizeTwitterButton:function(){return this.$(".btn-twitter").removeClass("btn-twitter").addClass("btn-twitter-clear")},prioritizeFinishButton:function(){return this.$(".work-creator-finish").removeClass("btn-success-clear").addClass("btn-success")},prioritizeUploadAnotherLink:function(){return this.$(".work-creator-upload-another").css("opacity",1)},getTweetText:function(){var e,t,i,s,r,a,o;return a=140,r=23,i=3,this.model.has("primaryAttachment")?(t="I just uploaded '' to @academia!",e=140-t.length-r-i,o=$h.truncate(this.model.get("title"),e),s="I just uploaded '"+o+"' to @academia!"):(t="I just added '' to @academia!",e=140-t.length-r-i,o=$h.truncate(this.model.get("title"),e),s="I just added '"+o+"' to @academia!"),s}})}.call(this),function(){this.WorkCreator.AcademiaSelectV2Page=Backbone.View.extend({id:"academia-select",headerText:"Submit for Quality Review",stepNumber:4,template:"work_creator/templates/pages/academia_select_v2_page",events:{"click .js-academia-select-no":"selectNo","click .js-academia-select-yes":"selectYes"},initialize:function(){return this.fieldSize=this.model.get("field_size"),"0"===this.fieldSize?this.fieldSize="100K":void 0},render:function(){return this.$el.html(JST[this.template]({field_size:this.fieldSize,charge_amount:this.getDollarAmount()})),this.trigger("show-close-with-refresh-icon"),this.postRender(),this},postRender:function(){return $(".js-work-creator-width").css("max-width","1000px"),$(".js-work-creator-content").css("padding-top","0"),Aedu.User.current.load_followers_count().done(function(e){return function(t){return e.$(".js-followers-count").text($h.pluralize(t,"Follower")+" ("+$h.commaizeInt(t)+")")}}(this))},selectNo:function(){return this.academiaSelect(!1),$(".js-work-creator-width").removeAttr("style"),$(".js-work-creator-content").removeAttr("style"),window.work_creator_router.navigate("add/share",{trigger:!0})},selectYes:function(){return req_and_ready("https://checkout.stripe.com/checkout.js",function(e){return function(t){return e.academiaSelect(!0),e.handler=StripeCheckout.configure({key:AcademiaStripeConfig.publishable_key,image:$image_url("Academia_Stripe_128.png"),locale:"auto",token:function(t){return $.ajax({type:"PUT",url:$r.academia_select_charge_api_v0_work_path({subdomain_param:"api",id:e.model.get("workId")}),data:{academia_select_charge:{token:t,charge_amount:e.model.get("charge_amount")}}}).done(function(){return $(".js-work-creator-width").removeAttr("style"),$(".js-work-creator-content").removeAttr("style"),window.work_creator_router.navigate("add/academia_select_submit",{trigger:!0})})}}),e.handler.open({name:"Academia.edu",description:"Submit to Field",amount:e.model.get("charge_amount")}),t.preventDefault()}}(this))},academiaSelect:function(e){return $.ajax({type:"PUT",url:$r.academia_select_answer_api_v0_work_path({subdomain_param:"api",id:this.model.get("workId")}),data:{academia_select_answer:{answer:e,charge_amount:this.model.get("charge_amount")}}})},getDollarAmount:function(){return"$"+this.model.get("charge_amount")/100}})}.call(this),function(){this.WorkCreator.ClassifyPaperPage=Backbone.View.extend({id:"classify-page",stepNumber:1,headerText:"What type of file would you like to upload?",template:"work_creator/templates/pages/classify_paper_page",events:{"click .js-draft":"draftSelected","click .js-published":"publishedSelected","click .js-other":"otherSelected"},initialize:function(){return this.discussion=this.options.discussion},render:function(){return this.$el.html(JST[this.template]()),this},draftSelected:function(){return WorkCreator.notifier.notifyAndLog("classify-as-draft-selected"),this.discussion.fetchPotentialInvitees(),this.saveWorkType("Draft")},publishedSelected:function(){return WorkCreator.notifier.notifyAndLog("classify-as-published-selected"),this.saveWorkType("Paper")},otherSelected:function(){return WorkCreator.notifier.notifyAndLog("classify-as-other-selected"),this.saveWorkType("Document")},saveWorkType:function(e){return this.model.set("type",e),this.toNextPage()},toNextPage:function(){return window.work_creator_router.navigate("add/upload",{trigger:!0})}})}.call(this),function(){this.WorkCreator.DiscussionInvitesPage=Backbone.View.extend({id:"discussion-invites-page",stepNumber:5,headerText:"Get feedback on your draft paper",template:"work_creator/templates/pages/discussion_invites_page",events:{"click .js-invite-btn":"inviteFollowers"},render:function(){return this.discussion=this.options.discussion,this.$el.html(JST[this.template](this.model.toJSON())),this.postRender(),this},postRender:function(){return this.setUiElements(),this.disableContinueButton(),this.getPotentialInvitees()},getPotentialInvitees:function(){return this.discussion.potentialInviteesLoaded?this.displayPotentialInvitees():this.discussion.potentialInviteesLoading?this.listenTo(this.discussion,"work-uploader:discussion-invitees-loaded",this.displayPotentialInvitees):(this.listenTo(this.discussion,"work-uploader:discussion-invitees-loaded",this.displayPotentialInvitees),this.discussion.fetchPotentialInvitees())},displayPotentialInvitees:function(){return this.eligibleInvitees=this.discussion.eligibleInvitees,this.eligibleInviteesView=new WorkCreator.EligibleInviteesView({collection:this.eligibleInvitees}),this.ui.$manageInviteesWrapper.html(this.eligibleInviteesView.el),this.hideInviteesLoadingContainer(),this.enableContinueButton()},hideInviteesLoadingContainer:function(){return this.ui.$inviteesLoadingContainer.addClass("hidden")},setUiElements:function(){return this.ui={$manageInviteesWrapper:this.$(".js-manage-invitees"),$continueButtonSpinner:this.$(".js-continue-button-spinner"),$inviteButtonText:this.$(".js-invite-btn-text"),$inviteButton:this.$(".js-invite-btn"),$inviteesLoadingContainer:this.$(".js-invitees-loading-container")}},disableButtons:function(){return this.disableContinueButton(),this.ui.$continueButtonSpinner.removeClass("hidden"),this.ui.$inviteButtonText.addClass("hidden")},enableContinueButton:function(){return this.ui.$inviteButton.prop("disabled",!1)},disableContinueButton:function(){return this.ui.$inviteButton.prop("disabled",!0)},inviteFollowers:function(){var e,t;return this.disableButtons(),e=this.eligibleInviteesView.getCheckedUserIds(),t=$r.invite_users_api_v0_discussion_path({subdomain_param:"api",id:this.discussion.get("attendee_invite_token")}),$.ajax({url:t,type:"POST",data:{invitees:e}}).done(function(e){return function(){return window.location.assign(e.discussion.get("url"))}}(this))}})}.call(this),function(){this.WorkCreator.FeedbackPage=Backbone.View.extend({id:"feedback-page",stepNumber:4,headerText:"Would you like to open your draft paper to comments from your colleagues?",template:"work_creator/templates/pages/feedback_page",events:{"click .js-no-feedback":"noFeedbackSelected","click .js-feedback":"feedbackSelected","click .js-back-button":"backButtonClicked"},render:function(){return this.$el.html(JST[this.template](this.model.toJSON())),this},noFeedbackSelected:function(){return window.feedback_wanted=!1,WorkCreator.notifier.notifyAndLog("feedback-page-no-selected"),this.goToNextPage()},feedbackSelected:function(){return WorkCreator.notifier.notifyAndLog("feedback-page-yes-selected"),window.feedback_wanted=!0,this.goToNextPage()},backButtonClicked:function(){return this.model.isValid()?window.work_creator_router.navigate("add/paper_details",{trigger:!0}):void 0},goToNextPage:function(){return this.model.isValid()?window.work_creator_router.navigate("add/research_interests",{trigger:!0}):void 0}})}.call(this),function(){this.WorkCreator.PaperDetailsPage=Backbone.View.extend({id:"paper-details-page",stepNumber:2,headerText:"Details",jstTemplate:"work_creator/templates/pages/paper_details_page",events:{"click .js-back-button":"backButtonClicked","click .js-next-page":"goToNextPage"},initialize:function(){return this.model.on("invalid",this.showValidationErrors,this)},render:function(){return this.$el.html(JST[this.jstTemplate]({title:this.model.get("title"),"abstract":this.model.get("metadata").get("abstract"),sections:_.pluck($current_user.sections,"name")})),this.setupSelectors(),this.setupAuthorsModule(),this.setupUrlModule(),this},postRender:function(){return $("#authors-input").select2("val",""),this.titleInput.focus()},setupSelectors:function(){return this.urlRow=this.$(".url-row"),this.urlContainer=this.$(".url-module"),this.authorsRow=this.$(".author-module-row"),this.authorContainer=this.$(".author-module"),this.titleInput=this.$("#add-work-title"),this.abstractInput=this.$("#add-work-abstract"),this.sectionSelect=this.$("#add-work-section"),this.validationAlertRow=this.$(".alert-box"),this.validationAlertList=this.$(".alert-list"),this.formItems=this.$(".form-group")},setupAuthorsModule:function(){return this.authorsModule=new WorkCreator.AuthorModule({collection:this.model.get("coauthor_tags")}),this.authorContainer.html(this.authorsModule.render().el),this.model.useCoauthorSuggestions=!1},setupUrlModule:function(){return this.model.has("primaryAttachment")&&0===this.model.get("urls").length?this.urlRow.hide():(this.urlModule=new WorkCreator.UrlModule({collection:this.model.get("urls")}),this.urlContainer.html(this.urlModule.render().el))},showValidationErrors:function(){return this.resetValidationAlerts(),this.insertValidationAlerts(),this.validationAlertRow.fadeIn(),WorkCreator.notifier.notifyAndLog("paper-details-validation-error")},resetValidationAlerts:function(){return this.urlModule&&this.urlModule.resetUrlValidationMessage(),this.validationAlertRow.hide(),this.formItems.removeClass("has-error"),this.$(".alert-box .alert").remove()},insertValidationAlerts:function(){return _.each(this.model.validationError,function(e){var t,i,s,r;return r=e[0],s=e[1],this.$(r).parent().addClass("has-error"),i=$("<span/>").html(s),t=$("<div/>").addClass("alert").addClass("alert-danger").attr("role","alert").html(i),this.$(".alert-list").append(t)}),this.model.unset("validationError")},getTitle:function(){var e,t;return t=this.titleInput.attr("placeholder"),e=this.titleInput.val(),t===e?"":e},getAbstract:function(){var e,t;return t=this.abstractInput.attr("placeholder"),e=this.abstractInput.val(),t===e?"":e},getSection:function(){return this.sectionSelect.val()},saveFields:function(){return this.urlModule&&this.urlModule.autosaveEnteredUrl(),this.model.set({title:this.getTitle()}),this.model.get("metadata").set({"abstract":this.getAbstract()}),this.model.set({section:this.getSection()})},backButtonClicked:function(){return this.saveFields(),window.work_creator_router.navigate("add/upload",{trigger:!0})},goToNextPage:function(){return this.saveFields(),this.model.isValid()?this.model.checkForCaptcha().done(function(e){return function(){return e.model.get("captcha")?window.work_creator_router.navigate("add/robot",{trigger:!0}):"Draft"===e.model.get("type")&&e.model.get("primaryAttachment")?window.work_creator_router.navigate("add/feedback",{trigger:!0}):window.work_creator_router.navigate("add/research_interests",{trigger:!0})}}(this)):void 0}})}.call(this),function(){this.WorkCreator.ResearchInterestsPage=Backbone.View.extend({id:"research-interest-page",headerText:"Add Research Interests",stepNumber:3,template:"work_creator/templates/pages/research_interests_page",events:{"click .js-back-button":"backButtonClicked","click .js-save-work":"finishWorkCreation"},initialize:function(){return this.model.on("work-save-starting",this.workSaveStarting,this),this.model.on("work-save-error",this.alertWorkSaveError,this),this.model.on("work-save-success",this.workSaveSuccess,this),this.researchInterestModule=new WorkCreator.ResearchInterestModule({collection:this.model.get("research_interests"),isDiscussionPromotionEligible:this.isDiscussionPromotionEligible()}),this.researchInterestModule.on("too_many_research_interests",this.alertTooManyResearchInterests,this),this.model.get("research_interests").on("add remove",this.resetAlerts,this),this.discussion=this.options.discussion},render:function(){return this.$el.html(JST[this.template]()),this.setupSelectors(),this.riContainer.html(this.researchInterestModule.render().el),this},postRender:function(){return this.riContainer.find("input.select2-input").focus()},setupSelectors:function(){return this.riContainer=this.$(".research-interest-module"),this.finishButtonText=this.$(".finish-text"),this.finishButtonSpinner=this.$(".finish-spinner"),this.saveAlertBox=this.$(".work-save-error-alert-box"),this.tooManyRIAlertBox=this.$(".too-many-ri-alert-box"),this.riAlertBox=this.$(".alert-box"),this.saveWorkButton=this.$(".js-save-work")},resetAlerts:function(){return this.saveAlertBox.hide(),this.riAlertBox.hide(),this.tooManyRIAlertBox.hide()},workSaveStarting:function(){return this.resetAlerts(),this.finishButtonText.addClass("hidden"),this.finishButtonSpinner.removeClass("hidden"),this.saveWorkButton.prop("disabled",!0)},alertTooManyResearchInterests:function(){return this.riAlertBox.hide(),this.tooManyRIAlertBox.show()},alertWorkSaveError:function(){return this.saveAlertBox.fadeIn(),this.finishButtonSpinner.addClass("hidden"),this.finishButtonText.removeClass("hidden"),this.saveWorkButton.prop("disabled",!1)},promptForResearchInterest:function(){return this.promptedForResearchInterest=!0,this.riAlertBox.fadeIn(),WorkCreator.notifier.notifyAndLog("prompt-for-research-interest")
},backButtonClicked:function(){return"Draft"===this.model.get("type")&&this.model.get("primaryAttachment")?window.work_creator_router.navigate("add/feedback",{trigger:!0}):window.work_creator_router.navigate("add/paper_details",{trigger:!0})},finishWorkCreation:function(){return 0!==this.model.get("research_interests").length||this.promptedForResearchInterest?(this.saveDiscussionIfQualified(),this.saveWork()):this.promptForResearchInterest()},saveDiscussionIfQualified:function(){return this.isDiscussionCreationEligible()?this.discussion.saveDiscussion(this.getDiscussionParams()):void 0},saveWork:function(){return this.model.save()},getDiscussionParams:function(){return this.data={name:this.model.get("title"),attachment_id:this.model.get("primaryAttachment").id,source:"uploader",research_interests:this.model.get("research_interests")}},workSaveSuccess:function(){return this.model.set("field_size",this.$(".followers-reached").text()),this.isDiscussionCreationEligible()?window.work_creator_router.navigate("add/discussion_invites",{trigger:!0}):window.work_creator_router.navigate("add/share",{trigger:!0})},isDiscussionCreationEligible:function(){return this.model.get("primaryAttachment")&&"Draft"===this.model.get("type")&&window.feedback_wanted},isDiscussionPromotionEligible:function(){return this.isDiscussionCreationEligible()&&window.discussion_promotion_qualified},isPublishingSurveyEligible:function(){return this.model.get("primaryAttachment")&&"Paper"===this.model.get("type")&&window.survey_eligible}})}.call(this),function(){this.WorkCreator.RobotCheckPage=Backbone.View.extend({id:"robot-check-page",stepNumber:3,headerText:"Please confirm you are a human (and not a robot)",template:"work_creator/templates/pages/robot_check_page",events:{"submit .js-recaptcha-form":"toNextPage"},initialize:function(){return this.discussion=this.options.discussion,this.recaptchaPublicKey=this.options.recaptcha_public_key},render:function(){return this.$el.html(JST[this.template]({recaptcha_key:this.recaptchaPublicKey})),this.ui={$nextButton:this.$(".js-recaptcha-next-button")},this},toNextPage:function(e){var t,i;return e.preventDefault(),e.stopPropagation(),this.ui.$nextButton.button("loading"),t=grecaptcha.getResponse(),t.length?(i=$.ajax({type:"POST",dataType:"JSON",url:$r.verify_captcha_response_api_v0_works_path({subdomain_param:"api"}),data:{"g-recaptcha-response":t}}),i.done(function(e){return function(){return"Draft"===e.model.get("type")&&e.model.get("primaryAttachment")?window.work_creator_router.navigate("add/feedback",{trigger:!0}):window.work_creator_router.navigate("add/research_interests",{trigger:!0})}}(this)),i.fail(function(e){return function(){return e.ui.$nextButton.button("reset")}}(this))):this.ui.$nextButton.button("reset")}})}.call(this),function(){this.WorkCreator.SharingPage=Backbone.View.extend({id:"sharing-page",headerText:"Share",stepNumber:4,template:"work_creator/templates/pages/sharing_page",events:{"click .twitter-share":"handleTwitterClick","click .work-creator-upload-another":"uploadAnotherWork","click .work-creator-finish":"closeWorkCreator"},render:function(){return this.$el.html(JST[this.template]({title:this.model.get("title")})),this.trigger("show-close-with-refresh-icon"),this},handleTwitterClick:function(){return this.showTwitterModal(),this.deprioritizeTwitterButton(),this.prioritizeFinishButton(),this.prioritizeUploadAnotherLink()},showTwitterModal:function(){var e,t;return WorkCreator.notifier.notifyAndLog("show-twitter-modal"),t=this.getTweetText(),e=this.model.get("internalUrl"),window.Academia.openTwitterShareWindow(t,e)},deprioritizeTwitterButton:function(){return this.$(".btn-twitter").removeClass("btn-twitter").addClass("btn-twitter-clear")},prioritizeFinishButton:function(){return this.$(".work-creator-finish").removeClass("btn-success-clear").addClass("btn-success")},prioritizeUploadAnotherLink:function(){return this.$(".work-creator-upload-another").css("opacity",1)},getTweetText:function(){var e,t,i,s,r,a,o;return a=140,r=23,i=3,this.model.has("primaryAttachment")?(t="I just uploaded '' to @academia!",e=140-t.length-r-i,o=$h.truncate(this.model.get("title"),e),s="I just uploaded '"+o+"' to @academia!"):(t="I just added '' to @academia!",e=140-t.length-r-i,o=$h.truncate(this.model.get("title"),e),s="I just added '"+o+"' to @academia!"),s},uploadAnotherWork:function(){return WorkCreator.notifier.notifyAndLog("upload-another-clicked"),window.work_creator_router.navigate("add/reset",{trigger:!0})},closeWorkCreator:function(){return window.work_creator_router.navigate("add/success_close",{trigger:!0})}})}.call(this),function(){this.WorkCreator.SurveyPage=Backbone.View.extend({id:"survey-page",headerText:"Upload Complete",stepNumber:4,template:"work_creator/templates/pages/survey_page",events:{"click .work-creator-finish":"closeWorkCreator","click .work-creator-upload-another":"uploadAnotherWork","change input.option-none":"removeOtherChecks","change input.option":"removeNoneCheck","change input":"submitButtonToggle"},render:function(){return this.$el.html(JST[this.template]({title:this.model.get("title")})),this.trigger("show-close-with-refresh-icon"),this},uploadAnotherWork:function(){return WorkCreator.notifier.notifyAndLog("skip-survey-clicked"),window.work_creator_router.navigate("add/share",{trigger:!0})},closeWorkCreator:function(){var e,t,i,s,r;return t=$(".exp").prop("checked"),r=$(".peer").prop("checked"),i=$(".open").prop("checked"),s=$(".option-none").prop("checked"),e=$(".comments").val(),$.ajax({url:$r.publishing_survey_api_v0_attachment_path({id:this.model.get("primaryAttachment").id,subdomain_param:"api"}),type:"PUT",data:{exposure:t,peer_review:r,open_access:i,none:s,comments:e}}),window.survey_eligible=!1,window.work_creator_router.navigate("add/share",{trigger:!0})},removeOtherChecks:function(){return $("input.option-none").prop("checked")?$("input.option").prop("checked",!1):void 0},removeNoneCheck:function(){return $("input.option-none").prop("checked",!1)},submitButtonToggle:function(){return $("input:checked").length?($("button.work-creator-finish").removeAttr("disabled"),$("button.work-creator-finish").removeClass("middle-gray"),$("button.work-creator-finish").addClass("btn-success")):($("button.work-creator-finish").attr("disabled","disabled"),$("button.work-creator-finish").removeClass("btn-success"),$("button.work-creator-finish").addClass("middle-gray"))}})}.call(this),function(){this.WorkCreator.UploadPage=Backbone.View.extend({id:"upload-page",stepNumber:2,headerText:"Upload",template:"work_creator/templates/pages/upload_page",events:{"click .js-forward-button":"toNextPage","click .js-back-button":"toPreviousPage","click .stop-upload":"stopUpload"},initialize:function(){return this.listenTo(this.model,"attachment-adding attachment-uploaded attachment-removed",this.render),this.listenTo(this.model,"upload-failed",this.alertError)},render:function(){return this.$el.html(JST[this.template]()),this.setupSelectors(),this.resetPage(),this.updateUploadBox(),this.updatePageControls(),this},setupSelectors:function(){return this.pageControls=this.$(".page-controls"),this.currentUploadBoxView=this.$(".current-view"),this.noPaperToUploadLink=this.$(".no-papers-to-upload"),this.cancelUploadLink=this.$(".cancel-upload"),this.continueButton=this.$(".continue"),this.alertText=this.$(".alert-text"),this.alertBox=this.$(".alert-box")},resetPage:function(){return this.pageControls.addClass("hidden"),this.uploadBoxView?this.uploadBoxView.remove():void 0},updateUploadBox:function(){return this.uploadBoxView=new(WorkCreator[this.getUploadBoxViewClass()])({model:this.model}),this.currentUploadBoxView.html(this.uploadBoxView.render().el)},getUploadBoxViewClass:function(){return this.model.primaryAttachmentUploaded()?"PrimaryAttachmentUploadedView":this.model.primaryAttachmentUploading()?"PrimaryAttachmentUploadingView":"NoAttachmentView"},updatePageControls:function(){return this.model.has("primaryAttachment")||this.noPaperToUploadLink.removeClass("hidden"),this.model.primaryAttachmentUploading()&&this.cancelUploadLink.removeClass("hidden"),this.model.primaryAttachmentUploaded()?this.continueButton.removeClass("hidden"):void 0},stopUpload:function(){return WorkCreator.notifier.notifyAndLog("stop-upload-clicked"),this.model.has("primaryAttachment")&&this.model.unset("primaryAttachment"),this.render()},alertError:function(e){return this.render(),this.alertText.text(e),this.alertBox.fadeIn(300).delay(5e3).fadeOut(1e3)},toPreviousPage:function(){return window.work_creator_router.navigate("add/classify",{trigger:!0})},toNextPage:function(){return this.model.pollingForSuggestions&&(null==this._waitingSince&&(this._waitingSince=new Date,this.$(".js-forward-button").html('<i class="fa fa-spinner fa-spin"></i>')),this._waitingSince.getTime()>(new Date).getTime()-3e3)?(null!=this._toNextPageRetry&&clearTimeout(this._toNextPageRetry),void(this._toNextPageRetry=setTimeout(function(e){return function(){return e.toNextPage()}}(this),250))):window.work_creator_router.navigate("add/paper_details",{trigger:!0})}})}.call(this),function(){this.WorkCreator.ResearchInterestCollectionView=Backbone.View.extend({initialize:function(){return this.collection.on("add remove",this.render,this)},render:function(){return this.$el.empty(),_.each(this.collection.models,function(e){return function(t){var i;return i=new WorkCreator.ResearchInterestView({model:t}),e.$el.prepend(i.render().el)}}(this)),this}})}.call(this),function(){this.WorkCreator.ResearchInterestModule=Backbone.View.extend({template:"work_creator/templates/research_interests/research_interest_module",initialize:function(){return this.isDiscussionPromotionEligible=this.options.isDiscussionPromotionEligible||!1,this.riCollectionView=new WorkCreator.ResearchInterestCollectionView({collection:this.collection}),this.riPicker=new Works.ResearchInterestPicker({collection:this.collection,template:"work_creator/templates/research_interests/research_interest_picker"}),this.collection.on("add remove change",this.updateReachDisplay,this),this.riPicker.on("too_many_research_interests",this.tooManyResearchInterests,this)},render:function(){return this.$el.html(JST[this.template]()),this.setupSelectors(),this.riListContainer.html(this.riCollectionView.render().el),this.riPickerContainer.html(this.riPicker.render().el),this.showDiscussionOpenContainerIfApplicable(),this.updateReachDisplay(),this},setupSelectors:function(){return this.riListContainer=this.$(".ri-list"),this.riPickerContainer=this.$(".js-work-creator-research-interest-picker"),this.reachCount=this.$(".followers-reached"),this.reachTextWithReach=this.$(".text-with-reach"),this.reachTextWithoutReach=this.$(".text-without-reach"),this.reachContainer=this.$(".js-academics-reached"),this.discussionOpenContainer=this.$(".js-discussion-open-container")},updateReachDisplay:function(){return this.updateReachCount(),this.updateReachText()},updateReachCount:function(){return this.reachCount.html($h.abbreviateNumber(this.collection.followersReached()))},updateReachText:function(){return this.collection.followersReached()>0?(this.reachTextWithReach.removeClass("hidden"),this.reachTextWithoutReach.addClass("hidden")):(this.reachTextWithReach.addClass("hidden"),this.reachTextWithoutReach.removeClass("hidden"))},tooManyResearchInterests:function(){return this.trigger("too_many_research_interests")},showDiscussionOpenContainerIfApplicable:function(){return this.isDiscussionPromotionEligible?(WorkCreator.notifier.notifyAndLog("discussion-promotion-ri-page-shown"),this.discussionOpenContainer.removeClass("hidden"),this.reachContainer.addClass("hidden")):WorkCreator.notifier.notifyAndLog("normal-ri-page-shown")}})}.call(this),function(){this.WorkCreator.ResearchInterestView=Backbone.View.extend({template:"work_creator/templates/research_interests/research_interest",events:{"click button.close":"removeResearchInterest"},render:function(){return this.$el.html(JST[this.template]({name:this.model.get("name"),follower_count:$h.abbreviateNumber(this.model.get("followers"))})),this},removeResearchInterest:function(){return this.model.trigger("destroy",this.model,this.model.collection)}})}.call(this),function(){var e=function(e,i){function s(){this.constructor=e}for(var r in i)t.call(i,r)&&(e[r]=i[r]);return s.prototype=i.prototype,e.prototype=new s,e.__super__=i.prototype,e},t={}.hasOwnProperty;this.WorkCreator.UploadPrompt=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.template="work_creator/templates/upload_prompt",i.prototype.events={"click .add-paper":"addPaperClicked"},i.prototype.initialize=function(e){return this.sectionName=e.section,this.recaptchaKey=e.recaptcha_key},i.prototype.render=function(){return WorkCreator.notifier.notifyAndLog("no-works-prompt-show"),this.$el.html(JST[this.template]({sectionName:this.sectionName})),this},i.prototype.addPaperClicked=function(){return WorkCreator.notifier.notifyAndLog("no-works-prompt-add-paper-clicked"),WorkCreator.start(this.sectionName,"three_step",this.recaptchaKey)},i}(Backbone.View)}.call(this),function(){this.WorkCreator.Uploader=Backbone.View.extend({initialize:function(){return this._setupDefaults(),this._setupFileUploader()},_setupDefaults:function(){return this.defaults={multiple:!1,max_size:104857600,max_file_name_length:125,file_types:["pdf","txt","ps","rtf","epub","odt","odp","ods","odg","odf","sxw","sxc","sxi","sxd","doc","ppt","pps","xls","docx","pptx","ppsx","xlsx","tif","tiff","csv","tsv"],url:this._attachmentUrl()}},_setupFileUploader:function(){return this.options.dropZone.on("dragover",function(e){return function(){return e.handleDragover()}}(this)),req("jquery.fileupload",function(e){return function(){return e.options.fileInput.fileupload({url:e.defaults.url,dataType:"json",formData:{document_domain:$no_document_domain?null:document.domain},dropZone:e.options.dropZone,add:function(t,i){return e.defaults.max_size&&!e._size_ok(i.files[0])||e.defaults.file_types&&!e._file_type_ok(i.files[0])||e.defaults.max_file_name_length&&!e._file_name_length_ok(i.files[0])?void 0:(i.uploading_file=new WorkCreator.Attachment({progress:0,status:"uploading",file_name:i.files[0].name}),i.uploading_file.file=i.files[0],e.model.set("primaryAttachment",i.uploading_file),WorkCreator.notifier.notifyAndLog("upload_started"),e.model.trigger("attachment-adding"),i.submit())},progress:function(e,t){var i,s;return s=t.progress(),i=parseInt(s.loaded/s.total*100,10),t.uploading_file.set("progress",i)},done:function(t,i){var s;return s=i.result.attachment,i.uploading_file.set({id:s.id,title:s.title,url:s.url,file_type:s.file_type,status:"uploaded"}),i.result.error&&i.result.error.length>0?WorkCreator.notifier.notifyAndLog("upload_complete",i.result.error):WorkCreator.notifier.notifyAndLog("upload_complete"),e.model.trigger("attachment-uploaded")},fail:function(t,i){return i.uploading_file.set("status","failed"),e.model.trigger("upload-failed","Oops... Upload failed! Try again!"),WorkCreator.notifier.notifyAndLog("upload_failed",$a.fileUploadErrorString(i),"work_creator_uploader")}})}}(this))},_attachmentUrl:function(){var e;return e={source:"three_step",subdomain_param:"api"},$r.api_v0_attachments_path(e)},_size_ok:function(e){return e.size>this.defaults.max_size?(this.model.trigger("upload-failed","Sorry... Your file is too large!"),WorkCreator.notifier.notifyAndLog("file_too_large"),!1):!0},_file_type_ok:function(e){var t;return t=_.last(e.name.split(/\./)).toLowerCase(),_.include(this.defaults.file_types,t)?!0:(this.model.trigger("upload-failed","Sorry... We don't accept that file type at the moment!"),WorkCreator.notifier.notifyAndLog("file_type_not_accepted"),this._report_invalid_extensions_upload_attempt(t),!1)},_file_name_length_ok:function(e){return e.name.length>this.defaults.max_file_name_length?(this.model.trigger("upload-failed","Sorry... File names must be less than "+this.defaults.max_file_name_length+" characters long"),WorkCreator.notifier.notifyAndLog("file_name_too_long"),!1):!0},_report_invalid_extensions_upload_attempt:function(e){var t;return t=$r.record_invalid_extension_api_v0_attachments_path({subdomain_param:"api"}),$.post(t,{extensions:[e]})},handleDragover:function(){var e,t,i;return t=$(".upload-box"),i=window.newDropZoneTimeout,i?clearTimeout(i):t.addClass("dragging"),e=function(e,t){return setTimeout(t,e)},window.newDropZoneTimeout=e(250,function(e){return function(){return e.resetTimeout(t)}}(this))},resetTimeout:function(e){return window.newDropZoneTimeout=null,e.removeClass("dragging")}})}.call(this),function(){this.WorkCreator.UrlCollectionView=Backbone.View.extend({initialize:function(){return this.collection.on("add remove",this.render,this)},render:function(){return this.$el.empty(),_.each(this.collection.models,function(e){return function(t){var i;return i=new WorkCreator.UrlView({model:t}),e.$el.prepend(i.render().el)}}(this)),this}})}.call(this),function(){this.WorkCreator.UrlCreator=Backbone.View.extend({template:"work_creator/templates/urls/url_creator",events:{"click button.add-url":"manualAddUrl","keyup #add-work-url":"handleUrlInput"},render:function(){return this.$el.html(JST[this.template]()),this},handleUrlInput:function(e){return 13===e.keyCode?this.addUrl(!0):void 0},manualAddUrl:function(){return this.addUrl(!0)},addUrl:function(e){var t;return this.trigger("reset-url-validation-message"),t=new WorkCreator.Url({url:this.getUrlInput()}),e?t.isValid()?(this.collection.add(t),this.resetUrlInput()):this.trigger("url-creation-error",t.validationError.url[0]):t.get("url").length>0?(this.collection.add(t),this.resetUrlInput()):void 0},getUrlInput:function(){return this.$("input#add-work-url").val()},resetUrlInput:function(){return this.$("input#add-work-url").val("")}})}.call(this),function(){this.WorkCreator.UrlModule=Backbone.View.extend({template:"work_creator/templates/urls/url_module",initialize:function(){return this.urlCollectionView=new WorkCreator.UrlCollectionView({collection:this.collection}),this.urlCreator=new WorkCreator.UrlCreator({collection:this.collection}),this.listenTo(this.urlCreator,"reset-url-validation-message",this.resetUrlValidationMessage),this.listenTo(this.urlCreator,"url-creation-error",this.urlCreationError)},render:function(){return this.$el.html(JST[this.template]()),this.$(".url-list").html(this.urlCollectionView.render().el),this.$(".url-creator").html(this.urlCreator.render().el),this},resetUrlValidationMessage:function(){return this.$(".url-alert-box").hide(),this.$(".url-alert-box span").html("")},urlCreationError:function(e){return this.$(".url-alert-box span").html("URL "+e),this.$(".url-alert-box").fadeIn()},autosaveEnteredUrl:function(){return this.urlCreator.addUrl(!1)}})}.call(this),function(){this.WorkCreator.UrlView=Backbone.View.extend({template:"work_creator/templates/urls/url",events:{"click button.close":"removeUrl"},render:function(){return this.$el.html(JST[this.template]({url:this.model.get("url")})),this},removeUrl:function(){return this.model.trigger("destroy",this.model,this.model.collection)}})}.call(this);