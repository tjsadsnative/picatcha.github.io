function sbTrace(e,t){SbInGageWidget.debug&&console.log(e,t)}if(void 0==SbInGageWidget)var SbInGageWidget={debug:!1,ingagePlayer:null,ingageExpanded:!1,ingageActive:!1,ingageActiveSafari:!1,sbPlayerInterval:void 0,slideDownInterval:void 0,slideUpInterval:void 0,elementId:"",trackUrl:"",adTag:"",width:0,height:0,p_delimiter:0,frequency:1,playControl:!1,soundControl:!1,secondsToPlay:0,scrLoc:"",placeholder:"none",totallyher_img:"",crave_img:"",gaId:"",gaLabel:"",COOKIE_NAME:"sb_ads_player_ingage_",pageInfo:{},divWithPlayer:null,isIngageReady:!1,playInterval:null,trackingPixelSent:!1,safariException:!1,safariLoad:!1,options:{cmsPath:"http://dev.publishers.springboardplatform.com"},init:function(e){var t=SbInGageWidget.clone(SbInGageWidget.options);return t=SbInGageWidget.extend(t,e),SbInGageWidget.options=t,this.pageInfo=this.getPageInfo(),this.pageInfo.os=this.detectOs(),!this.pageInfo.isMobilePlatform&&this.pageInfo.isSafari&&(this.safariException=!0),this.pageInfo.isIPhone?!1:void this.makeCall()},clone:function(e){if(!e||"object"!=typeof e)return e;var t=new e.constructor;for(var i in e)e.hasOwnProperty(i)&&(t[i]=SbInGageWidget.clone(e[i]));return t},extend:function(e,t){for(var i in t)e[i]="object"==typeof e[i]?SbInGageWidget.extend(e[i],t[i]):t[i];return e},makeCall:function(){var e=this.options.cmsPath+"/ingage/getJson/"+this.options.partnerId+"/"+this.options.widgetId,t=document.getElementsByTagName("head").item(0),i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",e),i.async=!0,t.appendChild(i)},trackSlide:function(){this.trackUrl=this.trackUrl.replace("[timestamp]",(new Date).getTime());var e=document.createElement("img");e.setAttribute("src",this.trackUrl),document.body.appendChild(e)},initIngage:function(e){if(sbTrace("OBJECT",this),this.setupParams(e),this.checkFrequency()){sbTrace("ADD PLAYER ");var t=document.createElement("div");t.id="adplayer_iframeDiv",t.style.position="relative",t.style.height="0px",this.pageInfo.isMobilePlatform&&(t.style.height=this.height+"px",this.ingageExpanded=!0),t.style.width=this.width+"px",t.style.overflow="hidden",t.style.backgroundColor="black",this.divWithPlayer=t,this.safariException?this.appendDivSafari():this.appendDivWithPlayer(),this.initListeners(),""!=this.gaId&&""!=this.gaLabel&&(!function(e,t,i,a,n,r,o){e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,r=t.createElement(i),o=t.getElementsByTagName(i)[0],r.async=1,r.src=a,o.parentNode.insertBefore(r,o)}(window,document,"script","//www.google-analytics.com/analytics.js","gooan"),gooan("create",this.gaId,"auto"),gooan("send","pageview"))}},appendDivWithPlayer:function(){for(var e=document.getElementById(this.elementId),t=e.getElementsByTagName("p"),i=t.length,a=[],n=0;i>n;n++){var r=t[n].parentNode;r==e&&a.push(t[n])}if(i=a.length,this.p_delimiter<i){var o=a[this.p_delimiter];o.parentNode.insertBefore(this.divWithPlayer,o)}else e.appendChild(this.divWithPlayer);var s=document.createElement("script");s.type="text/javascript",s.src="//s0.2mdn.net/instream/html5/ima3_debug.js",this.divWithPlayer.appendChild(s);var d="ingage",g=document.createElement("div");g.id=this.options.widgetId+"_"+d,g.className="videoPlayer",this.divWithPlayer.appendChild(g);var l={adFrequency:1,adOffset:0,disableCompanions:!1,ads:[{adTagUrl:this.adTag,adType:"preroll",played:!1,type:"video"}]},h=document.createElement("script");if(h.type="text/javascript",h.src="//"+("cdn"==this.scrLoc?"www":this.scrLoc)+".springboardplatform.com/jsapi/embedhtml5/sb.js",h.onload=function(){$sbPlayer(SbInGageWidget.options.widgetId+"_"+d,{sbFeed:{partnerId:SbInGageWidget.options.partnerId,type:"video",contentId:0},style:{width:"100%",height:"100%"},override:{clip:{autoPlay:SbInGageWidget.pageInfo.isMobilePlatform?!1:!0},ingageUnit:!0,ingageWidth:SbInGageWidget.width,ingageHeight:SbInGageWidget.height,preferFlash:!0,unmuteOnRollover:SbInGageWidget.soundControl&&!SbInGageWidget.pageInfo.isMobilePlatform?!0:!1,soundOnRollout:!1,unmuteOnRolloverDelay:1e3,initialVolume:100,plugins:{"flowplayer.ganalytics":{accountId:""},controls:{volume:!1,next:!1,play:!1,fullscreen:!1,progress:!1,time:!1},"flowplayer.hdwidget":{comingNext:!1,email:!1,embed:!1,enableRecommended:!1,facebook:!1,googleplus:!1,twitter:!1,link:!1,pinterest:!1},"flowplayer.advertising":l}}}),SbInGageWidget.sbPlayerInterval=setInterval(function(){SbInGageWidget.sbPlayerCheck(SbInGageWidget.options.widgetId+"_"+d)},50)},this.divWithPlayer.appendChild(h),"none"!=this.placeholder&&this.pageInfo.isMobilePlatform){var c=document.createElement("div");c.id="placeholder_ingage_div",c.style.position="absolute",c.style.width="100%",c.style.height="100%",c.style.top="0px",c.style.left="0px",c.style.background="url("+("crave"==this.placeholder?this.crave_img:this.totallyher_img)+") center center no-repeat",this.divWithPlayer.appendChild(c)}},sbPlayerCheck:function(e){var t=$sbPlayer(e);t&&(sbTrace(" SET PLAYER EVENTS"),this.ingagePlayer=t,clearInterval(SbInGageWidget.sbPlayerInterval),SbInGageWidget.sbPlayerInterval=null,t.onIngageReady(function(){sbTrace(" INGAGE READY "),SbInGageWidget.isIngageReady=!0,SbInGageWidget.pageInfo.isMobilePlatform||SbInGageWidget.scrollCheck()}),t.onIngageDestroy(function(){sbTrace("DESTROY INGAGE"),SbInGageWidget.destroyIngage()}))},onWindowScroll:function(){sbTrace("SCROLL 2"),SbInGageWidget.isIngageReady&&(sbTrace("SCROLL"),SbInGageWidget.scrollCheck())},onWindowScrollSafari:function(){sbTrace("SCROLL SAFARI"),SbInGageWidget.scrollCheckSafari()},onWindowResize:function(){SbInGageWidget.isIngageReady&&(sbTrace("RESIZE"),SbInGageWidget.scrollCheck())},initListeners:function(){this.pageInfo.isMobilePlatform?this.bindEvent(window,"touchend",SbInGageWidget.onWindowScroll):this.safariException?this.bindEvent(window,"scroll",SbInGageWidget.onWindowScrollSafari):this.bindEvent(window,"scroll",SbInGageWidget.onWindowScroll),this.bindEvent(window,"resize",SbInGageWidget.onWindowResize)},destroyListeners:function(){this.pageInfo.isMobilePlatform?this.unbindEvent(window,"touchend",SbInGageWidget.onWindowScroll):this.safariException?this.unbindEvent(window,"scroll",SbInGageWidget.onWindowScrollSafari):this.unbindEvent(window,"scroll",SbInGageWidget.onWindowScroll),this.unbindEvent(window,"resize",SbInGageWidget.onWindowResize)},bindEvent:function(e,t,i){"undefined"!=typeof document.addEventListener?e.addEventListener(t,i,!1):"undefined"!=typeof window.attachEvent&&e.attachEvent(t,i)},unbindEvent:function(e,t,i){"undefined"!=typeof document.addEventListener?e.removeEventListener(t,i,!1):"undefined"!=typeof window.attachEvent&&e.detachEvent(t,i)},setupParams:function(e){this.elementId=e.elementId,this.trackUrl=e.trackUrl,this.adTag=e.adTag,this.width=e.width,this.height=e.height,sbTrace(" INIT VISINA ",this.height),this.p_delimiter=e.p_delimiter,this.frequency=0!=e.freq?e.freq:1,this.playControl=e.useViewabilityForAd,this.soundControl=e.useVolumeForAd,this.secondsToPlay=e.secondsToPlay,this.scrLoc=e.scrLoc,this.placeholder=e.placeholder,this.totallyher_img=e.totallyher_img,this.crave_img=e.crave_img,e.ga&&(this.gaId=e.ga.id,this.gaLabel=e.ga.label)},checkFrequency:function(){var e,t=this.getCookie();try{e=JSON.parse(t)}catch(i){return this.setCookie(1),!0}if(e){var a=Number(e.inview_loaded);return a%this.frequency==0?(this.setCookie(1),!0):(this.setCookie(a+1),!1)}return!1},getCookie:function(){var e=new RegExp("[; ]"+this.COOKIE_NAME+this.elementId+"=([^\\\\s;]*)"),t=(" "+document.cookie).match(e);return this.COOKIE_NAME+this.elementId&&t?unescape(t[1]):""},setCookie:function(e){var t=new Date,i=new Date(t.getTime()+31536e6);document.cookie=this.COOKIE_NAME+this.elementId+'={"inview_loaded":"'+e+'"}; expires='+i+"; path=/"},detectOs:function(){var e="Unknown OS";return-1!=navigator.appVersion.indexOf("Win")&&(e="Windows"),-1!=navigator.appVersion.indexOf("Mac")&&(e="MacOS"),-1!=navigator.appVersion.indexOf("X11")&&(e="UNIX"),-1!=navigator.appVersion.indexOf("Linux")&&(e="Linux"),e},getPageInfo:function(){var e=function(){return"Microsoft Internet Explorer"==navigator.appName||"Netscape"==navigator.appName&&null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)},t=function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){var t=navigator.userAgent,i=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}return e},i=function(){return!!window.navigator.userAgent.match("Firefox")},a=function(){return!!window.navigator.userAgent.match("Chrome")},n=function(){return a()?!1:!!window.navigator.userAgent.match("Safari")},r=function(){return null!==window.navigator.userAgent.match(/iPad/i)},o=function(){return null!==window.navigator.userAgent.match(/iPhone/i)},s=function(){return o()||r()},d=function(){var e=window.navigator.userAgent.match(/OS (\d+)_/i);return e&&e[1]?e[1]:void 0},g=function(){return null!==window.navigator.userAgent.match(/Android.*AppleWebKit/i)},l=function(){return null!==window.navigator.userAgent.match(/Android 2\.[12]/)},h=function(){var e=window.navigator.userAgent.match(/Android (\d+)\./i);return e&&e[1]?e[1]:void 0},c=function(){return!!(navigator.userAgent.match(/(iPod|iPhone|iPad)/)||navigator.userAgent.toLowerCase().indexOf("android")>-1)},p=function(){return"ontouchstart"in window};return{isIE:e(),ieVersion:t(),isFF:i(),isChrome:a(),isSafari:n(),isIPad:r(),isIPhone:o(),isIOS:s(),iOSVersion:d(),isAndroid:g(),isOldAndroid:l(),androidVersion:h(),isMobilePlatform:c(),hasTouch:p()}},scrollCheck:function(){if(this.isIngageReady){sbTrace(" SCROLL CHECK ");var e=this.checkIfVisible();sbTrace(" VISIBLE MOMENT ",e),sbTrace(" INGAGE ACTIVE ",this.ingageActive),e!=this.ingageActive&&(sbTrace(" ULAZ U IF "),this.ingageActive=e,this.ingageActive?(this.secondsToPlay>0&&!this.ingageExpanded?(sbTrace(" INTERVAL PLAY "),this.playInterval=setTimeout(function(){SbInGageWidget.playAd()},SbInGageWidget.secondsToPlay)):(sbTrace(" NORMAL PLAY "),this.playAd()),sbTrace(" SHOW PLAYER ")):(sbTrace(" PAUSE / UNPAUSE "),clearTimeout(this.playInterval),this.playControl&&(this.gaTrack("pause"),this.ingagePlayer.pause())))}},checkIfVisible:function(){var e=this.getViewportHeight(),t=this.getViewportWidth(),i=this.scrollYValue();sbTrace("SCROLL HEIGHT",i);var a=(this.scrollXValue(),this.getFixed());sbTrace("FIXED HEIGHT",a);var n=this.posY();sbTrace("Y POSITION",n);var r=this.posX();sbTrace("X POSITION",r);var o=1;sbTrace("DIV OFFSET",this.divWithPlayer.offsetWidth);var s=Math.min(t-r,this.divWithPlayer.offsetWidth);r+this.width>t&&(o=s/this.width),sbTrace("SCALE FINAL",o),this.width=this.width*o,this.height=this.height*o,this.divWithPlayer.style.width=this.width+"px",this.ingageExpanded&&(this.divWithPlayer.style.height=this.height+"px"),sbTrace("VISINA",this.height);var d=downLimit=n+this.height/2;this.pageInfo.isMobilePlatform&&(d=downLimit=n+this.height),sbTrace("UP LIMIT 2",d),sbTrace("VIEWPORT HEIGHT",e);var g=e+i>d,l=downLimit-i>a;return g&&l},getViewportHeight:function(){var e=document.documentElement;return window.innerHeight?window.innerHeight:e&&!isNaN(e.clientHeight)?e.clientHeight:0},getViewportWidth:function(){var e=document.documentElement;return window.innerWidth?window.innerWidth:e&&!isNaN(e.clientWidth)?e.clientWidth:0},scrollYValue:function(){return window.pageYOffset?window.pageYOffset:Math.max(document.documentElement.scrollTop,document.body.scrollTop)},scrollXValue:function(){return window.pageXOffset?window.pageXOffset:Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)},getFixed:function(){var e=0;if(/IE/i.test(navigator.userAgent))return 0;var t=Array.prototype.slice.call(document.getElementsByTagName("div")),i=Array.prototype.slice.call(document.getElementsByTagName("header"));if(i)for(var a=0;a<i.length;a++){var n=i[a].getElementsByTagName("div");if(n)for(var r=0;r<n.length;r++)for(var o=0;o<t.length;o++)if(t[o].isEqualNode(n[r])){t.splice(o,1);break}}for(var a=0;a<i.length;a++)this.checkHeader(i[a])&&(e+=i[a].offsetHeight);for(var r=0;r<t.length;r++)this.checkDiv(t[r])&&(e+=t[r].offsetHeight);return e},checkHeader:function(e){return 0==e.offsetTop&&0!=e.offsetHeight&&"none"!=this.getStyle(e,"display")&&this.checkWidth(e)&&"fixed"==this.getStyle(e,"position")&&"hidden"!=this.getStyle(e,"visibility")&&this.getStyle(e,"opacity")>0},checkDiv:function(e){return Number(this.getStyle(e,"z-index"))>0&&0==e.offsetTop&&0!=e.offsetHeight&&"none"!=this.getStyle(e,"display")&&"fixed"==this.getStyle(e,"position")&&this.checkWidth(e)&&"hidden"!=this.getStyle(e,"visibility")&&this.getStyle(e,"opacity")>0},getStyle:function(e,t){var i;return e.currentStyle?i=e.currentStyle[t]:window.getComputedStyle&&(i=document.defaultView.getComputedStyle(e,t).getPropertyValue(t)),i},checkWidth:function(e){return document.body.offsetWidth==e.offsetWidth},posY:function(){for(var e=this.divWithPlayer,t=0;e&&"body"!==e.tagName.toLowerCase();)t+=e.offsetTop,e=e.offsetParent;return t},posX:function(){for(var e=this.divWithPlayer,t=0;e&&"body"!==e.tagName.toLowerCase();)t+=e.offsetLeft,e=e.offsetParent;return t},playAd:function(){this.ingageExpanded?(this.pageInfo.isMobilePlatform&&(this.trackUrl&&!this.trackingPixelSent?(this.trackingPixelSent=!0,this.trackSlide(),this.gaTrack("start")):this.gaTrack("play"),"none"!=this.placeholder&&this.pageInfo.isMobilePlatform&&(document.getElementById("placeholder_ingage_div").style.display="none")),this.pageInfo.isMobilePlatform||this.gaTrack("play"),sbTrace("INGAGE PLAYER",this.ingagePlayer),this.ingagePlayer.play()):(this.trackUrl&&!this.trackingPixelSent&&(this.trackingPixelSent=!0,this.trackSlide()),this.slideDownInterval=setInterval(function(){SbInGageWidget.expandDiv()},20))},expandDiv:function(){sbTrace("SLIDE DOWN INTERVAL");var e=parseInt(this.divWithPlayer.style.height);e+20>this.height?(e=this.height,clearInterval(this.slideDownInterval),this.ingageExpanded=!0,this.gaTrack("start"),this.pageInfo.isMobilePlatform?this.ingagePlayer.play():this.ingagePlayer.playIngage()):e+=20,this.divWithPlayer.style.height=e+"px"},destroyIngage:function(){sbTrace(" DESTROY INGAGE 2"),this.gaTrack("end"),this.destroyListeners(),this.ingageExpanded&&setTimeout(function(){SbInGageWidget.collapseDiv()},20)},collapseDiv:function(){sbTrace("SLIDE UP INTERVAL");var e=parseInt(this.divWithPlayer.style.height);this.divWithPlayer.innerHTML="",this.divWithPlayer.style.border="border: 1px solid transparent;",0>e-20?(e=0,this.divWithPlayer.parentNode.removeChild(this.divWithPlayer)):(e-=20,setTimeout(function(){SbInGageWidget.collapseDiv()},20)),this.divWithPlayer.style.height=e+"px"},gaTrack:function(e){sbTrace("GA "+e),"undefined"!=typeof gooan?gooan("send","event",this.gaLabel,e):sbTrace("GA IS NOT SENT",e)},appendDivSafari:function(){for(var e=document.getElementById(this.elementId),t=e.getElementsByTagName("p"),i=t.length,a=[],n=0;i>n;n++){var r=t[n].parentNode;r==e&&a.push(t[n])}if(i=a.length,this.p_delimiter<i){var o=a[this.p_delimiter];o.parentNode.insertBefore(this.divWithPlayer,o)}else e.appendChild(this.divWithPlayer);var s=document.createElement("script");s.type="text/javascript",s.src="//s0.2mdn.net/instream/html5/ima3.js",this.divWithPlayer.appendChild(s);var d=document.createElement("script");d.type="text/javascript",d.src="//"+("cdn"==this.scrLoc?"www":this.scrLoc)+".springboardplatform.com/jsapi/embedhtml5/sb.js",d.onload=function(){SbInGageWidget.safariLoad=!0},this.divWithPlayer.appendChild(d)},scrollCheckSafari:function(){var e=this.checkIfVisible();sbTrace(" VISIBLE MOMENT ",e),sbTrace(" INGAGE ACTIVE ",this.ingageActiveSafari),e!=this.ingageActiveSafari&&(sbTrace(" ULAZ U IF "),this.ingageActiveSafari=e,this.ingageActiveSafari?this.ingageExpanded?SbInGageWidget.isIngageReady&&(SbInGageWidget.isIngageStartedSafari?(SbInGageWidget.gaTrack("play"),SbInGageWidget.ingagePlayer.play()):(SbInGageWidget.trackUrl&&!SbInGageWidget.trackingPixelSent&&(SbInGageWidget.trackingPixelSent=!0,SbInGageWidget.trackSlide(),SbInGageWidget.gaTrack("start")),SbInGageWidget.isIngageStartedSafari=!0,SbInGageWidget.ingagePlayer.playIngage())):this.slideDownInterval=setInterval(function(){SbInGageWidget.expandDivSafari()},20):SbInGageWidget.isIngageStartedSafari&&(SbInGageWidget.gaTrack("pause"),SbInGageWidget.ingagePlayer.pause()))},expandDivSafari:function(){sbTrace("SLIDE DOWN INTERVAL");var e=parseInt(this.divWithPlayer.style.height);e+20>this.height?(e=this.height,clearInterval(this.slideDownInterval),this.ingageExpanded=!0,this.addPlayerSafari(),sbTrace("EXPANDED")):e+=20,this.divWithPlayer.style.height=e+"px"},addPlayerSafari:function(){var e="ingage",t=document.createElement("div");t.id=this.options.widgetId+"_"+e,t.className="videoPlayer",this.divWithPlayer.appendChild(t);var i={adFrequency:1,adOffset:0,disableCompanions:!1,ads:[{adTagUrl:this.adTag,adType:"preroll",played:!1,type:"video"}]};$sbPlayer(SbInGageWidget.options.widgetId+"_"+e,{sbFeed:{partnerId:SbInGageWidget.options.partnerId,type:"video",contentId:0},style:{width:"100%",height:"100%"},override:{clip:{autoPlay:SbInGageWidget.pageInfo.isMobilePlatform?!1:!0},ingageUnit:!0,ingageWidth:SbInGageWidget.width,ingageHeight:SbInGageWidget.height,preferFlash:!0,unmuteOnRollover:SbInGageWidget.soundControl&&!SbInGageWidget.pageInfo.isMobilePlatform?!0:!1,soundOnRollout:!1,unmuteOnRolloverDelay:1e3,initialVolume:100,plugins:{"flowplayer.ganalytics":{accountId:""},controls:{volume:!1,next:!1,play:!1,fullscreen:!1,progress:!1,time:!1},"flowplayer.hdwidget":{comingNext:!1,email:!1,embed:!1,enableRecommended:!1,facebook:!1,googleplus:!1,twitter:!1,link:!1,pinterest:!1},"flowplayer.advertising":i}}}),SbInGageWidget.sbPlayerInterval=setInterval(function(){SbInGageWidget.sbPlayerCheckSafari(SbInGageWidget.options.widgetId+"_"+e)},50)},sbPlayerCheckSafari:function(e){var t=$sbPlayer(e);t&&(sbTrace(" SET PLAYER EVENTS"),this.ingagePlayer=t,clearInterval(SbInGageWidget.sbPlayerInterval),SbInGageWidget.sbPlayerInterval=null,t.onIngageReady(function(){sbTrace(" INGAGE READY "),SbInGageWidget.isIngageReady=!0,SbInGageWidget.ingageActiveSafari&&(SbInGageWidget.trackUrl&&!SbInGageWidget.trackingPixelSent&&(SbInGageWidget.trackingPixelSent=!0,SbInGageWidget.trackSlide(),SbInGageWidget.gaTrack("start")),SbInGageWidget.isIngageStartedSafari=!0,SbInGageWidget.ingagePlayer.playIngage())}),t.onIngageDestroy(function(){sbTrace("DESTROY INGAGE"),SbInGageWidget.destroyIngage()}))}};